"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[397],{397:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.r(e),a.d(e,{default:()=>m});var n=a(43),s=a(668),o=a(63),i=a(111),c=a(684),l=a(579),u=t([o]);o=(u.then?(await u)():u)[0];const d="expl0595",p="C_STANGDWN_MIF",f=1930;function m(){const[t,e]=(0,n.useState)(p),[a,r]=(0,n.useState)(-1),u=(0,n.useRef)(),h=(0,n.useRef)([]),m=(0,n.useRef)(),[y,g]=(0,n.useState)((()=>s.m4Y())),v=800,k=400,x=30,w=30,b=30,M=60;return(0,n.useLayoutEffect)((()=>{const e=s.Ltv(m.current);e.selectAll("*").remove(),document.querySelector(".bucket-wrapper").style.display="none";const a=e.attr("width",v+M+w).attr("height",k+x+b).style("background","rgb(251, 251, 255)").attr("opacity",1).append("g").attr("transform","translate(".concat(M,",").concat(x,")")),n=o.jx[t][o.Vk][d][o.sQ].map(((t,e)=>({val:t,placeFromLeft:e,year:e+f}))).sort(((t,e)=>e.val-t.val));g((()=>s.m4Y().domain((0,c.kd)(0,1,n.length)).range(o.jx[t][o.Vk][d][o.Zl].map((t=>t/o.pk))).clamp(!0)));const i=s.WH().domain(n.map((t=>{let{year:e}=t;return e})).sort()).range([0,v]).padding(.4),l=s.m4Y().domain([0,o.pk]).range([k,0]),u=s.l78(i).tickSize(0).tickValues(i.domain().filter(((t,e)=>e%10===0)));a.append("g").attr("class","anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(k,")")).call(u).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),a.append("g").call(s.V4s(l)),h.current[0]=()=>{a.selectAll(".bars").data(n,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(t=>i(t.year))).attr("y",k).attr("width",i.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(t=>l(t.val))).attr("height",(t=>k-l(t.val)))},h.current[1]=async()=>{a.select(".anim-xaxis").call(u.tickFormat(""));const t=a.selectAll(".bars");await t.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((t=>100+1e3*(1-(1-t.placeFromLeft/n.length)**4))).duration(500).attr("width",100).attr("x",(t=>350)).end(),a.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(450,")")).attr("opacity",0),t.transition().delay(500).attr("x",0),a.transition().delay(500).attr("transform","translate(".concat(M+400-50,",").concat(x,")"))},h.current[2]=()=>{a.selectAll(".bars").style("mix-blend-mode","normal").attr("fill",((t,e)=>(0,c.YW)(e/(n.length-1)))).transition().attr("opacity",1)},h.current[3]=()=>{document.querySelector(".bucket-wrapper").style.display="initial",e.transition().duration(500).attr("opacity",0)};const p=()=>{r((t=>t+1))};return e.node().addEventListener("click",p),()=>{e.node().removeEventListener("click",p),r(-1)}}),[t]),(0,n.useEffect)((()=>{if(-1===a)return r(0),void(u.current=-1);u.current<a&&a<h.current.length&&(h.current[a](),u.current=a)}),[a]),(0,l.jsxs)("div",{className:"explanation-anim-wrapper",children:[(0,l.jsx)("select",{value:t,onChange:t=>e(t.target.value),children:o.iL.map((t=>(0,l.jsx)("option",{value:t,children:t},t)))}),(0,l.jsx)("svg",{ref:m}),(0,l.jsx)(i.A,{levelInterp:y,width:300,height:k}),(0,l.jsx)("p",{children:"We turn yearly water delivery quantities into a heatmap-like representation, where darker blue indicates ranges of likely quantities and lighter blue indicates ranges of less likely quantities. This works well with the metaphor of a water bucket, since we can imagine water deliveries as levels of water filled in a bucket; darker blue water levels represent how much water we can expect AT LEAST, with lighter blue water levels represent various less likely, but still plausible, water delivery quantities."})]})}r()}catch(h){r(h)}}))},111:(t,e,a)=>{a.d(e,{A:()=>u});var r=a(668),n=a(43),s=a(684),o=a(579);const i=40,c=10,l=3;function u(t){let{levelInterp:e,colorInterp:a=s.YW,width:u=200,height:h=400,resolution:d=c}=t;const p=(0,n.useId)(),f=(0,n.useRef)(),m=(0,n.useMemo)((()=>(0,s.kd)(0,1-1/d,d).map((t=>e(t)))),[e,d]),y=(0,s.ZC)(m),g=u-2*l,v=h-l;return(0,n.useLayoutEffect)((()=>{const t=f.current.append("g").attr("class","svg-container").attr("transform","translate(".concat(l,", ").concat(l/2,")"));t.append("defs").append("clipPath").attr("id","bucket-mask-"+p).append("path").attr("class","bucket-mask-path"),t.append("g").attr("class","graph-area").attr("clip-path","url(#bucket-mask-".concat(p,")")),t.append("g").append("path").attr("class","bucket-outline").attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",l).attr("fill","none")}),[p]),(0,n.useLayoutEffect)((()=>{const t=f.current.attr("width",u).attr("height",h).select(".svg-container");t.select(".bucket-mask-path").attr("d",(0,s.wh)(g,v)),t.select(".bucket-outline").attr("d",(0,s.wh)(g,v).split("z")[0])}),[u,h,g,v]),(0,n.useLayoutEffect)((()=>{const t=f.current.select(".graph-area").selectAll(".bucketBox").data(m).join("rect").attr("class","bucketBox").attr("width",2*g).attr("height",2*v).attr("x",-g/2).attr("fill",((t,e)=>a(e/(d-1))));t.transition("liquidLevel").ease(r.guX.period(.6)).delay(((t,e)=>e*(100/d))).duration(1e3).attr("y",(t=>v-t*v)),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(r.I1g).attrTween("transform",(function(t,e){const a=y?Math.abs(y[e]-t):0;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*a+.5),4*Math.PI))*a*i*(1-t),", ").concat(g/2,", ",0,")")}))}),[m,y,u,h,g,v,d,a]),(0,o.jsx)("div",{className:"bucket-wrapper",children:(0,o.jsx)("svg",{ref:t=>{f.current=r.Ltv(t)}})})}},684:(t,e,a)=>{a.d(e,{Q2:()=>i,YW:()=>l,ZC:()=>c,kd:()=>s,wh:()=>o});var r=a(668),n=a(43);function s(t,e,a){return r.y17(a).map((r=>r/(a-1)*(e-t)+t))}function o(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,s=t*n+t*(1-n)/2,o=t*(1-n)/2,i=[{x:r.GWP(s,t)(a),y:r.GWP(e,0)(a)},{x:s,y:e},{x:o,y:e},{x:r.GWP(o,0)(a),y:r.GWP(e,0)(a)}];return r.n8j().x((function(t){return t.x})).y((function(t){return t.y}))(i)+"z"}function i(t,e,a){let n=t.map((t=>Math.round(t.length/e))),s=r.czq(n);for(;s>a;)n[r.z94(t,((t,a)=>0!==t.length?t.length/e-n[a]:1/0))]-=1,s=r.czq(n);for(;s<a;)n[r.P2Z(t,((t,a)=>0!==t.length?t.length/e-n[a]:-1/0))]+=1,s=r.czq(n);return n}function c(t,e){const a=(0,n.useRef)({value:t,prev:null}),r=a.current.value;return(e?e(t,r):t===r)||(a.current={value:t,prev:r}),a.current.prev}const l=t=>r.dM(r.m4Y([.2,1])(t))},63:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{Vk:()=>i,Xe:()=>d,Zl:()=>c,iL:()=>h,jx:()=>u,pk:()=>o,sQ:()=>l});var n=a(829),s=t([n]);n=(s.then?(await s)():s)[0];const o=1200,i="scens",c="delivs",l="delivs_unord",u=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[i]=e[i];for(const t of e[i]){const e=t[c].map((t=>Math.min(Math.max(0,t),o)));t[l]=e,t[c]=Array.from(e).sort(((t,e)=>e-t))}e[i]=(0,n.Et)(e[i],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,n.Et)(t,(t=>{let{obj:e}=t;return e}))}(),h=Object.keys(u),d=Object.keys(Object.values(u)[0][i]);r()}catch(o){r(o)}}),1)},829:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{C5:()=>P,Et:()=>p,Ng:()=>S,XC:()=>f,Yb:()=>R,bp:()=>j,cv:()=>B,hh:()=>F,i7:()=>W,iJ:()=>O,js:()=>m,nC:()=>z,u:()=>G,xC:()=>L});var n=a(981),s=a(668),o=a(783),i=a.n(o),c=a(43),l=a(63),u=a(684),h=t([l]);function p(t,e){const a=Object.groupBy(t,e);for(const r of Object.keys(a))a[r]=a[r][0];return a}l=(h.then?(await h)():h)[0];const f={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},m="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";const y=Math.SQRT1_2,g=1,v=y+y,k=g+y,x=.75;function w(t){if(t>=x){return Math.SQRT1_2*(1-t)/(1-x)}const e=2*(1-t/(v/k))-1,a=Math.acos(e);return Math.sin(a)}function b(t){return(t-y/k)*(1+Math.SQRT2)}function M(t){return t/(1+Math.SQRT2)+y/k}function j(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=a/2/g*y,n=.1,s=[],o=[];let i,c,l,u;for(let m=1;m<=Math.ceil(10)&&(i=w(t+(m-1)*n),c=b(t+(m-1)*n),l=w(t+m*n),u=b(t+m*n),!(M(u)>=e));m++){const t=[-i*r,-c*r],e=[i*r,-c*r],a=[l*r,-u*r],n=[-l*r,-u*r];s.push(e,a),o.push(t,n)}l=w(e),u=b(e);const h=[-i*r,-c*r],d=[i*r,-c*r],p=[l*r,-u*r],f=[-l*r,-u*r];return s.push(d,p),o.push(h,f),s.push(...o.reverse()),s}function S(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=a/2/g*y,n=.1,s=[];let o,i,c,l;for(let f=1;f<=Math.ceil(10)&&(o=w(t+(f-1)*n),i=b(t+(f-1)*n),c=w(t+f*n),l=b(t+f*n),!(M(l)>=e));f++){const t=[-o*r,-i*r],e=[o*r,-i*r],a=[c*r,-l*r],n=[-c*r,-l*r];s.push([t,e,a]),s.push([t,a,n])}c=w(e),l=b(e);const u=[-o*r,-i*r],h=[o*r,-i*r],d=[c*r,-l*r],p=[-c*r,-l*r];return s.push([u,h,d]),s.push([u,d,p]),s}function P(t,e){return function(a){return e.map((function(e){return[e,s.i2o(a,(function(a){return t(e-a)}))]}))}}function L(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function Z(t){const e=t/2,a=3*Math.PI/2/16,r=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let n=0;n<=16;n++)r.push({x:Math.cos(n*a-Math.PI/4)*e,y:Math.sin(n*a-Math.PI/4)*e});return r}function C(t,e){const a=i().Bounds.create(t),r=a.min.x,n=a.max.x,o=a.min.y,c=a.max.y,l=s.m4Y([r,n]),u=s.m4Y([o,c]),h=[];for(let s=0;s<e;s++)for(;;){const e=l(Math.random()),a=u(Math.random());if(i().Vertices.contains(t,{x:e,y:a})){h.push([e,a]);break}}return h}const T=function(){const t=Z(3),e=Z(1),a=[];for(let r=0;r<t.length-2;r++)a.push([t[r],t[r+(r<2?1:2)],e[r+(r<2?1:2)],e[r]]);return a}();let I,q,V,A;function E(t){const e=s.czq(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function F(t,e,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&V&&a.length===A)return V;I&&a.length===q||(I=s.y17(4).map((()=>C(Z(1),q=a.length))));const n=E(a.map((t=>{let{r:e}=t;return e}))),o=I[Math.floor(Math.random()*I.length)].map((t=>{let[e,a]=t;return[e*n,a*n]})),c=i().Engine,l=i().Bodies,u=i().Composite,h=c.create(),d=o.sort(((t,e)=>e[1]-t[1])),p=a.map(((t,e)=>{let{r:a,id:r}=t;const[n,s]=d[e];return l.circle(n,s,a,{restitution:0,id:r})})),f=T.map((t=>i().Body.create({position:i().Vertices.centre(t),vertices:t,isStatic:!0}))),m=i().Body.create({isStatic:!0});i().Body.setParts(m,f),i().Body.setCentre(m,{x:0,y:0}),i().Body.scale(m,n,n),u.add(h.world,[...p,m]);for(let s=0,i=60,y=.1;s<i*y;s++)c.update(h,1e3/i);const g=p.map((a=>{let{position:r,id:n}=a;return{id:n,x:r.x+t,y:r.y+e}}));return g.height=n/2/y*k,!r||V&&g.length===A||(V=g,A=g.length),g}function z(t,e){const[a,r]=(0,c.useState)(t);return[(0,c.useMemo)((()=>e(a)),[a]),(0,c.useCallback)((t=>{r(e(t))}),[])]}function B(t,e,a,r){const n=a[t][l.Vk][e][l.Zl];return s.m4Y().domain((0,u.kd)(0,1,n.length)).range(n.map((t=>Math.min(1,t/r)))).clamp(!0)}function R(t,e,a){return"median"===t?Object.keys(e[a][l.Vk]).sort(((t,r)=>s.i2o(e[a][l.Vk][t][l.Zl])-s.i2o(e[a][l.Vk][r][l.Zl]))):"deliveries"===t?Object.keys(e[a][l.Vk]).sort(((t,r)=>s.T9B(e[a][l.Vk][t][l.Zl])-s.T9B(e[a][l.Vk][r][l.Zl]))):"alphabetical"===t?Object.keys(e[a][l.Vk]).sort():void 0}function Y(t){return t*Math.PI/180}class W{constructor(t){let{fov:e,near:a,far:r,width:o,height:i,domElement:c,zoomFn:l}=t;this.fov=e,this.near=a,this.far=r,this.width=o,this.height=i,this.camera=new n.ubm(e,o/i,a,r+1),this.camera.position.set(0,0,this.far),this.zoom=s.s_O().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,l&&l(t)})),this.view=s.Ltv(c),this.view.call(this.zoom),this.zoom.transform(this.view,s.GSI.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,a=-(t.transform.x-this.width/2)/e,r=(t.transform.y-this.height/2)/e,n=this.getZFromScale(e);this.camera.position.set(a,r,n)}getScaleFromZ(t){const e=Y(this.fov/2),a=2*(Math.tan(e)*t);return this.height/a}getZFromScale(t){const e=Y(this.fov/2);return this.height/t/(2*Math.tan(e))}}class G{constructor(){this.threeGeom=new n.V23,this.idx=0}addMeshCoords(t,e,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=[];for(let o=0;o<t.length;o++){const[i,c,l]=t[o],u=new n.Pq0(e.x+i[0],e.y-i[1],r),h=new n.Pq0(e.x+c[0],e.y-c[1],r),d=new n.Pq0(e.x+l[0],e.y-l[1],r);this.threeGeom.vertices.push(u,h,d);const p=new n.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);a&&(p.vertexColors.push(a),p.vertexColors.push(a),p.vertexColors.push(a)),this.threeGeom.faces.push(p),s.push(this.idx++)}return s}}function O(t){const[e,a]=(0,c.useState)(t),r=(0,c.useRef)(t);(0,c.useEffect)((()=>{r.current=e}),[e]);const n=(0,c.useCallback)((t=>{a(r.current=t)}),[]);return[e,n,r]}r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=397.11876b69.chunk.js.map