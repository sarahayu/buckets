"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[397],{397:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.r(e),a.d(e,{default:()=>v});var n=a(760),s=a(43),i=a(999),l=a(111),c=a(135),o=a(146),p=a(823),d=a(394),u=a(569),A=a(323),m=a(579),h=t([u,A]);function v(){const[t,e]=(0,s.useState)(p.A.DEFAULT_OBJECTIVE),a=(0,A.A)(t),r=(0,u.R)(a,t);return(0,s.useEffect)((function(){(0,d.f2)(".bucket-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-drop-graphics-wrapper"),a.setReadyHash((t=>t+1))}),[t]),(0,m.jsxs)("div",{className:"tutorial-view",children:[(0,m.jsx)(f,{val:t,setVal:e,options:Object.keys(p.A.SELECTED_OBJS).map((t=>({options:t,display_name:p.A.SELECTED_OBJS[t]})))}),(0,m.jsxs)("div",{className:"scrollama scrollama-1",children:[(0,m.jsx)(T,{curObjective:t,tutorialState:a}),(0,m.jsx)(g,{slides:r})]})]})}function T(t){let{curObjective:e,tutorialState:a}=t;const r="NDO"===e?n.quantile(a.objectiveDelivs,.75):n.max(a.objectiveDelivs),s={data:a.objectiveDelivs,max:r};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(I,{label:p.A.SELECTED_OBJS[e],bucketInterper:a.bucketInterper}),(0,m.jsx)(x,{label:p.A.SELECTED_OBJS[e],mainDropInterper:a.dropInterper,mainHistData:s,variations:p.A.VARIATIONS.map((t=>({...t,interper:a.variationInterpers[t.idx],histData:{data:a.objectiveVariationDelivs[t.idx],max:r}})))})]})}function g(t){let{slides:e}=t;return(0,m.jsx)(j,{cleanupFn:()=>{for(let a=e.length-1;a>=0;a--){var t;null===(t=e[a].animHandler)||void 0===t||t.undo()}},children:e.map(((t,e)=>(0,m.jsx)(i.p,{data:t,children:(0,m.jsx)(H,{slide:t})},e)))})}function f(t){let{val:e,setVal:a,options:r}=t;return(0,m.jsx)("select",{value:e,onChange:t=>a(t.target.value),children:r.map(((t,e)=>{let{option:a,display_name:r}=t;return(0,m.jsx)("option",{value:a,children:r},e)}))})}function x(t){let{label:e,mainDropInterper:a,mainHistData:r,variations:n}=t;return(0,m.jsxs)("div",{className:"tut-drop-graphics-wrapper",children:[(0,m.jsx)(y,{dropInterper:a,histData:r,label:e}),n.map(((t,e)=>(0,m.jsx)(b,{variation:t},e)))]})}function y(t){let{dropInterper:e,histData:a,label:r}=t;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"main-waterdrop",children:(0,m.jsx)(o.A,{levelInterp:e,width:400,height:p.A.BAR_CHART_HEIGHT,colorInterp:p.A.INTERP_COLOR})}),(0,m.jsx)("div",{className:"main-histogram",children:(0,m.jsx)(c.A,{width:330,height:220,data:a.data,domain:[0,a.max]})}),(0,m.jsx)("p",{className:"fancy-font objective-label",children:r})]})}function b(t){let{variation:e}=t;const{idx:a,clas:r,desc:n,interper:s,histData:i}=e;return(0,m.jsxs)("div",{className:"vardrop ".concat(r),desc:n,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)(o.A,{levelInterp:s,width:200,height:p.A.BAR_CHART_HEIGHT/2,colorInterp:p.A.INTERP_COLOR}),(0,m.jsx)(c.A,{width:330,height:220,data:i.data,domain:[0,i.max]})]}),(0,m.jsx)("p",{className:"var-scen-label",children:n})]},a)}function I(t){let{label:e,bucketInterper:a}=t;return(0,m.jsx)("div",{className:"tut-graph-wrapper",children:(0,m.jsxs)("div",{className:"tut-graph",children:[(0,m.jsx)("svg",{id:"pag-bar-graph"}),(0,m.jsx)(l.A,{levelInterp:a,width:300,height:p.A.BAR_CHART_HEIGHT,colorInterp:p.A.INTERP_COLOR}),(0,m.jsx)("p",{className:"fancy-font objective-label",children:e})]})})}function j(t){let{cleanupFn:e,children:a}=t;return(0,m.jsxs)(i.h,{offset:.9,onStepEnter:async t=>{var e;let{data:a,direction:r}=t;"up"!==r&&(null===(e=a.animHandler)||void 0===e||e.do())},onStepExit:async t=>{var e;let{data:a,direction:r}=t;"down"!==r&&(null===(e=a.animHandler)||void 0===e||e.undo())},children:[a,(0,m.jsx)(i.p,{data:{},children:(0,m.jsx)(R,{cleanupFn:e})},"last")]})}[u,A]=h.then?(await h)():h;const H=(0,s.forwardRef)((function(t,e){let{slide:a}=t;return(0,m.jsx)("div",{ref:e,className:"tut-text-card",children:a.text})})),R=(0,s.forwardRef)((function(t,e){let{cleanupFn:a}=t;return(0,m.jsx)("div",{ref:e,className:"tut-text-card",style:{marginBottom:"40vh"},children:(0,m.jsx)("button",{onClick:()=>{window.scrollTo(0,0),a()},children:"Back to Top"})})}));r()}catch(_){r(_)}}))},554:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{Vk:()=>i,Zl:()=>l,jx:()=>o});var n=a(343),s=t([n]);n=(s.then?(await s)():s)[0];const i="scens",l="delivs",c="delivs_unord",o=await async function(){const t=await(await fetch("./select_complete_objectives.json")).json();for(const e of t){for(const t of e[i])t[c]=Array.from(t[l]),t[l]=Array.from(t[l]).sort(((t,e)=>e-t));e[i]=(0,n.Et)(e[i],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,n.Et)(t,(t=>{let{obj:e}=t;return e}))}();Object.keys(o),Object.keys(Object.values(o)[0][i]);r()}catch(i){r(i)}}),1)},823:(t,e,a)=>{a.d(e,{A:()=>n});a(760);function r(t,e){let{scen_num_str:a,desc:r}=t;return{idx:e,scen_num_str:a,desc:r,scen_str:"expl".concat(a),clas:"drop".concat(e+1)}}const n={BAR_CHART_WIDTH:500,BAR_CHART_HEIGHT:400,INTERP_COLOR:a(684).YW,DEFAULT_OBJECTIVE:"DEL_NOD_AG_TOTAL",BASELINE_SCENARIO:"expl0000",VARIATIONS:[{scen_num_str:"0129",desc:"natural flows"},{scen_num_str:"0015",desc:"reduce delta regs."},{scen_num_str:"0320",desc:"prioritize carryover"},{scen_num_str:"0360",desc:"municipal priority"},{scen_num_str:"0261",desc:"rebalancing"}].map(r),SELECTED_OBJS:{DEL_NOD_AG_TOTAL:"DEL_NOD_AG_TOTAL",DEL_SJV_AG_TOTAL:"DEL_SJV_AG_TOTAL",DEL_NOD_MI_TOTAL:"DEL_NOD_MI_TOTAL",DEL_SJV_MI_TOTAL:"DEL_SJV_MI_TOTAL",DEL_SOCAL_MI_TOTAL:"DEL_SOCAL_MI_TOTAL",CVP_SWP_EXPORTS:"CVP_SWP_EXPORTS",NDO:"NDO",SAC_IN:"SAC_IN",SJR_IN:"SJR_IN",STO_NOD_TOTAL:"STO_NOD_TOTAL",STO_SOD_TOTAL:"STO_SOD_TOTAL"}}},479:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{W:()=>m});var n=a(760),s=a(554),i=a(823),l=a(394),c=a(63),o=(a(684),a(343)),p=t([s,c,o]);[s,c,o]=p.then?(await p)():p;const u="expl0000";function A(){return{initChartAnimGroup:function(t){let e,a,r,l,{deps:o,objective:p}=t;const d=40,A=30,m=40,h=60;return function(){{n.select("#pag-bar-graph > *").remove();const t=n.select("#pag-bar-graph").attr("width",i.A.BAR_CHART_WIDTH+h+A).attr("height",i.A.BAR_CHART_HEIGHT+d+m).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(h,",").concat(d,")")),o=s.jx[p][c.Vk][u][c.sQ];l="NDO"===p?n.quantile(o,.75):n.max(o);const _=o.map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(((t,e)=>e.val-t.val)),v=n.scaleBand().domain(_.map((t=>{let{year:e}=t;return e})).sort(((t,e)=>t-e))).range([0,i.A.BAR_CHART_WIDTH]).padding(.4),T=n.scaleLinear().domain([0,l]).range([i.A.BAR_CHART_HEIGHT,0]),g=n.axisBottom(v).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(v.domain().filter(((t,e)=>0===e||(e+1)%10===0)));t.append("g").attr("class","anim-xaxis"),t.append("g").attr("class","axis-y"),t.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT,")")).call(g).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),t.select(".axis-y").call(n.axisLeft(T).tickFormat(n.format(".2s"))).append("text").text("Deliveries (TAF)").attr("fill","black").attr("font-weight","bold").attr("transform","translate(-50, ".concat(i.A.BAR_CHART_HEIGHT/2,") rotate(-90)")),e=v,a=g,r=_}}(),{barsAppear:{do:function(){{const t=n.scaleLinear().domain([0,l]).range([i.A.BAR_CHART_HEIGHT,0]);n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(r,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(t=>e(t.year))).attr("y",i.A.BAR_CHART_HEIGHT).attr("width",e.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(e=>t(e.val))).attr("height",(e=>i.A.BAR_CHART_HEIGHT-t(e.val)))}},undo:function(){n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(r,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(r.length-t.placeFromLeft-1))).attr("y",i.A.BAR_CHART_HEIGHT).attr("height",0)}},barsCondense:{do:async function(){{const t=i.A.BAR_CHART_WIDTH/8,e=n.select("#pag-bar-graph .svg-group");e.select(".anim-xaxis").call(a.tickFormat(""));const s=e.selectAll(".bars");s.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((t=>100+1e3*(1-(1-t.placeFromLeft/r.length)**4))).duration(500).attr("width",t).attr("x",i.A.BAR_CHART_WIDTH/2-t/2).end().catch((()=>{})).then((()=>{e.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),s.transition().delay(500).attr("x",0),e.transition().delay(500).attr("transform","translate(".concat(h+i.A.BAR_CHART_WIDTH/2-t/2,",").concat(d,")"))}))}},undo:function(){{const t=n.select("#pag-bar-graph .svg-group"),s=t.selectAll(".bars");t.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),t.select(".anim-xaxis").call(a.tickFormat((t=>"year ".concat(t)))),t.transition().delay(500).attr("transform","translate(".concat(h,",").concat(d,")")),s.transition().delay((t=>100+1e3*(1-(t.placeFromLeft/r.length)**4))).duration(500).attr("x",(t=>e(t.year))).attr("width",e.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{s.style("mix-blend-mode","normal")}))}}}}},initBucketsFillAnim:function(t){let{deps:e,objective:a}=t;return{do:function(){n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","initial"),n.select("#pag-bar-graph").attr("opacity",0),e.setBucketInterper((()=>e.objectiveInterper))},undo:function(){e.setBucketInterper((()=>n.scaleLinear().range([0,0]))),n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","none"),n.select("#pag-bar-graph").transition().attr("opacity",1)}}},initDropFillAnim:function(t){let{deps:e,objective:a}=t;return{do:function(){(0,l.YB)(".main-waterdrop"),(0,l.YB)(".tut-drop-graphics-wrapper",n,"grid"),(0,l.f2)(".tut-graph-wrapper, .bucket-wrapper"),e.setDropInterper((()=>e.objectiveInterperDrop))},undo:function(){(0,l.f2)(".tut-drop-graphics-wrapper, .main-waterdrop"),(0,l.YB)(".bucket-wrapper"),(0,l.YB)(".tut-graph-wrapper",n,"flex"),e.setDropInterper((()=>n.scaleLinear().range([0,0])))}}},initShowVariationsAnim:function(t){let{deps:e}=t;return{do:function(){n.selectAll(".vardrop").style("display","initial").classed("hasarrow",!0),n.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","none"),e.setVariationInterpers(e.objectiveVariationInterpers),n.selectAll(".var-scen-label").style("display","block"),n.selectAll(".var-scen-label").style("opacity","1"),n.select(".main-waterdrop").transition().style("transform","translateY(100px) scale(0.5)"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(2)"),n.select(".main-histogram").style("display","initial"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","initial")},undo:function(){n.select(".main-waterdrop").transition().style("transform","none"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(1)"),n.select(".main-histogram").style("display","none"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","none"),n.selectAll(".var-scen-label").style("display","none"),n.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","initial"),n.selectAll(".vardrop").style("display","none").classed("hasarrow",!1),e.setVariationInterpers(i.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0]))))}}}}}const m=A();r()}catch(d){r(d)}}))},569:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{R:()=>c});var n=a(43),s=a(479),i=t([s]);function c(t,e,a){const[r,i]=(0,n.useState)([]);return(0,n.useEffect)((function(){if(0===t.readyHash)return;const r={deps:t,objective:e,scenario:a},n=s.W.initChartAnimGroup(r),l=s.W.initBucketsFillAnim(r),c=s.W.initDropFillAnim(r),o=s.W.initShowVariationsAnim(r),p=[{name:"barsAppear",animHandler:n.barsAppear,text:"Bar Graph"},{name:"barsCondense",animHandler:n.barsCondense,text:"Gradient"},{name:"bucketsFill",animHandler:l,text:"Bucket"},{name:"forNowLetsFocus",animHandler:c,text:"Waterdrop"},{name:"ifChangeReality",animHandler:o,text:"Different Scenarios"}];i(p)}),[t.readyHash]),r}s=(i.then?(await i)():i)[0],r()}catch(l){r(l)}}))},323:(t,e,a)=>{a.a(t,(async(t,r)=>{try{a.d(e,{A:()=>u});var n=a(760),s=a(43),i=a(684),l=a(554),c=a(823),o=a(343),p=t([l,o]);function u(t){const[e,a]=(0,s.useState)(0),[r,p]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[d,u]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[A,m]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[h,_]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[v,T]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0]))))),[g,f]=(0,s.useState)((()=>[])),[x,y]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>[])))),[b,I]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0])))));return(0,s.useEffect)((()=>{p((()=>n.scaleLinear().range([0,0]))),u((()=>n.scaleLinear().range([0,0]))),T((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0])))));const e=l.jx[t][l.Vk][c.A.BASELINE_SCENARIO][l.Zl],a="NDO"===t?n.quantile(e,.75):n.max(e);f((()=>e));const r=n.scaleLinear().domain((0,i.kd)(0,1,e.length)).range(e.map((t=>t/a)).sort().reverse()).clamp(!0),s=t=>(0,o.si)(n.scaleLinear().domain((0,i.kd)(0,1,e.length)).range(e.map((t=>t/a)).sort().reverse()).clamp(!0)(t));m((()=>r)),_((()=>s));const d=c.A.VARIATIONS.map((e=>{let{scen_str:a}=e;return l.jx[t][l.Vk][a][l.Zl]})),A=d.map((t=>e=>(0,o.si)(n.scaleLinear().domain((0,i.kd)(0,1,t.length)).range(t.map((t=>t/a)).sort().reverse()).clamp(!0)(e))));y((()=>d)),I((()=>A))}),[t]),{readyHash:e,setReadyHash:a,bucketInterper:r,setBucketInterper:p,dropInterper:d,setDropInterper:u,variationInterpers:v,setVariationInterpers:T,objectiveDelivs:g,objectiveInterper:A,objectiveInterperDrop:h,objectiveVariationDelivs:x,objectiveVariationInterpers:b}}[l,o]=p.then?(await p)():p,r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=397.f979e10c.chunk.js.map