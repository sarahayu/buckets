"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[397],{397:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.r(e),r.d(e,{default:()=>b});var a=r(760),o=r(43),s=r(999),i=r(111),c=r(146),l=r(135),u=r(569),d=r(823),h=r(394),p=r(554),f=r(684),m=r(579),g=t([l,u,p]);[l,u,p]=g.then?(await g)():g;const v="expl0000";function b(){const[t,e]=(0,o.useState)(d.A.DEFAULT_OBJECTIVE),r=A(t),n=(0,u.R)(r,t);(0,o.useEffect)((function(){(0,h.f2)(".bucket-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-drop-graphics-wrapper"),console.log("obj change in effect"),r.setReadyHash((t=>t+1))}),[t]);const p=n("barsAppear","ifChangeReality");return(0,m.jsxs)("div",{className:"tutorial-view",children:[(0,m.jsx)("select",{value:t,onChange:t=>e(t.target.value),children:["SWPTOTALDEL","DEL_CVP_TOTAL","DEL_SWP_PMI","DEL_CVP_PAG","DEL_CVP_PSC_PEX","S_NOD","S_SHSTA","S_OROVL"].map((t=>(0,m.jsx)("option",{value:t,children:t},t)))}),(0,m.jsxs)("div",{className:"scrollama scrollama-1",children:[(0,m.jsx)("div",{className:"tut-graph-wrapper",children:(0,m.jsxs)("div",{className:"tut-graph",children:[(0,m.jsx)("svg",{id:"pag-bar-graph"}),(0,m.jsx)(i.A,{levelInterp:r.bucketInterper,width:300,height:d.A.BAR_CHART_HEIGHT,colorInterp:d.A.INTERP_COLOR}),(0,m.jsx)("p",{className:"fancy-font objective-label",children:t})]})}),(0,m.jsxs)("div",{className:"tut-drop-graphics-wrapper",children:[(0,m.jsx)("div",{className:"main-waterdrop",children:(0,m.jsx)(c.A,{levelInterp:r.dropInterper,width:400,height:d.A.BAR_CHART_HEIGHT,colorInterp:d.A.INTERP_COLOR})}),(0,m.jsx)("div",{className:"main-histogram",children:(0,m.jsx)(l.A,{width:210,height:140,data:r.objectiveDelivs,domain:[0,a.max(r.objectiveDelivs)]})}),d.A.DROP_VARIATIONS.map((t=>{let{idx:e,scen:n,clas:o,desc:s}=t;return(0,m.jsxs)("div",{className:"vardrop ".concat(o),desc:s,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)(c.A,{levelInterp:r.variationInterpers[e],width:200,height:2*d.A.BAR_CHART_HEIGHT/3/2,colorInterp:d.A.INTERP_COLOR}),(0,m.jsx)(l.A,{width:210,height:140,data:r.objectiveVariationDelivs[e],domain:[0,a.max(r.objectiveDelivs)]})]}),(0,m.jsxs)("p",{className:"var-scen-label",children:["scenario ",(0,m.jsx)("span",{className:"scen-number",children:n})]})]},e)})),(0,m.jsx)("p",{className:"fancy-font objective-label",children:t})]}),(0,m.jsxs)(s.h,{offset:.9,onStepEnter:async t=>{var e;let{data:r,direction:n}=t;"up"!==n&&(null===(e=r.animHandler)||void 0===e||e.do())},onStepExit:async t=>{var e;let{data:r,direction:n}=t;"down"!==n&&(null===(e=r.animHandler)||void 0===e||e.undo())},children:[p.map(((t,e)=>(0,m.jsx)(s.p,{data:t,children:(0,m.jsx)("div",{className:"tut-text-card",children:t.text})},e))),(0,m.jsx)(s.p,{data:{},children:(0,m.jsx)("div",{className:"tut-text-card",style:{marginBottom:"40vh"},children:(0,m.jsx)("button",{onClick:()=>{window.scrollTo(0,0);for(let e=p.length-1;e>=0;e--){var t;null===(t=p[e].animHandler)||void 0===t||t.undo()}},children:"Back to Top"})})},"last")]})]})]})}function A(t){const[e,r]=(0,o.useState)(0),[n,s]=(0,o.useState)((()=>a.scaleLinear().range([0,0]))),[i,c]=(0,o.useState)((()=>a.scaleLinear().range([0,0]))),[l,u]=(0,o.useState)((()=>d.A.VARIATIONS.map((()=>a.scaleLinear().range([0,0]))))),[h,m]=(0,o.useState)((()=>[])),[g,y]=(0,o.useState)((()=>a.scaleLinear().range([0,0]))),[b,A]=(0,o.useState)((()=>d.A.VARIATIONS.map((()=>[])))),[x,w]=(0,o.useState)((()=>d.A.VARIATIONS.map((()=>a.scaleLinear().range([0,0])))));return(0,o.useEffect)((()=>{s((()=>a.scaleLinear().range([0,0]))),c((()=>a.scaleLinear().range([0,0]))),u((()=>d.A.VARIATIONS.map((()=>a.scaleLinear().range([0,0])))));const e=p.jx[t][p.Vk][v][p.Zl],r=a.max(e),n=a.scaleLinear().domain((0,f.kd)(0,1,e.length)).range(e.map((t=>t/r)).sort().reverse()).clamp(!0);m((()=>e)),y((()=>n));const o=d.A.VARIATIONS.map((e=>p.jx[t][p.Vk][e][p.Zl])),i=o.map((t=>a.scaleLinear().domain((0,f.kd)(0,1,t.length)).range(t.map((t=>t/r)).sort().reverse()).clamp(!0)));A((()=>o)),w((()=>i)),console.log("obj change in usestate")}),[t]),{readyHash:e,setReadyHash:r,bucketInterper:n,setBucketInterper:s,dropInterper:i,setDropInterper:c,variationInterpers:l,setVariationInterpers:u,objectiveDelivs:h,objectiveInterper:g,objectiveVariationDelivs:b,objectiveVariations:x}}n()}catch(y){n(y)}}))},111:(t,e,r)=>{r.d(e,{A:()=>u});var n=r(760),a=r(43),o=r(684),s=r(579);const i=40,c=10,l=3;function u(t){let{levelInterp:e,colorInterp:r=o.YW,width:u=200,height:d=400,resolution:h=c}=t;const p=(0,a.useId)(),f=(0,a.useRef)(),m=(0,a.useMemo)((()=>(0,o.kd)(0,1-1/h,h).map((t=>e(t)))),[e,h]),g=(0,o.ZC)(m),y=u-2*l,v=d-l;return(0,a.useLayoutEffect)((()=>{const t=f.current.append("g").attr("class","svg-container").attr("transform","translate(".concat(l,", ").concat(l/2,")"));t.append("defs").append("clipPath").attr("id","bucket-mask-"+p).append("path").attr("class","bucket-mask-path"),t.append("g").attr("class","graph-area").attr("clip-path","url(#bucket-mask-".concat(p,")")),t.append("g").append("path").attr("class","bucket-outline").attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",l).attr("fill","none")}),[p]),(0,a.useLayoutEffect)((()=>{const t=f.current.attr("width",u).attr("height",d).select(".svg-container");t.select(".bucket-mask-path").attr("d",(0,o.wh)(y,v)),t.select(".bucket-outline").attr("d",(0,o.wh)(y,v).split("z")[0])}),[u,d,y,v]),(0,a.useLayoutEffect)((()=>{const t=f.current.select(".graph-area").selectAll(".bucketBox").data(m).join("rect").attr("class","bucketBox").attr("width",2*y).attr("height",2*v).attr("x",-y/2).attr("fill",((t,e)=>r(e/(h-1))));t.transition("liquidLevel").ease(n.easeElasticOut.period(.6)).delay(((t,e)=>e*(100/h))).duration(1e3).attr("y",(t=>v-t*v)),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(n.easeQuad).attrTween("transform",(function(t,e){const r=g?Math.abs(g[e]-t):0;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*r+.5),4*Math.PI))*r*i*(1-t),", ").concat(y/2,", ",0,")")}))}),[m,g,u,d,y,v,h,r]),(0,s.jsx)("div",{className:"bucket-wrapper",children:(0,s.jsx)("svg",{ref:t=>{f.current=n.select(t)}})})}},987:(t,e,r)=>{r.d(e,{u:()=>o});var n=r(760),a=r(684);function o(t,e,r,o,s){const i=t.length/r;let c=n.histogram().value((t=>t)).domain(e).thresholds((0,a.kd)(...e,Math.ceil(o/(s/i))))(t),l=(0,a.Q2)(c,r,i),u=[];for(let n=0;n<l.length;n++)for(let e=0;e<l[n];e++)u.push([(c[n].x1+c[n].x0)/2,(e+.5)/i*t.length]);return u}},684:(t,e,r)=>{r.d(e,{Q2:()=>i,YW:()=>l,ZC:()=>c,kd:()=>o,wh:()=>s});var n=r(760),a=r(43);function o(t,e,r){return n.range(r).map((n=>n/(r-1)*(e-t)+t))}function s(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,o=t*a+t*(1-a)/2,s=t*(1-a)/2,i=[{x:n.interpolate(o,t)(r),y:n.interpolate(e,0)(r)},{x:o,y:e},{x:s,y:e},{x:n.interpolate(s,0)(r),y:n.interpolate(e,0)(r)}];return n.line().x((function(t){return t.x})).y((function(t){return t.y}))(i)+"z"}function i(t,e,r){let a=t.map((t=>Math.round(t.length/e))),o=n.sum(a);for(;o>r;)a[n.minIndex(t,((t,r)=>0!==t.length?t.length/e-a[r]:1/0))]-=1,o=n.sum(a);for(;o<r;)a[n.maxIndex(t,((t,r)=>0!==t.length?t.length/e-a[r]:-1/0))]+=1,o=n.sum(a);return a}function c(t,e){const r=(0,a.useRef)({value:t,prev:null}),n=r.current.value;return(e?e(t,n):t===n)||(r.current={value:t,prev:n}),r.current.prev}const l=t=>n.interpolateBlues(n.scaleLinear([.2,1])(t))},554:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{Vk:()=>i,Zl:()=>c,jx:()=>u});var a=r(343),o=t([a]);a=(o.then?(await o)():o)[0];const i="scens",c="delivs",l="delivs_unord",u=await async function(){const t=await(await fetch("./select_complete_objectives.json")).json();for(const e of t){for(const t of e[i])t[l]=Array.from(t[c]),t[c]=Array.from(t[c]).sort(((t,e)=>e-t));e[i]=(0,a.Et)(e[i],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),d((0,a.Et)(t,(t=>{let{obj:e}=t;return e})))}();Object.keys(u),Object.keys(Object.values(u)[0][i]);function d(t){const e=Object.keys(Object.values(t)[0][i]),r=t.DEL_CVP_TOTAL_N,n=t.DEL_CVP_TOTAL_S,a=h(r);for(const h of e){{const t=a[i][h][c],e=n[i][h][c];for(let r=0;r<t.length;r++)t[r]+=e[r]}{const t=a[i][h][l],e=n[i][h][l];for(let r=0;r<t.length;r++)t[r]+=e[r]}}t.DEL_CVP_TOTAL=a;const o=t.DEL_CVP_PAG_N,s=t.DEL_CVP_PAG_S,u=h(o);for(const h of e){{const t=u[i][h][c],e=s[i][h][c];for(let r=0;r<t.length;r++)t[r]+=e[r]}{const t=u[i][h][l],e=s[i][h][l];for(let r=0;r<t.length;r++)t[r]+=e[r]}}t.DEL_CVP_PAG=u;const d=t.DEL_CVP_PSC_N,p=t.DEL_CVP_PEX_S,f=h(d);for(const h of e){{const t=f[i][h][c],e=p[i][h][c];for(let r=0;r<t.length;r++)t[r]+=e[r]}{const t=f[i][h][l],e=p[i][h][l];for(let r=0;r<t.length;r++)t[r]+=e[r]}}t.DEL_CVP_PSC_PEX=f;const m=t.S_SHSTA,g=t.S_OROVL,y=t.S_TRNTY,v=t.S_FOLSM,b=h(m);for(const h of e){{const t=b[i][h][c],e=g[i][h][c],r=y[i][h][c],n=v[i][h][c];for(let a=0;a<t.length;a++)t[a]+=e[a]+r[a]+n[a]}{const t=b[i][h][l],e=g[i][h][l],r=y[i][h][l],n=v[i][h][l];for(let a=0;a<t.length;a++)t[a]+=e[a]+r[a]+n[a]}}return t.S_NOD=b,t}function h(t){return JSON.parse(JSON.stringify(t))}n()}catch(s){n(s)}}),1)},63:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{Vk:()=>i,Xe:()=>h,Zl:()=>c,iL:()=>d,jx:()=>u,pk:()=>s,sQ:()=>l});var a=r(343),o=t([a]);a=(o.then?(await o)():o)[0];const s=1200,i="scens",c="delivs",l="delivs_unord",u=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[i]=e[i];for(const t of e[i]){const e=t[c].map((t=>Math.min(Math.max(0,t),s)));t[l]=e,t[c]=Array.from(e).sort(((t,e)=>e-t))}e[i]=(0,a.Et)(e[i],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,a.Et)(t,(t=>{let{obj:e}=t;return e}))}(),d=Object.keys(u),h=Object.keys(Object.values(u)[0][i]);n()}catch(s){n(s)}}),1)},135:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{A:()=>f});var a=r(760),o=r(43),s=r(987),i=r(63),c=r(579),l=t([i]);i=(l.then?(await l)():l)[0];const d=20,h={top:10,right:10,bottom:20,left:10},p={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}};function f(t){let{data:e,domain:r=[0,a.max(e)],width:n=600,height:i=400}=t;const l=(0,o.useRef)(),u=(0,o.useMemo)((()=>(0,s.u)(e,r,e.length/d,n,i)),[e]),f=[0,e.length],m=a.scaleLinear().domain(r).range([0,n]),g=a.scaleLinear().domain(f).range([i,0]);return(0,o.useEffect)((()=>{l.current.selectAll("*").remove();const t=l.current.attr("width",n+h.left+h.right).attr("height",i+h.top+h.bottom).style("pointer-events","none").append("g").attr("class","graph-area").attr("transform","translate(".concat(h.left,",").concat(h.top,")"));console.log(e),t.append("g").attr("transform","translate(0, ".concat(i,")")).call(a.axisBottom().scale(m).tickFormat(a.format(".2s"))).call((t=>{t.selectAll("line").attr("stroke","gray"),t.selectAll("path").attr("stroke","gray"),t.selectAll("text").attr("fill","gray")})).append("text").attr("fill","black").attr("transform","translate(".concat(n/2,", ",30,")")).text("Delivery (TAF)")}),[e]),(0,o.useEffect)((()=>{const t=l.current.select(".graph-area").selectAll(".icons").data(u).join((t=>t.append("g").call((t=>t.append("path"))))).attr("class","icons").call((t=>{t.selectAll("path").attr("d",a.symbol(p,i/d))}));t.attr("transform",(t=>"translate(".concat(m(t[0]),",").concat(g(t[1]),")"))),t.attr("fill","steelblue")}),[u]),(0,c.jsx)("div",{className:"dot-histogram-wrapper",children:(0,c.jsx)("svg",{ref:t=>{l.current=a.select(t)}})})}n()}catch(u){n(u)}}))},146:(t,e,r)=>{r.d(e,{A:()=>f});var n=r(760),a=r(43),o=r(684),s=r(394),i=r(579);const c=Math.SQRT1_2,l=1,u=l+c,d=40,h=10,p=3;function f(t){let{levelInterp:e,colorInterp:r=o.YW,width:c=200,height:f=400,resolution:m=h}=t;const g=(0,a.useId)(),y=(0,a.useRef)(),v=(0,a.useMemo)((()=>(0,o.kd)(0,1-1/m,m).map((t=>e(t)))),[e,m]),b=(0,o.ZC)(v),A=c-2*p,x=f-p;return(0,a.useLayoutEffect)((()=>{const t=y.current.append("g").attr("class","svg-container").attr("transform","translate(".concat(p,", ").concat(p/2,")"));t.append("defs").append("clipPath").attr("id","bucket-mask-"+g).append("path").attr("class","bucket-mask-path"),t.append("g").attr("class","graph-area").attr("clip-path","url(#bucket-mask-".concat(g,")")),t.append("g").append("path").attr("class","bucket-outline").attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",p).attr("fill","none")}),[g]),(0,a.useLayoutEffect)((()=>{const t=y.current.attr("width",c).attr("height",f).select(".svg-container"),e=function(t,e){let[r,a]=e;const o=(0,s.bp)(0,1,t,20);return n.line().x((function(t){return t[0]+r})).y((function(t){return t[1]+a}))(o)+"z"}(x*(2*l)/u,[c/2,f*l/u]);t.select(".bucket-mask-path").attr("d",e),t.select(".bucket-outline").attr("d",e)}),[c,f,A,x]),(0,a.useLayoutEffect)((()=>{const t=y.current.select(".graph-area").selectAll(".bucketBox").data(v).join("rect").attr("class","bucketBox").attr("width",2*A).attr("height",2*x).attr("x",-A/2).attr("fill",((t,e)=>r(e/(m-1))));t.transition("liquidLevel").ease(n.easeElasticOut.period(.6)).delay(((t,e)=>e*(100/m))).duration(1e3).attr("y",(t=>x-t*x)),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(n.easeQuad).attrTween("transform",(function(t,e){const r=b?Math.abs(b[e]-t):0;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*r+.5),4*Math.PI))*r*d*(1-t),", ").concat(A/2,", ",0,")")}))}),[v,b,c,f,A,x,m,r]),(0,i.jsx)("div",{className:"waterdrop-wrapper",children:(0,i.jsx)("svg",{ref:t=>{y.current=n.select(t)}})})}},823:(t,e,r)=>{r.d(e,{A:()=>n});const n={BAR_CHART_WIDTH:500,BAR_CHART_HEIGHT:400,INTERP_COLOR:r(760).interpolateRgbBasis(["#F2F5FB","#D0DDEB","#7B9BC0","#4F739F","#112A57"]),DEFAULT_OBJECTIVE:"SWPTOTALDEL",DEFAULT_SCENARIO:"expl0000",VARIATIONS:["expl0015","expl0129","expl0512","expl0003","expl0320"],DROP_VARIATIONS:[{idx:0,scen:"0015",clas:"drop1",desc:"no delta reg."},{idx:1,scen:"0129",clas:"drop2",desc:"natural flows"},{idx:2,scen:"0512",clas:"drop3",desc:"shifting priorities"},{idx:3,scen:"0003",clas:"drop4",desc:"functional flows"},{idx:4,scen:"0320",clas:"drop5",desc:"prioritize carryovers"}]}},479:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{W:()=>m});var a=r(760),o=r(554),s=r(823),i=r(394),c=r(63),l=r(684),u=t([o,c]);[o,c]=u.then?(await u)():u;const h="expl0000";function p(t){const e=o.jx[t][c.Vk][h][c.sQ],r=a.max(e);return a.scaleLinear().domain((0,l.kd)(0,1,e.length)).range(e.map((t=>t/r)).sort().reverse()).clamp(!0)}function f(){return{initChartAnimGroup:function(t){let e,r,n,i,{deps:l,objective:u}=t;const d=40,p=30,f=40,m=60;return function(){{a.select("#pag-bar-graph > *").remove();const t=a.select("#pag-bar-graph").attr("width",s.A.BAR_CHART_WIDTH+m+p).attr("height",s.A.BAR_CHART_HEIGHT+d+f).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(m,",").concat(d,")")),l=o.jx[u][c.Vk][h][c.sQ];i=a.max(l);const g=l.map(((t,e)=>({val:t,placeFromLeft:e,year:e+1}))).sort(((t,e)=>e.val-t.val)),y=a.scaleBand().domain(g.map((t=>{let{year:e}=t;return e})).sort(((t,e)=>t-e))).range([0,s.A.BAR_CHART_WIDTH]).padding(.4),v=a.scaleLinear().domain([0,i]).range([s.A.BAR_CHART_HEIGHT,0]),b=a.axisBottom(y).tickSize(0).tickFormat((t=>"year ".concat(t))).tickValues(y.domain().filter(((t,e)=>0===e||(e+1)%10===0)));t.append("g").attr("class","anim-xaxis"),t.append("g").attr("class","axis-y"),t.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).call(b).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),t.select(".axis-y").call(a.axisLeft(v).tickFormat(a.format(".2s"))).append("text").text("Deliveries (TAF)").attr("fill","black").attr("font-weight","bold").attr("transform","translate(-50, ".concat(s.A.BAR_CHART_HEIGHT/2,") rotate(-90)")),e=y,r=b,n=g}}(),{barsAppear:{do:function(){{const t=a.scaleLinear().domain([0,i]).range([s.A.BAR_CHART_HEIGHT,0]);a.select("#pag-bar-graph .svg-group").selectAll(".bars").data(n,(t=>t.placeFromLeft)).join("rect").attr("class","bars").attr("x",(t=>e(t.year))).attr("y",s.A.BAR_CHART_HEIGHT).attr("width",e.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((t=>10*t.placeFromLeft)).attr("y",(e=>t(e.val))).attr("height",(e=>s.A.BAR_CHART_HEIGHT-t(e.val)))}},undo:function(){a.select("#pag-bar-graph .svg-group").selectAll(".bars").data(n,(t=>t.placeFromLeft)).transition().duration(500).delay((t=>10*(n.length-t.placeFromLeft-1))).attr("y",s.A.BAR_CHART_HEIGHT).attr("height",0)}},barsCondense:{do:async function(){{const t=s.A.BAR_CHART_WIDTH/8,e=a.select("#pag-bar-graph .svg-group");e.select(".anim-xaxis").call(r.tickFormat(""));const o=e.selectAll(".bars");o.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((t=>100+1e3*(1-(1-t.placeFromLeft/n.length)**4))).duration(500).attr("width",t).attr("x",s.A.BAR_CHART_WIDTH/2-t/2).end().catch((()=>{})).then((()=>{e.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),o.transition().delay(500).attr("x",0),e.transition().delay(500).attr("transform","translate(".concat(m+s.A.BAR_CHART_WIDTH/2-t/2,",").concat(d,")"))}))}},undo:function(){{const t=a.select("#pag-bar-graph .svg-group"),o=t.selectAll(".bars");t.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(s.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),t.select(".anim-xaxis").call(r.tickFormat((t=>"year ".concat(t)))),t.transition().delay(500).attr("transform","translate(".concat(m,",").concat(d,")")),o.transition().delay((t=>100+1e3*(1-(t.placeFromLeft/n.length)**4))).duration(500).attr("x",(t=>e(t.year))).attr("width",e.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{o.style("mix-blend-mode","normal")}))}}}}},initBucketsFillAnim:function(t){let{deps:e,objective:r}=t;return{do:function(){a.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","initial"),a.select("#pag-bar-graph").attr("opacity",0),e.setBucketInterper((()=>p(r)))},undo:function(){e.setBucketInterper((()=>a.scaleLinear().range([0,0]))),a.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","none"),a.select("#pag-bar-graph").transition().attr("opacity",1)}}},initDropFillAnim:function(t){let{deps:e,objective:r}=t;return{do:function(){(0,i.YB)(".main-waterdrop"),(0,i.YB)(".tut-drop-graphics-wrapper",a,"grid"),(0,i.f2)(".tut-graph-wrapper, .bucket-wrapper"),e.setDropInterper((()=>p(r)))},undo:function(){(0,i.f2)(".tut-drop-graphics-wrapper, .main-waterdrop"),(0,i.YB)(".bucket-wrapper"),(0,i.YB)(".tut-graph-wrapper",a,"flex"),e.setDropInterper((()=>a.scaleLinear().range([0,0])))}}},initShowVariationsAnim:function(t){let{deps:e}=t;return{do:function(){a.selectAll(".vardrop").style("display","initial").classed("hasarrow",!0),a.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","none"),e.setVariationInterpers(e.objectiveVariations),a.selectAll(".var-scen-label").style("display","block"),a.selectAll(".var-scen-label").style("opacity","1"),a.select(".main-waterdrop").transition().style("transform","translateY(100px) scale(0.5)"),a.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(2)"),a.select(".main-histogram").style("display","initial"),a.selectAll(".vardrop .dot-histogram-wrapper").style("display","initial")},undo:function(){a.select(".main-waterdrop").transition().style("transform","none"),a.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(1)"),a.select(".main-histogram").style("display","none"),a.selectAll(".vardrop .dot-histogram-wrapper").style("display","none"),a.selectAll(".var-scen-label").style("display","none"),a.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","initial"),a.selectAll(".vardrop").style("display","none").classed("hasarrow",!1),e.setVariationInterpers(s.A.VARIATIONS.map((()=>a.scaleLinear().range([0,0]))))}}}}}const m=f();n()}catch(d){n(d)}}))},394:(t,e,r)=>{r.d(e,{YB:()=>h,bp:()=>d,f2:()=>p});var n=r(760);const a=Math.SQRT1_2,o=1,s=a+a,i=o+a,c=(a+o/2)/i;function l(t){if(t>=c){return Math.SQRT1_2*(1-t)/(1-c)}const e=2*(1-t/(s/i))-1,r=Math.acos(e);return Math.sin(r)}function u(t){return(t-a/i)*(1+Math.SQRT2)}function d(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(Math.abs(t-e)<.01)return[];const s=r/2/o*a,c=1/n,d=[],h=[];let p,f,m,g;for(let o=1;o<=Math.ceil(1/c)&&(p=l(t+(o-1)*c),f=u(t+(o-1)*c),m=l(t+o*c),g=u(t+o*c),!(g/(1+Math.SQRT2)+a/i>=e));o++){const t=[-p*s,-f*s],e=[p*s,-f*s],r=[m*s,-g*s],n=[-m*s,-g*s];d.push(e,r),h.push(t,n)}m=l(e),g=u(e);const y=[-p*s,-f*s],v=[p*s,-f*s],b=[m*s,-g*s],A=[-m*s,-g*s];return d.push(v,b),h.push(y,A),d.push(...h.reverse()),d}function h(t,e,r){(e||n).selectAll(t).style("display",r||"block")}function p(t,e){(e||n).selectAll(t).style("display","none")}},569:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{R:()=>c});var a=r(43),o=r(479),s=t([o]);function c(t,e,r){const[n,s]=(0,a.useState)([]);(0,a.useEffect)((function(){if(0===t.readyHash)return;console.log("scenario",r);const n={deps:t,objective:e,scenario:r},a=o.W.initChartAnimGroup(n),i=o.W.initBucketsFillAnim(n),c=o.W.initDropFillAnim(n),l=o.W.initShowVariationsAnim(n),u=[{name:"barsAppear",animHandler:a.barsAppear,text:"Bar Graph"},{name:"barsCondense",animHandler:a.barsCondense,text:"Gradient"},{name:"bucketsFill",animHandler:i,text:"Bucket"},{name:"forNowLetsFocus",animHandler:c,text:"Waterdrop"},{name:"ifChangeReality",animHandler:l,text:"Different Scenarios"}];s(u),console.log("hash changed in datastory")}),[t.readyHash]);return(0,a.useCallback)((function(t,e){let r,a;for(let o=0;o<n.length;o++)if(n[o].name===t)r=o;else if(n[o].name===e){a=o;break}return n.slice(r,a+1)}),[n])}o=(s.then?(await s)():s)[0],n()}catch(i){n(i)}}))},343:(t,e,r)=>{r.a(t,(async(t,n)=>{try{r.d(e,{C5:()=>j,Et:()=>p,Ft:()=>z,Ng:()=>I,Ul:()=>G,XC:()=>f,Yb:()=>D,bp:()=>T,cv:()=>B,hh:()=>P,i7:()=>Q,iJ:()=>Y,js:()=>m,nC:()=>V,u:()=>W,xC:()=>S});var a=r(981),o=r(760),s=r(783),i=r.n(s),c=r(43),l=r(63),u=r(684),d=t([l]);function p(t,e){const r=Object.groupBy(t,e);for(const n of Object.keys(r))r[n]=r[n][0];return r}l=(d.then?(await d)():d)[0];const f={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},m="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";const g=Math.SQRT1_2,y=1,v=g+g,b=y+g,A=.75;function x(t){if(t>=A){return Math.SQRT1_2*(1-t)/(1-A)}const e=2*(1-t/(v/b))-1,r=Math.acos(e);return Math.sin(r)}function w(t){return(t-g/b)*(1+Math.SQRT2)}function k(t){return t/(1+Math.SQRT2)+g/b}function T(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const n=r/2/y*g,a=.1,o=[],s=[];let i,c,l,u;for(let m=1;m<=Math.ceil(10)&&(i=x(t+(m-1)*a),c=w(t+(m-1)*a),l=x(t+m*a),u=w(t+m*a),!(k(u)>=e));m++){const t=[-i*n,-c*n],e=[i*n,-c*n],r=[l*n,-u*n],a=[-l*n,-u*n];o.push(e,r),s.push(t,a)}l=x(e),u=w(e);const d=[-i*n,-c*n],h=[i*n,-c*n],p=[l*n,-u*n],f=[-l*n,-u*n];return o.push(h,p),s.push(d,f),o.push(...s.reverse()),o}function I(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const n=r/2/y*g,a=.1,o=[];let s,i,c,l;for(let f=1;f<=Math.ceil(10)&&(s=x(t+(f-1)*a),i=w(t+(f-1)*a),c=x(t+f*a),l=w(t+f*a),!(k(l)>=e));f++){const t=[-s*n,-i*n],e=[s*n,-i*n],r=[c*n,-l*n],a=[-c*n,-l*n];o.push([t,e,r]),o.push([t,r,a])}c=x(e),l=w(e);const u=[-s*n,-i*n],d=[s*n,-i*n],h=[c*n,-l*n],p=[-c*n,-l*n];return o.push([u,d,h]),o.push([u,h,p]),o}function j(t,e){return function(r){return e.map((function(e){return[e,o.mean(r,(function(r){return t(e-r)}))]}))}}function S(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function _(t){const e=t/2,r=3*Math.PI/2/16,n=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let a=0;a<=16;a++)n.push({x:Math.cos(a*r-Math.PI/4)*e,y:Math.sin(a*r-Math.PI/4)*e});return n}function R(t,e){const r=i().Bounds.create(t),n=r.min.x,a=r.max.x,s=r.min.y,c=r.max.y,l=o.scaleLinear([n,a]),u=o.scaleLinear([s,c]),d=[];for(let o=0;o<e;o++)for(;;){const e=l(Math.random()),r=u(Math.random());if(i().Vertices.contains(t,{x:e,y:r})){d.push([e,r]);break}}return d}const E=function(){const t=_(3),e=_(1),r=[];for(let n=0;n<t.length-2;n++)r.push([t[n],t[n+(n<2?1:2)],e[n+(n<2?1:2)],e[n]]);return r}();let M,C,O,H;function L(t){const e=o.sum(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function P(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n&&O&&r.length===H)return O;M&&r.length===C||(M=o.range(4).map((()=>R(_(1),C=r.length))));const a=L(r.map((t=>{let{r:e}=t;return e}))),s=M[Math.floor(Math.random()*M.length)].map((t=>{let[e,r]=t;return[e*a,r*a]})),c=i().Engine,l=i().Bodies,u=i().Composite,d=c.create(),h=s.sort(((t,e)=>e[1]-t[1])),p=r.map(((t,e)=>{let{r:r,id:n}=t;const[a,o]=h[e];return l.circle(a,o,r,{restitution:0,id:n})})),f=E.map((t=>i().Body.create({position:i().Vertices.centre(t),vertices:t,isStatic:!0}))),m=i().Body.create({isStatic:!0});i().Body.setParts(m,f),i().Body.setCentre(m,{x:0,y:0}),i().Body.scale(m,a,a),u.add(d.world,[...p,m]);for(let o=0,i=60,g=.1;o<i*g;o++)c.update(d,1e3/i);const y=p.map((r=>{let{position:n,id:a}=r;return{id:a,x:n.x+t,y:n.y+e}}));return y.height=a/2/g*b,!n||O&&y.length===H||(O=y,H=y.length),y}function V(t,e){const[r,n]=(0,c.useState)(t);return[(0,c.useMemo)((()=>e(r)),[r]),(0,c.useCallback)((t=>{n(e(t))}),[])]}function B(t,e,r,n){const a=r[t][l.Vk][e][l.Zl];return o.scaleLinear().domain((0,u.kd)(0,1,a.length)).range(a.map((t=>Math.min(1,t/n)))).clamp(!0)}function D(t,e,r){return"median"===t?Object.keys(e[r][l.Vk]).sort(((t,n)=>o.mean(e[r][l.Vk][t][l.Zl])-o.mean(e[r][l.Vk][n][l.Zl]))):"deliveries"===t?Object.keys(e[r][l.Vk]).sort(((t,n)=>o.max(e[r][l.Vk][t][l.Zl])-o.max(e[r][l.Vk][n][l.Zl]))):"alphabetical"===t?Object.keys(e[r][l.Vk]).sort():void 0}function F(t,e,r){var n;const a=e.split(".");for(let o of a){if(!t)return r;t=t[o]}return null!==(n=t)&&void 0!==n?n:r}function N(t){return"string"===typeof t?e=>F(e,t):t}function G(t,e){return e=N(e),t.sort(((t,r)=>{const n=e(t),a=e(r);return n<a?-1:n>a?1:0}))}function Z(t){return t*Math.PI/180}class Q{constructor(t){let{fov:e,near:r,far:n,width:s,height:i,domElement:c,zoomFn:l}=t;this.raycaster=new a.tBo,this.fov=e,this.near=r,this.far=n,this.width=s,this.height=i,this.camera=new a.ubm(e,s/i,r,n+1),this.camera.position.set(0,0,this.far),this.zoom=o.zoom().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,l&&l(t)})),this.view=o.select(c),this.view.call(this.zoom),this.zoom.transform(this.view,o.zoomIdentity.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,r=-(t.transform.x-this.width/2)/e,n=(t.transform.y-this.height/2)/e,a=this.getZFromScale(e);this.camera.position.set(r,n,a)}getScaleFromZ(t){const e=Z(this.fov/2),r=2*(Math.tan(e)*t);return this.height/r}getZFromScale(t){const e=Z(this.fov/2);return this.height/t/(2*Math.tan(e))}intersectObject(t,e,r){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(r)}}class W{constructor(){this.threeGeom=new a.V23,this.idx=0}addMeshCoords(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=[];for(let s=0;s<t.length;s++){const[i,c,l]=t[s],u=new a.Pq0(e.x+i[0],e.y-i[1],n),d=new a.Pq0(e.x+c[0],e.y-c[1],n),h=new a.Pq0(e.x+l[0],e.y-l[1],n);this.threeGeom.vertices.push(u,d,h);const p=new a.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);r&&(p.vertexColors.push(r),p.vertexColors.push(r),p.vertexColors.push(r)),this.threeGeom.faces.push(p),o.push(this.idx++)}return o}}function z(t,e,r,n){return{x:t/r*2-1,y:-e/n*2+1}}function Y(t){const[e,r]=(0,c.useState)(t),n=(0,c.useRef)(t);(0,c.useEffect)((()=>{n.current=e}),[e]);const a=(0,c.useCallback)((t=>{r(n.current=t)}),[]);return[e,a,n]}n()}catch(h){n(h)}}))},999:(t,e,r)=>{r.d(e,{h:()=>p,p:()=>x});var n=r(43);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,a,o=[],s=!0,i=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(c){i=!0,a=c}finally{try{s||null==r.return||r.return()}finally{if(i)throw a}}return o}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var l=function(t){return"string"===typeof t&&t.includes("px")},u={position:"fixed",left:0,width:"100%",height:0,borderTop:"2px dashed black",zIndex:9999},d={fontSize:"12px",fontFamily:"monospace",margin:0,padding:6},h=function(t){var e=t.offset,r=function(t){return l(t)?t:"".concat(100*t,"%")}(e);return n.createElement("div",{style:o(o({},u),{},{top:r})},n.createElement("p",{style:d},"trigger: ",e))},p=function(t){var e=t.debug,r=t.children,a=t.offset,o=void 0===a?.3:a,s=t.onStepEnter,c=void 0===s?function(){}:s,u=t.onStepExit,d=void 0===u?function(){}:u,p=t.onStepProgress,f=void 0===p?null:p,m=t.threshold,g=void 0===m?4:m,y=l(o),v=i((0,n.useState)(0),2),b=v[0],A=v[1],x=i((0,n.useState)(null),2),w=x[0],k=x[1],T=function(t){A(t)},I=function(t){k(window.innerHeight)};n.useEffect((function(){if(y)return window.addEventListener("resize",I),function(){window.removeEventListener("resize",I)}}),[]);var j="undefined"!==typeof window?w||window.innerHeight:0,S=y?+o.replace("px","")/j:o,_=(0,n.useMemo)((function(){return function(t,e){for(var r=Math.ceil(e/t),n=[],a=1/r,o=0;o<=r;o+=1)n.push(o*a);return n}(g,j)}),[j]);return n.createElement(n.Fragment,null,e&&n.createElement(h,{offset:o}),n.Children.map(r,(function(t,e){return n.cloneElement(t,{scrollamaId:"react-scrollama-".concat(e),offset:S,onStepEnter:c,onStepExit:d,onStepProgress:f,lastScrollTop:b,handleSetLastScrollTop:T,progressThreshold:_,innerHeight:j})})))};const f=new Map,m=new WeakMap;let g,y=0;function v(t){return Object.keys(t).sort().filter((e=>void 0!==t[e])).map((e=>{return"".concat(e,"_").concat("root"===e?(r=t.root)?(m.has(r)||(y+=1,m.set(r,y.toString())),m.get(r)):"0":t[e]);var r})).toString()}function b(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g;if("undefined"===typeof window.IntersectionObserver&&void 0!==n){const a=t.getBoundingClientRect();return e(n,{isIntersecting:n,target:t,intersectionRatio:"number"===typeof r.threshold?r.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:a,observer:o,elements:s}=function(t){let e=v(t),r=f.get(e);if(!r){const n=new Map;let a;const o=new IntersectionObserver((e=>{e.forEach((e=>{var r;const o=e.isIntersecting&&a.some((t=>e.intersectionRatio>=t));t.trackVisibility&&"undefined"===typeof e.isVisible&&(e.isVisible=o),null==(r=n.get(e.target))||r.forEach((t=>{t(o,e)}))}))}),t);a=o.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),r={id:e,observer:o,elements:n},f.set(e,r)}return r}(r);let i=s.get(t)||[];return s.has(t)||s.set(t,i),i.push(e),o.observe(t),function(){i.splice(i.indexOf(e),1),0===i.length&&(s.delete(t),o.unobserve(t)),0===s.size&&(o.disconnect(),f.delete(a))}}function A(){let{threshold:t,delay:e,trackVisibility:r,rootMargin:a,root:o,triggerOnce:s,skip:i,initialInView:c,fallbackInView:l,onChange:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const d=n.useRef(),h=n.useRef(),[p,f]=n.useState({inView:!!c});h.current=u;const m=n.useCallback((n=>{void 0!==d.current&&(d.current(),d.current=void 0),i||n&&(d.current=b(n,((t,e)=>{f({inView:t,entry:e}),h.current&&h.current(t,e),e.isIntersecting&&s&&d.current&&(d.current(),d.current=void 0)}),{root:o,rootMargin:a,threshold:t,trackVisibility:r,delay:e},l))}),[Array.isArray(t)?t.toString():t,o,a,s,i,r,l,e]);n.useEffect((()=>{d.current||!p.entry||s||i||f({inView:!!c})}));const g=[m,p.inView,p.entry];return g.ref=g[0],g.inView=g[1],g.entry=g[2],g}var x=function(t){var e=t.children,r=t.data,a=t.handleSetLastScrollTop,o=t.lastScrollTop,s=t.onStepEnter,c=void 0===s?function(){}:s,l=t.onStepExit,u=void 0===l?function(){}:l,d=t.onStepProgress,h=void 0===d?null:d,p=t.offset,f=t.scrollamaId,m=t.progressThreshold,g=t.innerHeight,y="undefined"!==typeof window?document.documentElement.scrollTop:0,v=o<y?"down":"up",b=function(t){return"-".concat(100*t,"% 0px -").concat(100-100*t,"% 0px")}(p),x=(0,n.useRef)(null),w=i((0,n.useState)(!1),2),k=w[0],T=w[1],I=A({rootMargin:b,threshold:0}),j=I.ref,S=I.entry,_=A({rootMargin:(0,n.useMemo)((function(){return function(t,e,r,n){if(!r.current)return"0px";var a=r.current.offsetHeight/n;return"down"===t?"".concat(100*(a-e),"% 0px ").concat(100*e-100,"% 0px"):"-".concat(100*e,"% 0px ").concat(100*a-(100-100*e),"% 0px")}(v,p,x,g)}),[v,p,x,g]),threshold:m}),R=_.ref,E=_.entry,M=(0,n.useCallback)((function(t){x.current=t,j(t),R(t)}),[j,R]);return n.useEffect((function(){if(k){var t=E.target.getBoundingClientRect(),e=t.height,n=t.top,a=Math.min(1,Math.max(0,(window.innerHeight*p-n)/e));h&&h({progress:a,scrollamaId:f,data:r,element:E.target,entry:E,direction:v})}}),[E]),n.useEffect((function(){S&&!S.isIntersecting&&k?(u({element:S.target,scrollamaId:f,data:r,entry:S,direction:v}),T(!1),a(y)):S&&S.isIntersecting&&!k&&(T(!0),c({element:S.target,scrollamaId:f,data:r,entry:S,direction:v}),a(y))}),[S]),n.cloneElement(n.Children.only(e),{"data-react-scrollama-id":f,ref:M,entry:S})}}}]);
//# sourceMappingURL=397.73f68758.chunk.js.map