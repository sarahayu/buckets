"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[230],{6230:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n.d(e,{default:()=>V});var s=n(5760),o=n(3981),a=n(5043),i=n(1684),c=n(63),h=n(9985),l=n(579),u=t([c,h]);[c,h]=u.then?(await u)():u;const m=5,f=3,p=.1,g=1,v=1.75,y=1.5,b=1,M=1.3/(1+Math.SQRT1_2),x=c.Xe.filter(((t,e)=>e%g===0)),[w,k]=P(),j=C("objective"),T=C("scenario");function V(){const t=window.innerWidth,e=window.innerHeight,{current:n}=(0,a.useRef)(F()),[r,i,c]=(0,h.iJ)("objective"),[u,d]=(0,a.useState)({}),m=(0,a.useRef)(),f=(0,a.useRef)(),p=(0,a.useRef)(new z),g=(0,a.useRef)(new E),[v,y,M]=(0,h.iJ)();return(0,a.useEffect)((function(){s.select("#mosaic-svg").attr("width",t).attr("height",e).append("g").attr("class","svg-trans").on("mousemove",(function(t){const{x:e,y:n}=t;d((t=>({...t,x:e,y:n})))})),function(){const r=new h.i7({fov:45,near:1,far:3e3,width:t,height:e,domElement:s.select(".bubbles-wrapper").node(),zoomFn:t=>{s.select("#mosaic-svg").select(".svg-trans").attr("transform",t.transform),p.current&&p.current.updateOutlineVisibility(s.scaleLinear().domain([1,5]).range([.1,1]).clamp(!0)(t.transform.k))}});r.view.on("mousemove",(n=>{if(!g.current)return;const{x:s,y:o}=(0,h.Ft)(n.x,n.y,t,e),a=g.current.intersectObject(r,s,o);if(a){const t=w.find((t=>t.id===a));d((e=>({...e,secondaryText:"objective"===c.current?t.scenario:t.objective})))}else d((t=>({...t,secondaryText:""})))}));const a=new o.JeP({antialias:!0});a.setSize(t,e),document.querySelector("#mosaic-webgl").appendChild(a.domElement),a.setAnimationLoop((()=>{if(a.render(n,r.camera),!M.current)return;const t=f.current.getDelta();f.current.getElapsedTime()>b?y(null):g.current.updatePoints(m.current,M.current,t/b)}))}()}),[]),(0,a.useEffect)((function(){s.select("#mosaic-svg").select(".svg-trans").selectAll(".largeDrop").attr("display","none");const t=m.current;m.current="objective"===r?j:T,t&&(y(S(m.current,t)),g.current.draw(n)),p.current.remove(n),f.current=new o.zD7}),[r]),(0,a.useEffect)((function(){M.current||(g.current.createMesh(m.current),p.current.createMesh(m.current),g.current.remove(n),p.current.draw(n),R(s.select("#mosaic-svg").select(".svg-trans"),m.current,(t=>d((e=>({...e,text:t.key,primaryText:t.key})))),(()=>d((t=>({...t,text:"",primaryText:""}))))))}),[v]),(0,l.jsxs)("div",{className:"bubbles-wrapper",children:[(0,l.jsx)(I,{grouping:r,onChange:t=>{i(t.target.value)}}),(0,l.jsx)("div",{className:"bubbles-tooltip",style:O(u),children:u.secondaryText||u.primaryText}),(0,l.jsx)("div",{id:"mosaic-webgl"}),(0,l.jsx)("svg",{id:"mosaic-svg"})]})}function I(t){let{grouping:e,onChange:n}=t;return(0,l.jsxs)("div",{className:"bubbles-input-area",onChange:n,children:[(0,l.jsx)("input",{type:"radio",name:"grouping",value:"objective",id:"objective",checked:"objective"===e}),(0,l.jsx)("label",{htmlFor:"objective",children:"objective"}),(0,l.jsx)("input",{type:"radio",name:"grouping",value:"scenario",id:"scenario",checked:"scenario"===e}),(0,l.jsx)("label",{htmlFor:"scenario",children:"scenario"})]})}function P(){const t=[],e={objective:{},scenario:{}},n=[];let r=0;for(const a of c.iL)for(const o of x){e.objective[a]||(e.objective[a]=[]),e.scenario[o]||(e.scenario[o]=[]),e.objective[a].push(r),e.scenario[o].push(r);const i=c.jx[a][c.Vk][o][c.Zl];t.push({id:r,objective:a,scenario:o,deliveries:i}),n.push(s.mean(i)),r++}const o={};for(const a of Object.keys(e)){const r=[];for(const o of Object.keys(e[a])){const i=e[a][o],c=i.sort(((t,e)=>n[e]-n[t]));r.push({key:o,sorted:c,mean:s.mean(i.map((e=>t[e].deliveries)).flat())})}const i=r.sort(((t,e)=>e.mean-t.mean));o[a]={};for(let t=0;t<i.length;t++){const{key:e,sorted:n}=i[t],r={};for(let t=0;t<n.length;t++)r[n[t]]=t;o[a][e]=r,o[a][e].rank=t}}return[t,o]}function C(t){const e="objective"===t?c.iL:x,n="objective"===t?x:c.iL,r=(e.length,n.length),s=Math.max(1,Math.sqrt(r/Math.PI)*f*2*v*y),o=Math.max(2,f*v),a=(0,h.Et)((0,h.hh)(0,0,e.map(((t,e)=>({r:s,id:e})))),(t=>{let{id:e}=t;return e})),l=(0,h.hh)(0,0,n.map(((t,e)=>({r:o,id:e})))),u=(0,h.Et)(l,(t=>{let{id:e}=t;return e})),d=[],g=[],b={};let M=0;for(const v of w){const{id:e,objective:n,scenario:r,deliveries:s}=v,o=(0,h.cv)(n,r,c.jx,c.pk),l=(0,i.kd)(0,1,m+1).map((t=>o(t))).map(((t,e)=>Math.max(t,0==e?p:0)*f)),g="objective"===t?n:r,y="objective"===t?r:n,x=k[t][g].rank,w=k[t][g][e];d.push({id:e,levs:l,maxLev:f,domLev:L(l),tilt:50*Math.random()-25,dur:100*Math.random()+400,x:u[w].x,y:u[w].y,group:g,key:y,globalX:a[x].x+u[w].x,globalY:a[x].y+u[w].y}),b[e]=M++}for(const i of e)g.push({x:a[k[t][i].rank].x,y:a[k[t][i].rank].y,tilt:50*Math.random()-25,key:i,height:l.height});return{nodes:d,nodeIDtoIdx:b,groups:g}}function S(t,e){const n={};for(const r of t.nodes){const{id:t,globalX:s,globalY:o}=r,a=e.nodeIDtoIdx[t],i=e.nodes[a],{globalX:c,globalY:h}=i;n[t]=[s-c,o-h]}return n}function F(){const t=new o.Z58;return t.background=new o.Q1f(15724527),t}function O(t){return{display:t.secondaryText||t.primaryText?"initial":"none",left:t.x,top:t.y}}function R(t,e,n,r){t.selectAll(".largeDrop").data(e.groups).join((t=>t.append("g").attr("class","largeDrop").call((t=>{t.append("path").attr("d",h.js).attr("fill","none").attr("stroke","transparent").attr("vector-effect","non-scaling-stroke").attr("stroke-width",1)})))).attr("display","initial").attr("transform",(t=>{let{x:e,y:n,height:r}=t;return"translate(".concat(e,", ").concat(n,") scale(").concat(r*M,")")})).on("mouseenter",(function(t,e){s.select(this).select("path").attr("stroke","lightgray"),n(e)})).on("mouseleave",(function(t,e){s.select(this).select("path").attr("stroke","transparent"),r(e)}))}function L(t){t=[1,...t,0];let e=0;for(let n=0;n<t.length-1;n++){e+=(t[n]-t[n+1])*(n-1)/(m+4)}return e}class z{constructor(){this.added=!1,this.idToVertInfo={}}createMesh(t){this.dropsMesh?this.updateMeshes(t):this.initializeMeshes(t)}draw(t){this.added||(t.add(this.dropsMesh),t.add(this.outlineMesh),this.added=!0)}remove(t){this.added&&(t.remove(this.dropsMesh),t.remove(this.outlineMesh),this.added=!1)}initializeMeshes(t){const e=new h.u,n=[],r=(0,h.bp)(0,1,.975*f);let s=0,a=0;for(let c=0;c<t.nodes.length;c++){const{id:l,globalX:u,globalY:d,levs:p,maxLev:g}=t.nodes[c];let v=r.length,y=0;for(let t=p.length-1;t>=0;t--){const n=t!==p.length-1?p[t+1]:0,r=p[t],s=(0,h.Ng)(n/g,r/g,f),a=new o.Q1f((0,i.YW)(t/m));e.addMeshCoords(s,{x:u,y:-d},a,c%5/50+.02),y+=3*s.length}n.push(...r.map((t=>{let[e,n]=t;return new o.Pq0(u+e,-d-n,c%5/50+.01)}))),this.idToVertInfo[l]={shapeVertRange:[a,y],outlineVertRange:[s,v],centroid:[u,d]},a+=y,s+=v}this.dropsMesh=new o.eaF(e.threeGeom,new o.V9B({vertexColors:o.vCm})),this.outlineMesh=new o.DXC((new o.LoY).setFromPoints(n),new o.mrM({color:13421772,transparent:!0,opacity:0}))}updateOutlineVisibility(t){this.outlineMesh&&(this.outlineMesh.material.opacity=t,this.outlineMesh.material.needsUpdate=!0)}updateMeshes(t){for(let e=0;e<t.nodes.length;e++){const{id:n,globalX:r,globalY:s}=t.nodes[e],[o,a]=this.idToVertInfo[n].shapeVertRange,[i,c]=this.idToVertInfo[n].outlineVertRange,[h,l]=this.idToVertInfo[n].centroid,u=r-h,d=s-l,m=this.dropsMesh.geometry,f=this.outlineMesh.geometry;for(let t=0;t<a;t++){const e=m.vertices[o+t].x,n=m.vertices[o+t].y;m.vertices[o+t].setX(e+u),m.vertices[o+t].setY(n-d)}this.idToVertInfo[n].centroid=[r,s];for(let t=0;t<c;t++){const e=f.attributes.position.array[3*(i+t)+0],n=f.attributes.position.array[3*(i+t)+1];f.attributes.position.array[3*(i+t)+0]=e+u,f.attributes.position.array[3*(i+t)+1]=n-d}m.verticesNeedUpdate=!0,f.attributes.position.needsUpdate=!0}}}class E{constructor(){this.added=!1,this.vertToId={},this.idToVert={}}draw(t){this.added||(t.add(this.mesh),this.added=!0)}remove(t){this.added&&(t.remove(this.mesh),this.added=!1)}createMesh(t){return this.mesh||this.initializeMesh(t),this.updateMesh(t),this.mesh}initializeMesh(t){const e=new o.V23;for(let r=0;r<t.nodes.length;r++){const{id:n,globalX:s,globalY:a,levs:c,domLev:h}=t.nodes[r],l=h>0?(0,i.YW)(h):"white";e.vertices.push(new o.Pq0(s,-a,0)),e.colors.push(new o.Q1f(l)),this.vertToId[r]=n,this.idToVert[n]=r}const n=new o.BH$({size:2*f,sizeAttenuation:!0,vertexColors:o.vCm,map:(new o.Tap).load("drop.png"),transparent:!0});this.mesh=new o.ONl(e,n)}updateMesh(t){for(let e=0;e<t.nodes.length;e++){const{id:n,globalX:r,globalY:s}=t.nodes[e],o=this.idToVert[n];this.mesh.geometry.vertices[o].setX(r),this.mesh.geometry.vertices[o].setY(-s)}this.mesh.geometry.verticesNeedUpdate=!0}updatePoints(t,e,n){const r=this.mesh.geometry.vertices;for(let s=0;s<t.nodes.length;s++){const{id:o}=t.nodes[s],a=this.idToVert[o],[i,c]=e[o],h=r[a].x,l=r[a].y;r[a].setX(h+n*i),r[a].setY(l-n*c)}this.mesh.geometry.verticesNeedUpdate=!0}intersectObject(t,e,n){const r=t.intersectObject(e,n,this.mesh);if(r[0]){const t=(0,h.Ul)(r,"distanceToRay")[0];return this.vertToId[t.index]}return null}}r()}catch(d){r(d)}}))},3408:(t,e,n)=>{n.d(e,{Qj:()=>h,R1:()=>m,Uy:()=>c,X1:()=>l,fq:()=>i,hM:()=>u});var r=n(5760);const s=40,o=3;let a=0;function i(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.scaleLinear();return function(r){return r.map((r=>({x:-t,y:e-n(r)*e-e/2,width:2*t,height:2*e})))}}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.each((function(t){const e=r.select(this),n=e.attr("cur-level")||0;e.attr("prev-level",n),e.attr("cur-level",t.y)})),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(r.easeQuad).attrTween("transform",(function(t,n){const o=r.select(this),a=parseFloat(o.attr("prev-level")),i=Math.abs(a-t.y)/200*e;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*i+.5),4*Math.PI))*i*s*(1-t),", ",0,", ",0,")")}));return t.transition("liquidLevel").ease(r.easeElasticOut.period(.6)).delay(((e,n)=>n*(100/t.size()))).duration(1e3)}function h(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return function(i){const c=a++;i.append("defs").attr("class","clip-def").append("clipPath").attr("id","bucket-mask-"+c).append("path").attr("class","bucket-mask-path"),i.append("g").attr("class","graph-area").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("clip-path","url(#bucket-mask-".concat(c,")")),i.append("path").attr("class","bucket-outline").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",o).attr("fill","none"),i.call(function(t){let{drawFunc:e,drawOutlineFunc:n=e,width:s,height:o}=t;return function(t){const a=t=>{const e=r.path();return t(e,s,o),e.toString()};t.select(".bucket-mask-path").attr("d",a(e)),t.select(".bucket-outline").attr("d",a(n))}}({drawFunc:n,drawOutlineFunc:s,width:t,height:e}))}}function l(t,e,n){d(t,e,n,!0)}function u(t,e,n){d(t,e,n,!1)}function d(t,e,n,r){const s=.8*e/2,o=-.8*e/2;t.moveTo(e/2,-n/2),t.lineTo(s,n/2),t.lineTo(o,n/2),t.lineTo(-e/2,-n/2),r&&t.closePath()}function m(t,e,n){const r=Math.SQRT2,s=1/(1+1*r),o=Math.min(e/2,n*s),a=o/(1/r),i=o+a;t.moveTo(0,-i/2),t.lineTo(a/2,-i/2+a/2),t.arc(0,-i/2+a,o,-Math.PI/4,5*Math.PI/4),t.closePath()}},1684:(t,e,n)=>{n.d(e,{E3:()=>o,YW:()=>a,kd:()=>c,m8:()=>i,wh:()=>h});var r=n(5760),s=n(3408);function o(t,e,n){let s=t.map((t=>Math.round(t.length/e))),o=r.sum(s);for(;o>n;)s[r.minIndex(t,((t,n)=>0!==t.length?t.length/e-s[n]:1/0))]-=1,o=r.sum(s);for(;o<n;)s[r.maxIndex(t,((t,n)=>0!==t.length?t.length/e-s[n]:-1/0))]+=1,o=r.sum(s);return s}const a=t=>r.interpolateBlues(r.scaleLinear([.2,1])(t));function i(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}function c(t,e,n){return r.range(n).map((r=>r/(n-1)*(e-t)+t))}function h(t,e){return(n=>{const s=r.path();return n(s,t,e),s.toString()})(s.X1)}},63:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{Vk:()=>i,Xe:()=>d,Zl:()=>c,iL:()=>u,jx:()=>l,pk:()=>a,sQ:()=>h});var s=n(9985),o=t([s]);s=(o.then?(await o)():o)[0];const a=1200,i="scens",c="delivs",h="delivs_unord",l=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[i]=e[i];for(const t of e[i]){const e=t[c].map((t=>Math.min(Math.max(0,t),a)));t[h]=e,t[c]=Array.from(e).sort(((t,e)=>e-t))}e[i]=(0,s.Et)(e[i],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,s.Et)(t,(t=>{let{obj:e}=t;return e}))}(),u=Object.keys(l),d=Object.keys(Object.values(l)[0][i]);r()}catch(a){r(a)}}),1)},9985:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{C5:()=>I,Et:()=>m,Ft:()=>_,Ng:()=>V,Ul:()=>D,XC:()=>f,Yb:()=>Q,bp:()=>T,cv:()=>Y,hh:()=>Z,i7:()=>A,iJ:()=>G,js:()=>p,nC:()=>X,si:()=>g,u:()=>U,xC:()=>P});var s=n(3981),o=n(5760),a=n(3783),i=n.n(a),c=n(5043),h=n(63),l=n(1684),u=t([h]);function m(t,e){const n=Object.groupBy(t,e);for(const r of Object.keys(n))n[r]=n[r][0];return n}h=(u.then?(await u)():u)[0];const f={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},p="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";function g(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}const v=Math.SQRT1_2,y=1,b=v+v,M=y+v,x=.75;function w(t){if(t>=x){return Math.SQRT1_2*(1-t)/(1-x)}const e=2*(1-t/(b/M))-1,n=Math.acos(e);return Math.sin(n)}function k(t){return(t-v/M)*(1+Math.SQRT2)}function j(t){return t/(1+Math.SQRT2)+v/M}function T(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/y*v,s=.1,o=[],a=[];let i,c,h,l;for(let p=1;p<=Math.ceil(10)&&(i=w(t+(p-1)*s),c=k(t+(p-1)*s),h=w(t+p*s),l=k(t+p*s),!(j(l)>=e));p++){const t=[-i*r,-c*r],e=[i*r,-c*r],n=[h*r,-l*r],s=[-h*r,-l*r];o.push(e,n),a.push(t,s)}h=w(e),l=k(e);const u=[-i*r,-c*r],d=[i*r,-c*r],m=[h*r,-l*r],f=[-h*r,-l*r];return o.push(d,m),a.push(u,f),o.push(...a.reverse()),o}function V(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/y*v,s=.1,o=[];let a,i,c,h;for(let f=1;f<=Math.ceil(10)&&(a=w(t+(f-1)*s),i=k(t+(f-1)*s),c=w(t+f*s),h=k(t+f*s),!(j(h)>=e));f++){const t=[-a*r,-i*r],e=[a*r,-i*r],n=[c*r,-h*r],s=[-c*r,-h*r];o.push([t,e,n]),o.push([t,n,s])}c=w(e),h=k(e);const l=[-a*r,-i*r],u=[a*r,-i*r],d=[c*r,-h*r],m=[-c*r,-h*r];return o.push([l,u,d]),o.push([l,d,m]),o}function I(t,e){return function(n){return e.map((function(e){return[e,o.mean(n,(function(n){return t(e-n)}))]}))}}function P(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function C(t){const e=t/2,n=3*Math.PI/2/16,r=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let s=0;s<=16;s++)r.push({x:Math.cos(s*n-Math.PI/4)*e,y:Math.sin(s*n-Math.PI/4)*e});return r}function S(t,e){const n=i().Bounds.create(t),r=n.min.x,s=n.max.x,a=n.min.y,c=n.max.y,h=o.scaleLinear([r,s]),l=o.scaleLinear([a,c]),u=[];for(let o=0;o<e;o++)for(;;){const e=h(Math.random()),n=l(Math.random());if(i().Vertices.contains(t,{x:e,y:n})){u.push([e,n]);break}}return u}const F=function(){const t=C(3),e=C(1),n=[];for(let r=0;r<t.length-2;r++)n.push([t[r],t[r+(r<2?1:2)],e[r+(r<2?1:2)],e[r]]);return n}();let O,R,L,z;function E(t){const e=o.sum(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function Z(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&L&&n.length===z)return L;O&&n.length===R||(O=o.range(4).map((()=>S(C(1),R=n.length))));const s=E(n.map((t=>{let{r:e}=t;return e}))),a=O[Math.floor(Math.random()*O.length)].map((t=>{let[e,n]=t;return[e*s,n*s]})),c=i().Engine,h=i().Bodies,l=i().Composite,u=c.create(),d=a.sort(((t,e)=>e[1]-t[1])),m=n.map(((t,e)=>{let{r:n,id:r}=t;const[s,o]=d[e];return h.circle(s,o,n,{restitution:0,id:r})})),f=F.map((t=>i().Body.create({position:i().Vertices.centre(t),vertices:t,isStatic:!0}))),p=i().Body.create({isStatic:!0});i().Body.setParts(p,f),i().Body.setCentre(p,{x:0,y:0}),i().Body.scale(p,s,s),l.add(u.world,[...m,p]);for(let o=0,i=60,v=.1;o<i*v;o++)c.update(u,1e3/i);const g=m.map((n=>{let{position:r,id:s}=n;return{id:s,x:r.x+t,y:r.y+e}}));return g.height=s/2/v*M,!r||L&&g.length===z||(L=g,z=g.length),g}function X(t,e){const[n,r]=(0,c.useState)(t);return[(0,c.useMemo)((()=>e(n)),[n]),(0,c.useCallback)((t=>{r(e(t))}),[])]}function Y(t,e,n,r){const s=n[t][h.Vk][e][h.Zl];return o.scaleLinear().domain((0,l.kd)(0,1,s.length)).range(s.map((t=>Math.min(1,t/r)))).clamp(!0)}function Q(t,e,n){return"median"===t?Object.keys(e[n][h.Vk]).sort(((t,r)=>o.mean(e[n][h.Vk][t][h.Zl])-o.mean(e[n][h.Vk][r][h.Zl]))):"deliveries"===t?Object.keys(e[n][h.Vk]).sort(((t,r)=>o.max(e[n][h.Vk][t][h.Zl])-o.max(e[n][h.Vk][r][h.Zl]))):"alphabetical"===t?Object.keys(e[n][h.Vk]).sort():void 0}function B(t,e,n){var r;const s=e.split(".");for(let o of s){if(!t)return n;t=t[o]}return null!==(r=t)&&void 0!==r?r:n}function q(t){return"string"===typeof t?e=>B(e,t):t}function D(t,e){return e=q(e),t.sort(((t,n)=>{const r=e(t),s=e(n);return r<s?-1:r>s?1:0}))}function N(t){return t*Math.PI/180}class A{constructor(t){let{fov:e,near:n,far:r,width:a,height:i,domElement:c,zoomFn:h}=t;this.raycaster=new s.tBo,this.fov=e,this.near=n,this.far=r,this.width=a,this.height=i,this.camera=new s.ubm(e,a/i,n,r+1),this.camera.position.set(0,0,this.far),this.zoom=o.zoom().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,h&&h(t)})),this.view=o.select(c),this.view.call(this.zoom),this.zoom.transform(this.view,o.zoomIdentity.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,n=-(t.transform.x-this.width/2)/e,r=(t.transform.y-this.height/2)/e,s=this.getZFromScale(e);this.camera.position.set(n,r,s)}getScaleFromZ(t){const e=N(this.fov/2),n=2*(Math.tan(e)*t);return this.height/n}getZFromScale(t){const e=N(this.fov/2);return this.height/t/(2*Math.tan(e))}intersectObject(t,e,n){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(n)}}class U{constructor(){this.threeGeom=new s.V23,this.idx=0}addMeshCoords(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=[];for(let a=0;a<t.length;a++){const[i,c,h]=t[a],l=new s.Pq0(e.x+i[0],e.y-i[1],r),u=new s.Pq0(e.x+c[0],e.y-c[1],r),d=new s.Pq0(e.x+h[0],e.y-h[1],r);this.threeGeom.vertices.push(l,u,d);const m=new s.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);n&&(m.vertexColors.push(n),m.vertexColors.push(n),m.vertexColors.push(n)),this.threeGeom.faces.push(m),o.push(this.idx++)}return o}}function _(t,e,n,r){return{x:t/n*2-1,y:-e/r*2+1}}function G(t){const[e,n]=(0,c.useState)(t),r=(0,c.useRef)(t);(0,c.useEffect)((()=>{r.current=e}),[e]);const s=(0,c.useCallback)((t=>{n(r.current=t)}),[]);return[e,s,r]}r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=230.a3d56f73.chunk.js.map