"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[704],{4704:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.r(e),n.d(e,{default:()=>P});var r=n(5043),s=n(5760),o=n(5111),c=n(63),i=n(5639),l=n(1684),h=n(9985),u=n(579),f=t([c,i,h]);[c,i,h]=f.then?(await f)():f;const m="expl0000",p="DEL_CVP_PAG_N",g=0,y=10,v="demand",x="carryover",k="priority",M="regs",w="minflow",b={[v]:5,[x]:3,[k]:2,[M]:4,[w]:5},j={};function P(){const{current:t}=(0,r.useRef)(Object.keys(c.jx)),[e,n]=(0,r.useState)(m),[a,s]=(0,r.useState)(p),[l,f]=(0,h.nC)(g,j[v]),[d,b]=(0,h.nC)(g,j[x]),[P,F]=(0,h.nC)(g,j[k]),[E,I]=(0,h.nC)(g,j[M]),[L,Z]=(0,h.nC)(g,j[w]),O=(0,r.useMemo)((()=>V(a,e)),[e,a]);(0,r.useEffect)((()=>{n(i.F[S(l,d,P,E,L)])}),[l,d,P,E,L]);const A=[{label:"demand [1, 0.9, 0.8, 0.7, 0.6]",controlVar:v,val:l,setter:f},{label:"carryover [1.0, 1.2, 1.3]",controlVar:x,val:d,setter:b},{label:"priority [0, 1]",controlVar:k,val:P,setter:F},{label:"regs [1, 2, 3, 4]",controlVar:M,val:E,setter:I},{label:"minflow [0, 0.4, 0.6, 0.7, 0.8]",controlVar:w,val:L,setter:Z}];return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{className:"editor",children:[(0,u.jsxs)("div",{className:"sliders",children:[(0,u.jsx)("select",{value:a,onChange:t=>s(t.target.value),children:t.map((t=>(0,u.jsx)("option",{name:t,value:t,children:t},t)))}),A.map((t=>{let{label:e,controlVar:n,val:r,setter:s}=t;return(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:e}),(0,u.jsx)(C,{data:T({demand:l,carryover:d,priority:P,regs:E,minflow:L},n,a),val:r,setVal:s})]},n)}))]}),(0,u.jsxs)("div",{children:[(0,u.jsx)(o.A,{levelInterp:O,width:300,height:400,resolution:y}),(0,u.jsx)("span",{style:{display:"block",textAlign:"center"},children:e})]})]})})}function C(t){let{data:e,val:n,setVal:a}=t;const o=5,c=5,i=0,h=5,f=400,d=(0,r.useRef)(),m=s.scaleLinear().range([0,f]),p=s.scaleLinear().range([50,0]);return(0,r.useEffect)((()=>{d.current.attr("width",f+h+c).attr("height",50+o+i).call((t=>t.node().addEventListener("mousedown",(t=>a(s.scaleLinear().domain([h,f+h]).clamp(!0)(t.offsetX)))))).call((t=>{t.append("g").attr("transform","translate(".concat(h,",").concat(o,")")).call(s.axisTop(s.scalePoint(s.range(e[0].length),[0,f])).tickFormat("")).selectAll("path").style("stroke","lightgrey")})).append("g").attr("class","graph-area").attr("transform","translate(".concat(h,",").concat(o,")")).call((t=>t.selectAll("path").data(e).join("path").attr("fill",((t,n)=>(0,l.YW)(n/e.length))))).call((t=>t.append("rect").attr("width",f).attr("height",50).attr("fill","none").attr("stroke","lightgrey"))).append("rect").attr("class","razor").attr("fill","red").attr("width",5).attr("height",50)}),[]),(0,r.useEffect)((()=>{d.current.select(".graph-area").selectAll("path").data(e).attr("d",(t=>s.area().x(((e,n)=>m(n/(t.length-1)))).y1((t=>p(t))).y0(p(0))(t)))}),[e]),(0,r.useEffect)((()=>{d.current.select(".graph-area").select(".razor").attr("x",m(n)-2.5)}),[n]),(0,u.jsx)("svg",{className:"line-slider",ref:t=>{d.current=s.select(t)}})}function S(t,e,n,a,r){const o=(t,e)=>s.scaleQuantize(s.range(1,b[e]+1))(t);return console.log("".concat(o(t,v)).concat(o(e,x)).concat(o(n,k)).concat(o(a,M)).concat(o(r,w))),"".concat(o(t,v)).concat(o(e,x)).concat(o(n,k)).concat(o(a,M)).concat(o(r,w))}function V(t,e){console.log(e);const n=c.jx[t][c.Vk][e][c.Zl];return s.scaleLinear().domain((0,l.kd)(0,1,n.length)).range(n.map((t=>t/c.pk))).clamp(!0)}function T(t,e,n){let{demand:a,carryover:r,priority:s,regs:o,minflow:c}=t;const h=[],u=e!==v?[a]:j[v].range(),f=e!==x?[r]:j[x].range(),d=e!==k?[s]:j[k].range(),m=e!==M?[o]:j[M].range(),p=e!==w?[c]:j[w].range();for(const i of u)for(const t of f)for(const e of d)for(const n of m)for(const a of p)h.push([i,t,e,n,a]);const g=h.map((t=>V(n,i.F[S(...t)])));return(0,l.kd)(0,1,y+1).map((t=>g.map((e=>e(t)))))}Object.keys(b).forEach((t=>j[t]=s.scaleQuantize((0,l.kd)(0,1,b[t])))),a()}catch(d){a(d)}}))},5111:(t,e,n)=>{n.d(e,{A:()=>l});var a=n(5760),r=n(5043),s=n(3408),o=n(1684),c=n(579);const i=10;function l(t){let{levelInterp:e,colorInterp:n=o.YW,width:l=200,height:h=400,resolution:u=i}=t;const f=l-6,d=h-3,m=(0,r.useRef)();return(0,r.useLayoutEffect)((function(){m.current.attr("width",l).attr("height",h).append("g").attr("class","bucket").attr("transform","translate(".concat(3,", ").concat(1.5,")")).call((0,s.Qj)(f,d,s.X1,s.hM))}),[]),(0,r.useLayoutEffect)((function(){const t=(0,o.kd)(0,1,u+1).map((t=>e(t))),a=(0,s.fq)(f,d),r=m.current.select(".graph-area").selectAll(".bucket-box").data(a(t)).join("rect").attr("class","bucket-box").attr("width",(t=>t.width)).attr("height",(t=>t.height)).attr("x",(t=>t.x)).attr("fill",((t,e)=>n(e/u)));(0,s.Uy)(r,200/h).attr("y",(t=>t.y))}),[e]),(0,c.jsx)("div",{className:"bucket-wrapper",children:(0,c.jsx)("svg",{ref:t=>{m.current=a.select(t)}})})}},3408:(t,e,n)=>{n.d(e,{Qj:()=>l,R1:()=>d,Uy:()=>i,X1:()=>h,fq:()=>c,hM:()=>u});var a=n(5760);const r=40,s=3;let o=0;function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.scaleLinear();return function(a){return a.map((a=>({x:-t,y:e-n(a)*e-e/2,width:2*t,height:2*e})))}}function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.each((function(t){const e=a.select(this),n=e.attr("cur-level")||0;e.attr("prev-level",n),e.attr("cur-level",t.y)})),t.transition("liquidSway").duration(2e3).delay(((t,e)=>10*e)).ease(a.easeQuad).attrTween("transform",(function(t,n){const s=a.select(this),o=parseFloat(s.attr("prev-level")),c=Math.abs(o-t.y)/200*e;return t=>"rotate(".concat(Math.sin(Math.min(4*Math.PI*t/(.5*c+.5),4*Math.PI))*c*r*(1-t),", ",0,", ",0,")")}));return t.transition("liquidLevel").ease(a.easeElasticOut.period(.6)).delay(((e,n)=>n*(100/t.size()))).duration(1e3)}function l(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return function(c){const i=o++;c.append("defs").attr("class","clip-def").append("clipPath").attr("id","bucket-mask-"+i).append("path").attr("class","bucket-mask-path"),c.append("g").attr("class","graph-area").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("clip-path","url(#bucket-mask-".concat(i,")")),c.append("path").attr("class","bucket-outline").attr("transform","translate(".concat(t/2,", ").concat(e/2,")")).attr("stroke","lightgray").attr("stroke-linecap","round").attr("stroke-width",s).attr("fill","none"),c.call(function(t){let{drawFunc:e,drawOutlineFunc:n=e,width:r,height:s}=t;return function(t){const o=t=>{const e=a.path();return t(e,r,s),e.toString()};t.select(".bucket-mask-path").attr("d",o(e)),t.select(".bucket-outline").attr("d",o(n))}}({drawFunc:n,drawOutlineFunc:r,width:t,height:e}))}}function h(t,e,n){f(t,e,n,!0)}function u(t,e,n){f(t,e,n,!1)}function f(t,e,n,a){const r=.8*e/2,s=-.8*e/2;t.moveTo(e/2,-n/2),t.lineTo(r,n/2),t.lineTo(s,n/2),t.lineTo(-e/2,-n/2),a&&t.closePath()}function d(t,e,n){const a=Math.SQRT2,r=1/(1+1*a),s=Math.min(e/2,n*r),o=s/(1/a),c=s+o;t.moveTo(0,-c/2),t.lineTo(o/2,-c/2+o/2),t.arc(0,-c/2+o,s,-Math.PI/4,5*Math.PI/4),t.closePath()}},1684:(t,e,n)=>{n.d(e,{E3:()=>s,YW:()=>o,kd:()=>i,m8:()=>c,wh:()=>l});var a=n(5760),r=n(3408);function s(t,e,n){let r=t.map((t=>Math.round(t.length/e))),s=a.sum(r);for(;s>n;)r[a.minIndex(t,((t,n)=>0!==t.length?t.length/e-r[n]:1/0))]-=1,s=a.sum(r);for(;s<n;)r[a.maxIndex(t,((t,n)=>0!==t.length?t.length/e-r[n]:-1/0))]+=1,s=a.sum(r);return r}const o=t=>a.interpolateBlues(a.scaleLinear([.2,1])(t));function c(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}function i(t,e,n){return a.range(n).map((a=>a/(n-1)*(e-t)+t))}function l(t,e){return(n=>{const r=a.path();return n(r,t,e),r.toString()})(r.X1)}},5639:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{F:()=>t});const t=await async function(){const t=await(await fetch("./factors.json")).json();return console.log("DATA: loading factors data"),t}();a()}catch(r){a(r)}}),1)},63:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{Vk:()=>c,Xe:()=>f,Zl:()=>i,iL:()=>u,jx:()=>h,pk:()=>o,sQ:()=>l});var r=n(9985),s=t([r]);r=(s.then?(await s)():s)[0];const o=1200,c="scens",i="delivs",l="delivs_unord",h=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[c]=e[c];for(const t of e[c]){const e=t[i].map((t=>Math.min(Math.max(0,t),o)));t[l]=e,t[i]=Array.from(e).sort(((t,e)=>e-t))}e[c]=(0,r.Et)(e[c],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,r.Et)(t,(t=>{let{obj:e}=t;return e}))}(),u=Object.keys(h),f=Object.keys(Object.values(h)[0][c]);a()}catch(o){a(o)}}),1)},9985:(t,e,n)=>{n.a(t,(async(t,a)=>{try{n.d(e,{C5:()=>S,Et:()=>d,Ft:()=>D,Ng:()=>C,Ul:()=>N,XC:()=>m,Yb:()=>B,bp:()=>P,cv:()=>R,hh:()=>Q,i7:()=>G,iJ:()=>U,js:()=>p,nC:()=>z,si:()=>g,u:()=>Y,xC:()=>V});var r=n(3981),s=n(5760),o=n(3783),c=n.n(o),i=n(5043),l=n(63),h=n(1684),u=t([l]);function d(t,e){const n=Object.groupBy(t,e);for(const a of Object.keys(n))n[a]=n[a][0];return n}l=(u.then?(await u)():u)[0];const m={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},p="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";function g(t){return t-=.0088,Math.min(1,Math.max(0,(3.1304*t**3-4.2384*t**2+3.3471*t+.0298)/2.2326))}const y=Math.SQRT1_2,v=1,x=y+y,k=v+y,M=.75;function w(t){if(t>=M){return Math.SQRT1_2*(1-t)/(1-M)}const e=2*(1-t/(x/k))-1,n=Math.acos(e);return Math.sin(n)}function b(t){return(t-y/k)*(1+Math.SQRT2)}function j(t){return t/(1+Math.SQRT2)+y/k}function P(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const a=n/2/v*y,r=.1,s=[],o=[];let c,i,l,h;for(let p=1;p<=Math.ceil(10)&&(c=w(t+(p-1)*r),i=b(t+(p-1)*r),l=w(t+p*r),h=b(t+p*r),!(j(h)>=e));p++){const t=[-c*a,-i*a],e=[c*a,-i*a],n=[l*a,-h*a],r=[-l*a,-h*a];s.push(e,n),o.push(t,r)}l=w(e),h=b(e);const u=[-c*a,-i*a],f=[c*a,-i*a],d=[l*a,-h*a],m=[-l*a,-h*a];return s.push(f,d),o.push(u,m),s.push(...o.reverse()),s}function C(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const a=n/2/v*y,r=.1,s=[];let o,c,i,l;for(let m=1;m<=Math.ceil(10)&&(o=w(t+(m-1)*r),c=b(t+(m-1)*r),i=w(t+m*r),l=b(t+m*r),!(j(l)>=e));m++){const t=[-o*a,-c*a],e=[o*a,-c*a],n=[i*a,-l*a],r=[-i*a,-l*a];s.push([t,e,n]),s.push([t,n,r])}i=w(e),l=b(e);const h=[-o*a,-c*a],u=[o*a,-c*a],f=[i*a,-l*a],d=[-i*a,-l*a];return s.push([h,u,f]),s.push([h,f,d]),s}function S(t,e){return function(n){return e.map((function(e){return[e,s.mean(n,(function(n){return t(e-n)}))]}))}}function V(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function T(t){const e=t/2,n=3*Math.PI/2/16,a=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let r=0;r<=16;r++)a.push({x:Math.cos(r*n-Math.PI/4)*e,y:Math.sin(r*n-Math.PI/4)*e});return a}function F(t,e){const n=c().Bounds.create(t),a=n.min.x,r=n.max.x,o=n.min.y,i=n.max.y,l=s.scaleLinear([a,r]),h=s.scaleLinear([o,i]),u=[];for(let s=0;s<e;s++)for(;;){const e=l(Math.random()),n=h(Math.random());if(c().Vertices.contains(t,{x:e,y:n})){u.push([e,n]);break}}return u}const E=function(){const t=T(3),e=T(1),n=[];for(let a=0;a<t.length-2;a++)n.push([t[a],t[a+(a<2?1:2)],e[a+(a<2?1:2)],e[a]]);return n}();let I,L,Z,O;function A(t){const e=s.sum(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function Q(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(a&&Z&&n.length===O)return Z;I&&n.length===L||(I=s.range(4).map((()=>F(T(1),L=n.length))));const r=A(n.map((t=>{let{r:e}=t;return e}))),o=I[Math.floor(Math.random()*I.length)].map((t=>{let[e,n]=t;return[e*r,n*r]})),i=c().Engine,l=c().Bodies,h=c().Composite,u=i.create(),f=o.sort(((t,e)=>e[1]-t[1])),d=n.map(((t,e)=>{let{r:n,id:a}=t;const[r,s]=f[e];return l.circle(r,s,n,{restitution:0,id:a})})),m=E.map((t=>c().Body.create({position:c().Vertices.centre(t),vertices:t,isStatic:!0}))),p=c().Body.create({isStatic:!0});c().Body.setParts(p,m),c().Body.setCentre(p,{x:0,y:0}),c().Body.scale(p,r,r),h.add(u.world,[...d,p]);for(let s=0,c=60,y=.1;s<c*y;s++)i.update(u,1e3/c);const g=d.map((n=>{let{position:a,id:r}=n;return{id:r,x:a.x+t,y:a.y+e}}));return g.height=r/2/y*k,!a||Z&&g.length===O||(Z=g,O=g.length),g}function z(t,e){const[n,a]=(0,i.useState)(t);return[(0,i.useMemo)((()=>e(n)),[n]),(0,i.useCallback)((t=>{a(e(t))}),[])]}function R(t,e,n,a){const r=n[t][l.Vk][e][l.Zl];return s.scaleLinear().domain((0,h.kd)(0,1,r.length)).range(r.map((t=>Math.min(1,t/a)))).clamp(!0)}function B(t,e,n){return"median"===t?Object.keys(e[n][l.Vk]).sort(((t,a)=>s.mean(e[n][l.Vk][t][l.Zl])-s.mean(e[n][l.Vk][a][l.Zl]))):"deliveries"===t?Object.keys(e[n][l.Vk]).sort(((t,a)=>s.max(e[n][l.Vk][t][l.Zl])-s.max(e[n][l.Vk][a][l.Zl]))):"alphabetical"===t?Object.keys(e[n][l.Vk]).sort():void 0}function q(t,e,n){var a;const r=e.split(".");for(let s of r){if(!t)return n;t=t[s]}return null!==(a=t)&&void 0!==a?a:n}function _(t){return"string"===typeof t?e=>q(e,t):t}function N(t,e){return e=_(e),t.sort(((t,n)=>{const a=e(t),r=e(n);return a<r?-1:a>r?1:0}))}function X(t){return t*Math.PI/180}class G{constructor(t){let{fov:e,near:n,far:a,width:o,height:c,domElement:i,zoomFn:l}=t;this.raycaster=new r.tBo,this.fov=e,this.near=n,this.far=a,this.width=o,this.height=c,this.camera=new r.ubm(e,o/c,n,a+1),this.camera.position.set(0,0,this.far),this.zoom=s.zoom().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,l&&l(t)})),this.view=s.select(i),this.view.call(this.zoom),this.zoom.transform(this.view,s.zoomIdentity.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,n=-(t.transform.x-this.width/2)/e,a=(t.transform.y-this.height/2)/e,r=this.getZFromScale(e);this.camera.position.set(n,a,r)}getScaleFromZ(t){const e=X(this.fov/2),n=2*(Math.tan(e)*t);return this.height/n}getZFromScale(t){const e=X(this.fov/2);return this.height/t/(2*Math.tan(e))}intersectObject(t,e,n){return this.raycaster.setFromCamera({x:t,y:e},this.camera),this.raycaster.intersectObject(n)}}class Y{constructor(){this.threeGeom=new r.V23,this.idx=0}addMeshCoords(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=[];for(let o=0;o<t.length;o++){const[c,i,l]=t[o],h=new r.Pq0(e.x+c[0],e.y-c[1],a),u=new r.Pq0(e.x+i[0],e.y-i[1],a),f=new r.Pq0(e.x+l[0],e.y-l[1],a);this.threeGeom.vertices.push(h,u,f);const d=new r.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);n&&(d.vertexColors.push(n),d.vertexColors.push(n),d.vertexColors.push(n)),this.threeGeom.faces.push(d),s.push(this.idx++)}return s}}function D(t,e,n,a){return{x:t/n*2-1,y:-e/a*2+1}}function U(t){const[e,n]=(0,i.useState)(t),a=(0,i.useRef)(t);(0,i.useEffect)((()=>{a.current=e}),[e]);const r=(0,i.useCallback)((t=>{n(a.current=t)}),[]);return[e,r,a]}a()}catch(f){a(f)}}))}}]);
//# sourceMappingURL=704.6b4d2548.chunk.js.map