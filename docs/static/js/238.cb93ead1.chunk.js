"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[238],{238:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n.d(e,{default:()=>v});var a=n(668),o=n(43),s=n(684),c=n(63),i=n(829),l=n(216),h=n(579),u=t([c,i]);[c,i]=u.then?(await u)():u;const p=5,f=3,m=.1,g=20,y=1.5;function v(t){let{watercolor:e=!1}=t;const n=(0,l.Zp)(),r=(0,o.useRef)(),[u,d]=(0,o.useState)(!1),f=(0,o.useRef)(),m=(0,o.useRef)(),y=(0,o.useMemo)((()=>{const t={},e={},n={};c.iL.forEach((t=>n[t]=(0,i.Yb)("median",c.jx,t).filter(((t,e)=>e%g==0)).reverse()));const r=Math.floor(n[c.iL[0]].length/2);return c.iL.sort(((t,e)=>a.JZy(c.jx[t][c.Vk][n[t][r]][c.Zl])-a.JZy(c.jx[e][c.Vk][n[e][r]][c.Zl]))).forEach((t=>{e[t]=n[t]})),c.iL.forEach((n=>{t[n]=e[n].map((t=>{const e=(0,i.cv)(n,t,c.jx,c.pk);return(0,s.kd)(0,1,p+1).map((t=>e(t)))}))})),t}),[]);return(0,o.useLayoutEffect)((()=>{r.current={width:window.innerWidth,height:window.innerHeight};const t=r.current.width,e=r.current.height;m.current=a.s_O().scaleExtent([1,10]).translateExtent([[-t/2,-e/2],[1.5*t,1.5*e]]).on("zoom",(function(t){f.current.select(".svg-trans").attr("transform",t.transform),f.current.selectAll(".text-scale").attr("transform","scale(".concat(1/t.transform.k,")"))})).on("start",(t=>"wheel"!==(t.sourceEvent||{}).type&&f.current.style("cursor","grabbing"))).on("end",(()=>f.current.style("cursor","grab"))),f.current.attr("width",t).attr("height",e).style("cursor","grab").call((t=>t.append("g").attr("class","svg-trans"))).call(m.current)}),[]),(0,o.useLayoutEffect)((()=>{const t=r.current.width,e=r.current.height;f.current.call(m.current.transform,a.GSI);const o=x(y,u);f.current.select(".svg-trans").selectAll(".largeDrop").data(o,(t=>t.obj)).join((t=>t.append("g").each((function(t,e){const n=a.Ltv(this);a.Ltv(this.parentNode).append("g").attr("id","drop-".concat(e)).append("g").attr("class","text-scale").append("text").style("font-size",16).attr("text-anchor","middle"),n.append("g").attr("class","rotateClass"),n.append("rect").attr("class","bbox").style("visibility","hidden"),n.on("mouseover",(function(){f.current.selectAll(".largeDrop").style("opacity",.5),n.style("opacity",1),f.current.select("#drop-".concat(e)).style("opacity",1)})).on("mouseout",(function(){f.current.selectAll(".largeDrop").style("opacity",1),f.current.select("#drop-".concat(e)).style("opacity",0)}))})))).attr("class","largeDrop").attr("transform",(n=>{let{x:r,y:a}=n;return"translate(".concat(r+t/2,", ").concat(a+e/2,")")})).each((function(t,e){const r=a.Ltv(this);a.Ltv("#drop-".concat(e)).style("opacity",0).select("text").text(t.obj),a.Ltv(this).select(".rotateClass").attr("transform","rotate(".concat(t.tilt,")")).selectAll(".smallDrop").data(t,((t,e)=>e)).join((t=>t.append("g").attr("class","smallDrop").each((function(t,n){let{levs:r}=t;const o=a.Ltv(this).append("defs").append("linearGradient").attr("id","drop-fill-".concat(e,"-").concat(n)).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");o.append("stop").attr("stop-color","transparent"),o.append("stop").attr("stop-color","transparent"),r.forEach(((t,e)=>{o.append("stop").attr("stop-color",(0,s.YW)(e/p)),o.append("stop").attr("stop-color",(0,s.YW)(e/p))})),a.Ltv(this).append("path").attr("d",i.js).attr("class","outline").attr("fill","none").attr("stroke","lightgray").attr("stroke-width",.05),a.Ltv(this).append("path").attr("class","fill").attr("d",i.js).attr("fill","url(#drop-fill-".concat(e,"-").concat(n,")"))})))).attr("transform",(t=>{let{x:e,y:n,tilt:r}=t;return"translate(".concat(e,", ").concat(n,") rotate(").concat(r,")")})).each((function(t){let{levs:e,maxLev:n}=t;a.Ltv(this).select(".outline").attr("transform","scale(".concat(.95*n,")")),a.Ltv(this).select(".fill").attr("transform","scale(".concat(n,")")),u?a.Ltv(this).select(".outline").style("display","block"):a.Ltv(this).select(".outline").style("display","none"),a.Ltv(this).selectAll("stop").each((function(t,r){let o=Math.floor((r-1)/2);-1===o?a.Ltv(this).attr("offset","".concat(0,"%")):o===e.length?a.Ltv(this).attr("offset","".concat(100,"%")):a.Ltv(this).attr("offset","".concat(100*(1-e[o]/n),"%"))}))}));const o=r.select(".rotateClass");r.on("click",(function(){n("/ScenarioDropletsApp?obj=".concat(t.obj,"&norm=").concat(u?"true":"false"))})),r.select(".bbox").attr("x",o.node().getBBox().x).attr("y",o.node().getBBox().y).attr("width",o.node().getBBox().width).attr("height",o.node().getBBox().height),f.current.select("#drop-".concat(e)).attr("transform","translate(".concat(o.node().getBoundingClientRect().x+o.node().getBoundingClientRect().width/2,", ").concat(o.node().getBoundingClientRect().y,")"))}))}),[y,u]),(0,h.jsxs)("div",{className:"bubbles-wrapper",children:[(0,h.jsxs)("div",{className:"bubbles-input-area",children:[(0,h.jsx)("input",{type:"checkbox",id:"norm",checked:u,onChange:()=>{d((t=>!t))}}),(0,h.jsx)("label",{htmlFor:"norm",children:"normalize"})]}),(0,h.jsx)("div",{className:"bubbles-svg-wrapper"+(e?"-painter":""),children:(0,h.jsx)("svg",{className:"bubbles-svg"+(e?"-painter":""),ref:t=>{f.current=a.Ltv(t)}})})]})}function x(t,e){const n=Object.keys(t).map((n=>{const r=(0,i.hh)(0,0,t[n].map(((t,n)=>({r:Math.max(2,(e?1:Math.max(t[0],m))*f*y),id:n})))),a=r.map((r=>{let{id:a,x:o,y:s}=r;return{levs:t[n][a].map(((t,e)=>Math.max(t,0==e?m:0)*f)),maxLev:(e?1:Math.max(t[n][a][0],m))*f,tilt:50*Math.random()-25,dur:100*Math.random()+400,x:o,y:s}}));return a.height=r.height,a.obj=n,a})).reverse();return(0,i.hh)(0,0,n.map(((t,e)=>({r:Math.max(1,8*Math.sqrt(a.czq(t.map((t=>t.maxLev)))/Math.PI)),id:e})))).forEach(((t,e)=>{let{x:r,y:a}=t;n[e].x=r,n[e].y=a,n[e].tilt=50*Math.random()-25,n[e].r=n[e].height/(1+Math.SQRT1_2)*Math.SQRT1_2})),n}r()}catch(d){r(d)}}))},684:(t,e,n)=>{n.d(e,{Q2:()=>c,YW:()=>l,ZC:()=>i,kd:()=>o,wh:()=>s});var r=n(668),a=n(43);function o(t,e,n){return r.y17(n).map((r=>r/(n-1)*(e-t)+t))}function s(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,o=t*a+t*(1-a)/2,s=t*(1-a)/2,c=[{x:r.GWP(o,t)(n),y:r.GWP(e,0)(n)},{x:o,y:e},{x:s,y:e},{x:r.GWP(s,0)(n),y:r.GWP(e,0)(n)}];return r.n8j().x((function(t){return t.x})).y((function(t){return t.y}))(c)+"z"}function c(t,e,n){let a=t.map((t=>Math.round(t.length/e))),o=r.czq(a);for(;o>n;)a[r.z94(t,((t,n)=>0!==t.length?t.length/e-a[n]:1/0))]-=1,o=r.czq(a);for(;o<n;)a[r.P2Z(t,((t,n)=>0!==t.length?t.length/e-a[n]:-1/0))]+=1,o=r.czq(a);return a}function i(t,e){const n=(0,a.useRef)({value:t,prev:null}),r=n.current.value;return(e?e(t,r):t===r)||(n.current={value:t,prev:r}),n.current.prev}const l=t=>r.dM(r.m4Y([.2,1])(t))},63:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{Vk:()=>c,Xe:()=>d,Zl:()=>i,iL:()=>u,jx:()=>h,pk:()=>s,sQ:()=>l});var a=n(829),o=t([a]);a=(o.then?(await o)():o)[0];const s=1200,c="scens",i="delivs",l="delivs_unord",h=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[c]=e[c];for(const t of e[c])t[l]=t[i],t[i]=t[l].map((t=>Math.min(Math.max(0,t),s))).sort(((t,e)=>e-t));e[c]=(0,a.Et)(e[c],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,a.Et)(t,(t=>{let{obj:e}=t;return e}))}(),u=Object.keys(h),d=Object.keys(Object.values(h)[0][c]);r()}catch(s){r(s)}}),1)},829:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{C5:()=>C,Et:()=>p,Ng:()=>L,XC:()=>f,Yb:()=>A,bp:()=>j,cv:()=>q,hh:()=>I,i7:()=>Q,iJ:()=>Y,js:()=>m,nC:()=>O,u:()=>F,xC:()=>S});var a=n(981),o=n(668),s=n(783),c=n.n(s),i=n(43),l=n(63),h=n(684),u=t([l]);function p(t,e){const n=Object.groupBy(t,e);for(const r of Object.keys(n))n[r]=n[r][0];return n}l=(u.then?(await u)():u)[0];const f={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},m="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";const g=Math.SQRT1_2,y=1,v=g+g,x=y+g,b=.75;function M(t){if(t>=b){return Math.SQRT1_2*(1-t)/(1-b)}const e=2*(1-t/(v/x))-1,n=Math.acos(e);return Math.sin(n)}function k(t){return(t-g/x)*(1+Math.SQRT2)}function w(t){return t/(1+Math.SQRT2)+g/x}function j(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/y*g,a=.1,o=[],s=[];let c,i,l,h;for(let m=1;m<=Math.ceil(10)&&(c=M(t+(m-1)*a),i=k(t+(m-1)*a),l=M(t+m*a),h=k(t+m*a),!(w(h)>=e));m++){const t=[-c*r,-i*r],e=[c*r,-i*r],n=[l*r,-h*r],a=[-l*r,-h*r];o.push(e,n),s.push(t,a)}l=M(e),h=k(e);const u=[-c*r,-i*r],d=[c*r,-i*r],p=[l*r,-h*r],f=[-l*r,-h*r];return o.push(d,p),s.push(u,f),o.push(...s.reverse()),o}function L(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/y*g,a=.1,o=[];let s,c,i,l;for(let f=1;f<=Math.ceil(10)&&(s=M(t+(f-1)*a),c=k(t+(f-1)*a),i=M(t+f*a),l=k(t+f*a),!(w(l)>=e));f++){const t=[-s*r,-c*r],e=[s*r,-c*r],n=[i*r,-l*r],a=[-i*r,-l*r];o.push([t,e,n]),o.push([t,n,a])}i=M(e),l=k(e);const h=[-s*r,-c*r],u=[s*r,-c*r],d=[i*r,-l*r],p=[-i*r,-l*r];return o.push([h,u,d]),o.push([h,d,p]),o}function C(t,e){return function(n){return e.map((function(e){return[e,o.i2o(n,(function(n){return t(e-n)}))]}))}}function S(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function Z(t){const e=t/2,n=3*Math.PI/2/16,r=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let a=0;a<=16;a++)r.push({x:Math.cos(a*n-Math.PI/4)*e,y:Math.sin(a*n-Math.PI/4)*e});return r}function B(t,e){const n=c().Bounds.create(t),r=n.min.x,a=n.max.x,s=n.min.y,i=n.max.y,l=o.m4Y([r,a]),h=o.m4Y([s,i]),u=[];for(let o=0;o<e;o++)for(;;){const e=l(Math.random()),n=h(Math.random());if(c().Vertices.contains(t,{x:e,y:n})){u.push([e,n]);break}}return u}const P=function(){const t=Z(3),e=Z(1),n=[];for(let r=0;r<t.length-2;r++)n.push([t[r],t[r+(r<2?1:2)],e[r+(r<2?1:2)],e[r]]);return n}();let E,R,z,T;function V(t){const e=o.czq(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function I(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&z&&n.length===T)return z;E&&n.length===R||(E=o.y17(4).map((()=>B(Z(1),R=n.length))));const a=V(n.map((t=>{let{r:e}=t;return e}))),s=E[Math.floor(Math.random()*E.length)].map((t=>{let[e,n]=t;return[e*a,n*a]})),i=c().Engine,l=c().Bodies,h=c().Composite,u=i.create(),d=s.sort(((t,e)=>e[1]-t[1])),p=n.map(((t,e)=>{let{r:n,id:r}=t;const[a,o]=d[e];return l.circle(a,o,n,{restitution:0,id:r})})),f=P.map((t=>c().Body.create({position:c().Vertices.centre(t),vertices:t,isStatic:!0}))),m=c().Body.create({isStatic:!0});c().Body.setParts(m,f),c().Body.setCentre(m,{x:0,y:0}),c().Body.scale(m,a,a),h.add(u.world,[...p,m]);for(let o=0,c=60,g=.1;o<c*g;o++)i.update(u,1e3/c);const y=p.map((n=>{let{position:r,id:a}=n;return{id:a,x:r.x+t,y:r.y+e}}));return y.height=a/2/g*x,!r||z&&y.length===T||(z=y,T=y.length),y}function O(t,e){const[n,r]=(0,i.useState)(t);return[(0,i.useMemo)((()=>e(n)),[n]),(0,i.useCallback)((t=>{r(e(t))}),[])]}function q(t,e,n,r){const a=n[t][l.Vk][e][l.Zl];return o.m4Y().domain((0,h.kd)(0,1,a.length)).range(a.map((t=>Math.min(1,t/r)))).clamp(!0)}function A(t,e,n){return"median"===t?Object.keys(e[n][l.Vk]).sort(((t,r)=>o.i2o(e[n][l.Vk][t][l.Zl])-o.i2o(e[n][l.Vk][r][l.Zl]))):"deliveries"===t?Object.keys(e[n][l.Vk]).sort(((t,r)=>o.T9B(e[n][l.Vk][t][l.Zl])-o.T9B(e[n][l.Vk][r][l.Zl]))):"alphabetical"===t?Object.keys(e[n][l.Vk]).sort():void 0}function G(t){return t*Math.PI/180}class Q{constructor(t){let{fov:e,near:n,far:r,width:s,height:c,domElement:i,zoomFn:l}=t;this.fov=e,this.near=n,this.far=r,this.width=s,this.height=c,this.camera=new a.ubm(e,s/c,n,r+1),this.camera.position.set(0,0,this.far),this.zoom=o.s_O().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,l&&l(t)})),this.view=o.Ltv(i),this.view.call(this.zoom),this.zoom.transform(this.view,o.GSI.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,n=-(t.transform.x-this.width/2)/e,r=(t.transform.y-this.height/2)/e,a=this.getZFromScale(e);this.camera.position.set(n,r,a)}getScaleFromZ(t){const e=G(this.fov/2),n=2*(Math.tan(e)*t);return this.height/n}getZFromScale(t){const e=G(this.fov/2);return this.height/t/(2*Math.tan(e))}}class F{constructor(){this.threeGeom=new a.V23,this.idx=0}addMeshCoords(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=[];for(let s=0;s<t.length;s++){const[c,i,l]=t[s],h=new a.Pq0(e.x+c[0],e.y-c[1],r),u=new a.Pq0(e.x+i[0],e.y-i[1],r),d=new a.Pq0(e.x+l[0],e.y-l[1],r);this.threeGeom.vertices.push(h,u,d);const p=new a.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);n&&(p.vertexColors.push(n),p.vertexColors.push(n),p.vertexColors.push(n)),this.threeGeom.faces.push(p),o.push(this.idx++)}return o}}function Y(t){const[e,n]=(0,i.useState)(t),r=(0,i.useRef)(t);(0,i.useEffect)((()=>{r.current=e}),[e]);const a=(0,i.useCallback)((t=>{n(r.current=t)}),[]);return[e,a,r]}r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=238.cb93ead1.chunk.js.map