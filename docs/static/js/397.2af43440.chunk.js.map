{"version":3,"file":"static/js/397.2af43440.chunk.js","mappings":"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","sources":["ExplanationAnimApp.jsx","data/completeObjectivesData.jsx","utils/explanation-anim/DotHistogram.jsx","utils/explanation-anim/constants.jsx","utils/explanation-anim/data-story-anims.jsx","utils/explanation-anim/useDataStory.jsx","utils/explanation-anim/useTutorialState.jsx"],"sourcesContent":["import * as d3 from \"d3\";\r\nimport React, { forwardRef, useEffect, useMemo, useState } from \"react\";\r\nimport { Scrollama, Step } from \"react-scrollama\";\r\n\r\nimport BucketGlyph from \"bucket-lib/BucketGlyph\";\r\n\r\nimport DotHistogram from \"utils/explanation-anim/DotHistogram\";\r\nimport DropletGlyph from \"bucket-lib/DropletGlyph\";\r\nimport { constants } from \"utils/explanation-anim/constants\";\r\nimport { hideElems } from \"utils/explanation-anim/render-utils\";\r\nimport { useDataStory } from \"utils/explanation-anim/useDataStory\";\r\nimport useTutorialState from \"utils/explanation-anim/useTutorialState\";\r\n\r\nexport default function ExplanationAnimApp() {\r\n  const [curObjective, setCurObjective] = useState(constants.DEFAULT_OBJECTIVE);\r\n  const [normalized, setNormalized] = useState(false);\r\n\r\n  const tutorialState = useTutorialState(curObjective, normalized);\r\n  const slides = useDataStory(tutorialState, curObjective, normalized);\r\n\r\n  useEffect(\r\n    function changeObjective() {\r\n      hideElems(\r\n        \".bucket-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-drop-graphics-wrapper\"\r\n      );\r\n\r\n      tutorialState.setReadyHash((rh) => rh + 1);\r\n    },\r\n    [curObjective, normalized]\r\n  );\r\n\r\n  return (\r\n    <div className=\"tutorial-view\">\r\n      <Selector\r\n        val={curObjective}\r\n        setVal={setCurObjective}\r\n        options={Object.keys(constants.SELECTED_OBJS).map((objId) => ({\r\n          options: objId,\r\n          display_name: constants.SELECTED_OBJS[objId],\r\n        }))}\r\n      />\r\n      <Toggle\r\n        label=\"normalize across scenarios\"\r\n        val={normalized}\r\n        setVal={setNormalized}\r\n      />\r\n      <div className=\"scrollama scrollama-1\">\r\n        <DataStoryGraphics\r\n          curObjective={curObjective}\r\n          normalized={normalized}\r\n          tutorialState={tutorialState}\r\n        />\r\n        <DataStoryTexts slides={slides} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction DataStoryGraphics({ curObjective, tutorialState }) {\r\n  const { maxDelivs, minDelivs } = tutorialState;\r\n\r\n  const mainHistData = useMemo(\r\n    () => ({\r\n      data: tutorialState.objectiveDelivs,\r\n      domain: [minDelivs, maxDelivs],\r\n    }),\r\n    [tutorialState.objectiveDelivs]\r\n  );\r\n\r\n  const variations = useMemo(\r\n    () =>\r\n      constants.VARIATIONS.map((variation) => ({\r\n        ...variation,\r\n        interper: tutorialState.variationInterpers[variation.idx],\r\n        histData: {\r\n          data: tutorialState.objectiveVariationDelivs[variation.idx],\r\n          domain: [minDelivs, maxDelivs],\r\n        },\r\n      })),\r\n    [tutorialState.objectiveVariationDelivs, tutorialState.variationInterpers]\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <BucketConstructionGraphics\r\n        label={constants.SELECTED_OBJS[curObjective]}\r\n        bucketInterper={tutorialState.bucketInterper}\r\n      />\r\n\r\n      <ScenarioComparingGraphics\r\n        label={constants.SELECTED_OBJS[curObjective]}\r\n        mainDropInterper={tutorialState.dropInterper}\r\n        mainHistData={mainHistData}\r\n        variations={variations}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nfunction DataStoryTexts({ slides }) {\r\n  return (\r\n    <DataStoryScrollama\r\n      cleanupFn={() => {\r\n        for (let i = slides.length - 1; i >= 0; i--) {\r\n          slides[i].animHandler?.undo();\r\n        }\r\n      }}\r\n    >\r\n      {slides.map((slide, i) => (\r\n        <Step key={i} data={slide}>\r\n          <Slide slide={slide} />\r\n        </Step>\r\n      ))}\r\n    </DataStoryScrollama>\r\n  );\r\n}\r\n\r\nfunction Selector({ val, setVal, options }) {\r\n  return (\r\n    <select value={val} onChange={(e) => setVal(e.target.value)}>\r\n      {options.map(({ option, display_name }, i) => (\r\n        <option value={option} key={i}>\r\n          {display_name}\r\n        </option>\r\n      ))}\r\n    </select>\r\n  );\r\n}\r\n\r\nfunction Toggle({ label, val, setVal }) {\r\n  return (\r\n    <>\r\n      <label htmlFor=\"normalize\">{label}</label>\r\n      <input\r\n        checked={val}\r\n        onChange={(e) => setVal(e.target.checked)}\r\n        type=\"checkbox\"\r\n        name=\"normalize\"\r\n        id=\"normalize\"\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nfunction ScenarioComparingGraphics({\r\n  label,\r\n  mainDropInterper,\r\n  mainHistData,\r\n  variations,\r\n}) {\r\n  return (\r\n    <div className=\"tut-drop-graphics-wrapper\">\r\n      <MainScenarioInfo\r\n        dropInterper={mainDropInterper}\r\n        histData={mainHistData}\r\n        label={label}\r\n      />\r\n      {variations.map((variation, i) => (\r\n        <VariationScenarioPanel key={i} variation={variation} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MainScenarioInfo({ dropInterper, histData, label }) {\r\n  return (\r\n    <>\r\n      <div className=\"main-waterdrop\">\r\n        <DropletGlyph\r\n          levelInterp={dropInterper}\r\n          width={400}\r\n          height={constants.BAR_CHART_HEIGHT}\r\n          colorInterp={constants.INTERP_COLOR}\r\n          resolution={constants.BUCKET_RES}\r\n        />\r\n      </div>\r\n      <div className=\"main-histogram\">\r\n        <DotHistogram\r\n          width={330}\r\n          height={220}\r\n          data={histData.data}\r\n          domain={histData.domain}\r\n        />\r\n      </div>\r\n      <p className=\"fancy-font objective-label\">{label}</p>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction VariationScenarioPanel({ variation }) {\r\n  const { idx, clas, desc, interper, histData } = variation;\r\n  return (\r\n    <div className={`vardrop ${clas}`} key={idx} desc={desc}>\r\n      <div>\r\n        <DropletGlyph\r\n          levelInterp={interper}\r\n          width={200}\r\n          height={constants.BAR_CHART_HEIGHT / 2}\r\n          colorInterp={constants.INTERP_COLOR}\r\n          resolution={constants.BUCKET_RES}\r\n        />\r\n        <DotHistogram\r\n          width={330}\r\n          height={220}\r\n          data={histData.data}\r\n          domain={histData.domain}\r\n        />\r\n      </div>\r\n      <p className=\"var-scen-label\">{desc}</p>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction BucketConstructionGraphics({ label, bucketInterper }) {\r\n  return (\r\n    <div className=\"tut-graph-wrapper\">\r\n      <div className=\"tut-graph\">\r\n        <svg id=\"pag-bar-graph\"></svg>\r\n        <BucketGlyph\r\n          levelInterp={bucketInterper}\r\n          width={300}\r\n          height={constants.BAR_CHART_HEIGHT}\r\n          colorInterp={constants.INTERP_COLOR}\r\n          resolution={constants.BUCKET_RES}\r\n        />\r\n        <p className=\"fancy-font objective-label\">{label}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction DataStoryScrollama({ cleanupFn, children }) {\r\n  const onStepEnter = async ({ data, direction }) => {\r\n    if (direction === \"up\") return;\r\n    data.animHandler?.do();\r\n  };\r\n\r\n  const onStepExit = async ({ data, direction }) => {\r\n    if (direction === \"down\") return;\r\n    data.animHandler?.undo();\r\n  };\r\n\r\n  return (\r\n    <Scrollama offset={0.9} onStepEnter={onStepEnter} onStepExit={onStepExit}>\r\n      {children}\r\n      <Step key={\"last\"} data={{}}>\r\n        <ReturnToTop cleanupFn={cleanupFn} />\r\n      </Step>\r\n    </Scrollama>\r\n  );\r\n}\r\n\r\nconst Slide = forwardRef(function Slide({ slide }, ref) {\r\n  return (\r\n    <div ref={ref} className=\"tut-text-card\">\r\n      {slide.text}\r\n    </div>\r\n  );\r\n});\r\n\r\nconst ReturnToTop = forwardRef(function ReturnToTop({ cleanupFn }, ref) {\r\n  return (\r\n    <div ref={ref} className=\"tut-text-card\" style={{ marginBottom: \"40vh\" }}>\r\n      <button\r\n        onClick={() => {\r\n          window.scrollTo(0, 0);\r\n          cleanupFn();\r\n        }}\r\n      >\r\n        Back to Top\r\n      </button>\r\n    </div>\r\n  );\r\n});\r\n","import { mapBy } from \"utils/common\";\r\n\r\nexport const MAX_DELIVS = 1200;\r\nexport const SCENARIO_KEY_STRING = \"scens\";\r\nexport const DELIV_KEY_STRING = \"delivs\";\r\nexport const DELIV_KEY_STRING_UNORD = \"delivs_unord\";\r\n\r\nexport const objectivesData = await (async function () {\r\n  const objs = await (await fetch(\"./select_complete_objectives.json\")).json();\r\n\r\n  for (const obj of objs) {\r\n    for (const scen of obj[SCENARIO_KEY_STRING]) {\r\n      scen[DELIV_KEY_STRING_UNORD] = Array.from(scen[DELIV_KEY_STRING]);\r\n      scen[DELIV_KEY_STRING] = Array.from(scen[DELIV_KEY_STRING]).sort(\r\n        (a, b) => b - a\r\n      );\r\n    }\r\n    obj[SCENARIO_KEY_STRING] = mapBy(\r\n      obj[SCENARIO_KEY_STRING],\r\n      ({ name }) => name\r\n    );\r\n  }\r\n\r\n  console.log(\"DATA: loading objectives data\");\r\n\r\n  return mapBy(objs, ({ obj }) => obj);\r\n})();\r\n\r\nexport const objectiveIDs = Object.keys(objectivesData);\r\nexport const scenarioIDs = Object.keys(\r\n  Object.values(objectivesData)[0][SCENARIO_KEY_STRING]\r\n);\r\n","import * as d3 from \"d3\";\r\nimport { useEffect, useMemo, useRef } from \"react\";\r\nimport { quantileBins } from \"bucket-lib/quantile-bins\";\r\n\r\nconst NUM_CIRCLES = 20;\r\nconst MARGIN = { top: 10, right: 10, bottom: 40, left: 10 };\r\n\r\nconst WATERDROP_ICON = {\r\n  draw: function (context, size) {\r\n    context.moveTo(0, -size / 2);\r\n    context.lineTo(size / 4, -size / 4);\r\n\r\n    context.arc(0, 0, size / Math.SQRT2 / 2, -Math.PI / 4, (Math.PI * 5) / 4);\r\n    context.lineTo(0, -size / 2);\r\n    context.closePath();\r\n  },\r\n};\r\n\r\nexport default function DotHistogram({\r\n  data,\r\n  domain = [0, d3.max(data)],\r\n  width = 600,\r\n  height = 400,\r\n}) {\r\n  const svgSelector = useRef();\r\n  const circles = useMemo(\r\n    () => quantileBins(width, height, data.length / NUM_CIRCLES, domain)(data),\r\n    [data, domain]\r\n  );\r\n\r\n  const dataRange = [0, data.length];\r\n  const x = d3.scaleLinear().domain(domain).range([0, width]);\r\n  const y = d3.scaleLinear().domain(dataRange).range([height, 0]);\r\n\r\n  useEffect(() => {\r\n    svgSelector.current.selectAll(\"*\").remove();\r\n    const svgContainer = svgSelector.current\r\n      .attr(\"width\", width + MARGIN.left + MARGIN.right)\r\n      .attr(\"height\", height + MARGIN.top + MARGIN.bottom)\r\n      .style(\"pointer-events\", \"none\")\r\n      .append(\"g\")\r\n      .attr(\"class\", \"graph-area\")\r\n      .attr(\"transform\", `translate(${MARGIN.left},${MARGIN.top})`);\r\n\r\n    svgContainer\r\n      .append(\"g\")\r\n      .attr(\"transform\", `translate(0, ${height})`)\r\n      .call(d3.axisBottom().scale(x).tickFormat(d3.format(\".2s\")))\r\n      .call((s) => {\r\n        s.selectAll(\"line\").attr(\"stroke\", \"gray\");\r\n        s.selectAll(\"path\").attr(\"stroke\", \"gray\");\r\n        s.selectAll(\"text\").attr(\"fill\", \"gray\");\r\n      })\r\n      .append(\"text\")\r\n      .attr(\"fill\", \"black\")\r\n      .attr(\"font-size\", \"2em\")\r\n      .attr(\"transform\", `translate(${width / 2}, ${30})`)\r\n      .text(\"Deliveries (TAF)\");\r\n  }, [data, domain]);\r\n\r\n  useEffect(() => {\r\n    const svgCircles = svgSelector.current\r\n      .select(\".graph-area\")\r\n      .selectAll(\".icons\")\r\n      .data(circles)\r\n      .join((enter) => enter.append(\"g\").call((s) => s.append(\"path\")))\r\n      .attr(\"class\", \"icons\")\r\n      .call((s) => {\r\n        s.selectAll(\"path\").attr(\r\n          \"d\",\r\n          d3.symbol(WATERDROP_ICON, height / NUM_CIRCLES)\r\n        );\r\n      });\r\n\r\n    svgCircles.attr(\"transform\", (d) => `translate(${x(d[0])},${y(d[1])})`);\r\n\r\n    svgCircles.attr(\"fill\", \"steelblue\");\r\n  }, [circles]);\r\n\r\n  return (\r\n    <div className={`dot-histogram-wrapper`}>\r\n      <svg ref={(e) => void (svgSelector.current = d3.select(e))}></svg>\r\n    </div>\r\n  );\r\n}\r\n","import * as d3 from \"d3\";\r\nimport { interpolateWatercolorBlue } from \"bucket-lib/utils\";\r\n\r\nfunction initConstants() {\r\n  const BAR_CHART_WIDTH = 500,\r\n    BAR_CHART_HEIGHT = 400;\r\n\r\n  const BUCKET_RES = 4;\r\n\r\n  // const INTERP_COLOR = d3.interpolateRgbBasis([\r\n  //   \"#F2F5FB\",\r\n  //   \"#D0DDEB\",\r\n  //   \"#7B9BC0\",\r\n  //   \"#4F739F\",\r\n  //   \"#112A57\",\r\n  // ]);\r\n  const INTERP_COLOR = interpolateWatercolorBlue;\r\n\r\n  const DEFAULT_OBJECTIVE = \"DEL_NOD_AG_TOTAL\";\r\n  const BASELINE_SCENARIO = \"expl0000\";\r\n\r\n  const _VARIATIONS = [\r\n    {\r\n      scen_num_str: \"0004\",\r\n      desc: \"natural flows\",\r\n    },\r\n    {\r\n      scen_num_str: \"0015\",\r\n      desc: \"reduce delta regs.\",\r\n    },\r\n    {\r\n      scen_num_str: \"0320\",\r\n      desc: \"prioritize carryover\",\r\n    },\r\n    {\r\n      scen_num_str: \"0360\",\r\n      desc: \"municipal priority\",\r\n    },\r\n    {\r\n      scen_num_str: \"0261\",\r\n      desc: \"rebalancing\",\r\n    },\r\n  ];\r\n\r\n  const VARIATIONS = _VARIATIONS.map(extendVarObj);\r\n\r\n  const SELECTED_OBJS = {\r\n    DEL_NOD_AG_TOTAL: \"DEL_NOD_AG_TOTAL\",\r\n    DEL_SJV_AG_TOTAL: \"DEL_SJV_AG_TOTAL\",\r\n    DEL_NOD_MI_TOTAL: \"DEL_NOD_MI_TOTAL\",\r\n    DEL_SJV_MI_TOTAL: \"DEL_SJV_MI_TOTAL\",\r\n    DEL_SOCAL_MI_TOTAL: \"DEL_SOCAL_MI_TOTAL\",\r\n    CVP_SWP_EXPORTS: \"CVP_SWP_EXPORTS\",\r\n    NDO: \"NDO\",\r\n    SAC_IN: \"SAC_IN\",\r\n    SJR_IN: \"SJR_IN\",\r\n    STO_NOD_TOTAL: \"STO_NOD_TOTAL\",\r\n    STO_SOD_TOTAL: \"STO_SOD_TOTAL\",\r\n  };\r\n\r\n  return {\r\n    BAR_CHART_WIDTH,\r\n    BAR_CHART_HEIGHT,\r\n    BUCKET_RES,\r\n    INTERP_COLOR,\r\n    DEFAULT_OBJECTIVE,\r\n    BASELINE_SCENARIO,\r\n    VARIATIONS,\r\n    SELECTED_OBJS,\r\n  };\r\n}\r\n\r\nfunction extendVarObj({ scen_num_str, desc }, idx) {\r\n  return {\r\n    idx,\r\n    scen_num_str,\r\n    desc,\r\n    scen_str: `expl${scen_num_str}`,\r\n    clas: `drop${idx + 1}`,\r\n  };\r\n}\r\n\r\nexport const constants = initConstants();\r\n","import * as d3 from \"d3\";\r\n\r\nimport { objectivesData } from \"data/completeObjectivesData\";\r\n\r\nimport { constants } from \"./constants\";\r\nimport { hideElems, showElems } from \"./render-utils\";\r\nimport {\r\n  DELIV_KEY_STRING_UNORD,\r\n  SCENARIO_KEY_STRING,\r\n} from \"data/objectivesData\";\r\nimport { ticksExact } from \"bucket-lib/utils\";\r\nimport { percentToRatioFilled } from \"utils/common\";\r\n\r\nconst BASELINE_SCENARIO = \"expl0000\";\r\n\r\nfunction initAllAnims() {\r\n  function initChartAnimGroup({ deps, objective, normalized }) {\r\n    let _XInterp;\r\n    let _XAxis;\r\n    let _dataDescending;\r\n    let _minDelivs;\r\n    let _maxDelivs;\r\n\r\n    const BAR_CHART_MARGIN = { top: 40, right: 30, bottom: 40, left: 60 };\r\n\r\n    function prepareSVG() {\r\n      {\r\n        d3.select(\"#pag-bar-graph > *\").remove();\r\n\r\n        const svgGroup = d3\r\n          .select(\"#pag-bar-graph\")\r\n          .attr(\r\n            \"width\",\r\n            constants.BAR_CHART_WIDTH +\r\n              BAR_CHART_MARGIN.left +\r\n              BAR_CHART_MARGIN.right\r\n          )\r\n          .attr(\r\n            \"height\",\r\n            constants.BAR_CHART_HEIGHT +\r\n              BAR_CHART_MARGIN.top +\r\n              BAR_CHART_MARGIN.bottom\r\n          )\r\n          .attr(\"opacity\", 1)\r\n          .append(\"g\")\r\n          .attr(\"class\", \"svg-group\")\r\n          .attr(\r\n            \"transform\",\r\n            `translate(${BAR_CHART_MARGIN.left},${BAR_CHART_MARGIN.top})`\r\n          );\r\n\r\n        const delivs =\r\n          objectivesData[objective][SCENARIO_KEY_STRING][BASELINE_SCENARIO][\r\n            DELIV_KEY_STRING_UNORD\r\n          ];\r\n\r\n        _maxDelivs = deps.maxDelivs;\r\n        _minDelivs = deps.minDelivs;\r\n\r\n        const dataDescending = delivs\r\n          .map((val, placeFromLeft) => ({\r\n            val,\r\n            placeFromLeft,\r\n            year: placeFromLeft + 1,\r\n          }))\r\n          .sort((a, b) => b.val - a.val);\r\n\r\n        const x = d3\r\n          .scaleBand()\r\n          .domain(dataDescending.map(({ year }) => year).sort((a, b) => a - b))\r\n          .range([0, constants.BAR_CHART_WIDTH])\r\n          .padding(0.4);\r\n        const y = d3\r\n          .scaleLinear()\r\n          .domain([_minDelivs, _maxDelivs])\r\n          .range([constants.BAR_CHART_HEIGHT, 0]);\r\n\r\n        const xaxis = d3\r\n          .axisBottom(x)\r\n          .tickSize(0)\r\n          .tickFormat((d) => `year ${d}`)\r\n          .tickValues(\r\n            x.domain().filter((_, i) => i === 0 || (i + 1) % 10 === 0)\r\n          );\r\n\r\n        svgGroup.append(\"g\").attr(\"class\", \"anim-xaxis\");\r\n        svgGroup.append(\"g\").attr(\"class\", \"axis-y\");\r\n        svgGroup\r\n          .select(\".anim-xaxis\")\r\n          .attr(\"opacity\", 1)\r\n          .attr(\"transform\", `translate(0, ${constants.BAR_CHART_HEIGHT})`)\r\n          .call(xaxis)\r\n          .selectAll(\"text\")\r\n          .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\r\n          .style(\"text-anchor\", \"end\");\r\n        svgGroup\r\n          .select(\".axis-y\")\r\n          .call(d3.axisLeft(y).tickFormat(d3.format(\".2s\")))\r\n          .append(\"text\")\r\n          .text(\"Deliveries (TAF)\")\r\n          .attr(\"fill\", \"black\")\r\n          .attr(\"font-weight\", \"bold\")\r\n          .attr(\r\n            \"transform\",\r\n            `translate(-50, ${constants.BAR_CHART_HEIGHT / 2}) rotate(-90)`\r\n          );\r\n\r\n        _XInterp = x;\r\n        _XAxis = xaxis;\r\n        _dataDescending = dataDescending;\r\n      }\r\n    }\r\n\r\n    function barsAppearDo() {\r\n      {\r\n        const y = d3\r\n          .scaleLinear()\r\n          .domain([_minDelivs, _maxDelivs])\r\n          .range([constants.BAR_CHART_HEIGHT, 0]);\r\n\r\n        d3.select(\"#pag-bar-graph .svg-group\")\r\n          .selectAll(\".bars\")\r\n          .data(_dataDescending, (d) => d.placeFromLeft)\r\n          .join(\"rect\")\r\n          .attr(\"class\", \"bars\")\r\n          .attr(\"x\", (d) => _XInterp(d.year))\r\n          .attr(\"y\", constants.BAR_CHART_HEIGHT)\r\n          .attr(\"width\", _XInterp.bandwidth())\r\n          .attr(\"height\", 0)\r\n          .attr(\"opacity\", 1)\r\n          .attr(\"fill\", \"steelblue\")\r\n          .transition()\r\n          .duration(500)\r\n          .delay((d) => d.placeFromLeft * 10)\r\n          .attr(\"y\", (d) => y(d.val))\r\n          .attr(\"height\", (d) => constants.BAR_CHART_HEIGHT - y(d.val));\r\n      }\r\n    }\r\n\r\n    function barsAppearUndo() {\r\n      {\r\n        d3.select(\"#pag-bar-graph .svg-group\")\r\n          .selectAll(\".bars\")\r\n          .data(_dataDescending, (d) => d.placeFromLeft)\r\n          .transition()\r\n          .duration(500)\r\n          .delay((d) => (_dataDescending.length - d.placeFromLeft - 1) * 10)\r\n          .attr(\"y\", constants.BAR_CHART_HEIGHT)\r\n          .attr(\"height\", 0);\r\n      }\r\n    }\r\n\r\n    async function barsCondenseDo() {\r\n      {\r\n        const newWidth = constants.BAR_CHART_WIDTH / 8;\r\n        const svgGroup = d3.select(\"#pag-bar-graph .svg-group\");\r\n\r\n        svgGroup.select(\".anim-xaxis\").call(_XAxis.tickFormat(\"\"));\r\n\r\n        const bars = svgGroup.selectAll(\".bars\");\r\n\r\n        bars\r\n          .style(\"mix-blend-mode\", \"multiply\")\r\n          .transition()\r\n          .duration(500)\r\n          .attr(\"opacity\", 0.05)\r\n          .transition()\r\n          .delay(\r\n            (d) =>\r\n              100 +\r\n              (1 - (1 - d.placeFromLeft / _dataDescending.length) ** 4) * 1000\r\n          )\r\n          .duration(500)\r\n          .attr(\"width\", newWidth)\r\n          .attr(\"x\", constants.BAR_CHART_WIDTH / 2 - newWidth / 2)\r\n          .end()\r\n          .catch(() => {})\r\n          .then(() => {\r\n            svgGroup\r\n              .select(\".anim-xaxis\")\r\n              .transition()\r\n              .transition(500)\r\n              .attr(\r\n                \"transform\",\r\n                `translate(0, ${constants.BAR_CHART_HEIGHT + 50})`\r\n              )\r\n              .attr(\"opacity\", 0);\r\n\r\n            bars.transition().delay(500).attr(\"x\", 0);\r\n\r\n            svgGroup\r\n              .transition()\r\n              .delay(500)\r\n              .attr(\r\n                \"transform\",\r\n                `translate(${\r\n                  BAR_CHART_MARGIN.left +\r\n                  constants.BAR_CHART_WIDTH / 2 -\r\n                  newWidth / 2\r\n                },${BAR_CHART_MARGIN.top})`\r\n              );\r\n          });\r\n      }\r\n    }\r\n\r\n    function barsCondenseUndo() {\r\n      {\r\n        const svgGroup = d3.select(\"#pag-bar-graph .svg-group\");\r\n\r\n        const bars = svgGroup.selectAll(\".bars\");\r\n\r\n        svgGroup\r\n          .select(\".anim-xaxis\")\r\n          .transition()\r\n          .transition(500)\r\n          .attr(\"transform\", `translate(0, ${constants.BAR_CHART_HEIGHT})`)\r\n          .attr(\"opacity\", 1);\r\n\r\n        svgGroup\r\n          .select(\".anim-xaxis\")\r\n          .call(_XAxis.tickFormat((d) => `year ${d}`));\r\n\r\n        svgGroup\r\n          .transition()\r\n          .delay(500)\r\n          .attr(\r\n            \"transform\",\r\n            `translate(${BAR_CHART_MARGIN.left},${BAR_CHART_MARGIN.top})`\r\n          );\r\n\r\n        bars\r\n          .transition()\r\n          .delay(\r\n            (d) =>\r\n              100 + (1 - (d.placeFromLeft / _dataDescending.length) ** 4) * 1000\r\n          )\r\n          .duration(500)\r\n          .attr(\"x\", (d) => _XInterp(d.year))\r\n          .attr(\"width\", _XInterp.bandwidth())\r\n          .transition()\r\n          .duration(500)\r\n          .attr(\"opacity\", 1)\r\n          .end()\r\n          .catch(() => {})\r\n          .then(() => {\r\n            bars.style(\"mix-blend-mode\", \"normal\");\r\n          });\r\n      }\r\n    }\r\n\r\n    prepareSVG();\r\n\r\n    return {\r\n      barsAppear: {\r\n        do: barsAppearDo,\r\n        undo: barsAppearUndo,\r\n      },\r\n      barsCondense: {\r\n        do: barsCondenseDo,\r\n        undo: barsCondenseUndo,\r\n      },\r\n    };\r\n  }\r\n\r\n  function initBucketsFillAnim({ deps, objective }) {\r\n    function animDo() {\r\n      d3.selectAll(\".tut-graph-wrapper .bucket-wrapper\").style(\r\n        \"display\",\r\n        \"initial\"\r\n      );\r\n      d3.select(\"#pag-bar-graph\").attr(\"opacity\", 0);\r\n\r\n      deps.setBucketInterper(() => deps.objectiveInterper);\r\n    }\r\n\r\n    function animUndo() {\r\n      deps.setBucketInterper(() => d3.scaleLinear().range([0, 0]));\r\n\r\n      d3.selectAll(\".tut-graph-wrapper .bucket-wrapper\").style(\r\n        \"display\",\r\n        \"none\"\r\n      );\r\n      d3.select(\"#pag-bar-graph\").transition().attr(\"opacity\", 1);\r\n    }\r\n\r\n    return {\r\n      do: animDo,\r\n      undo: animUndo,\r\n    };\r\n  }\r\n\r\n  function initDropFillAnim({ deps, objective }) {\r\n    function animDo() {\r\n      showElems(\".main-waterdrop\");\r\n      showElems(\".tut-drop-graphics-wrapper\", d3, \"grid\");\r\n      hideElems(\".tut-graph-wrapper, .bucket-wrapper\");\r\n      deps.setDropInterper(() => deps.objectiveInterperDrop);\r\n    }\r\n\r\n    function animUndo() {\r\n      hideElems(\".tut-drop-graphics-wrapper, .main-waterdrop\");\r\n      showElems(\".bucket-wrapper\");\r\n      showElems(\".tut-graph-wrapper\", d3, \"flex\");\r\n      deps.setDropInterper(() => d3.scaleLinear().range([0, 0]));\r\n    }\r\n\r\n    return {\r\n      do: animDo,\r\n      undo: animUndo,\r\n    };\r\n  }\r\n\r\n  function initShowVariationsAnim({ deps }) {\r\n    return {\r\n      do: function () {\r\n        // vardrops\r\n        d3.selectAll(\".vardrop\")\r\n          .style(\"display\", \"initial\")\r\n          .classed(\"hasarrow\", true);\r\n\r\n        d3.selectAll(\".tut-drop-graphics-wrapper .objective-label\").style(\r\n          \"display\",\r\n          \"none\"\r\n        );\r\n\r\n        deps.setVariationInterpers(deps.objectiveVariationInterpers);\r\n\r\n        // scen labels\r\n        d3.selectAll(\".var-scen-label\").style(\"display\", \"block\");\r\n\r\n        // quantiles\r\n\r\n        d3.selectAll(\".var-scen-label\").style(\"opacity\", \"1\");\r\n\r\n        d3.select(\".main-waterdrop\")\r\n          .transition()\r\n          .style(\"transform\", \"translateY(100px) scale(0.5)\");\r\n        // undo scaling of label due to shrinking div\r\n        d3.select(\".main-waterdrop .var-scen-label\")\r\n          .transition()\r\n          .style(\"transform\", \"scale(2)\");\r\n\r\n        d3.select(\".main-histogram\").style(\"display\", \"initial\");\r\n        d3.selectAll(\".vardrop .dot-histogram-wrapper\").style(\r\n          \"display\",\r\n          \"initial\"\r\n        );\r\n      },\r\n      undo: function () {\r\n        // quantiles\r\n        d3.select(\".main-waterdrop\").transition().style(\"transform\", \"none\");\r\n        // undo scaling of label due to shrinking div\r\n        d3.select(\".main-waterdrop .var-scen-label\")\r\n          .transition()\r\n          .style(\"transform\", \"scale(1)\");\r\n\r\n        d3.select(\".main-histogram\").style(\"display\", \"none\");\r\n        d3.selectAll(\".vardrop .dot-histogram-wrapper\").style(\r\n          \"display\",\r\n          \"none\"\r\n        );\r\n\r\n        // scen labels\r\n        d3.selectAll(\".var-scen-label\").style(\"display\", \"none\");\r\n\r\n        // vardrops\r\n        d3.selectAll(\".tut-drop-graphics-wrapper .objective-label\").style(\r\n          \"display\",\r\n          \"initial\"\r\n        );\r\n        d3.selectAll(\".vardrop\")\r\n          .style(\"display\", \"none\")\r\n          .classed(\"hasarrow\", false);\r\n\r\n        deps.setVariationInterpers(\r\n          constants.VARIATIONS.map(() => d3.scaleLinear().range([0, 0]))\r\n        );\r\n      },\r\n    };\r\n  }\r\n\r\n  return {\r\n    initChartAnimGroup,\r\n    initBucketsFillAnim,\r\n    initDropFillAnim,\r\n    initShowVariationsAnim,\r\n  };\r\n}\r\n\r\nexport const animations = initAllAnims();\r\n","import { useCallback, useEffect, useState } from \"react\";\r\nimport { animations as anims } from \"./data-story-anims\";\r\n\r\nexport function useDataStory(deps, objective, normalized) {\r\n  /*\r\n    slides = [\r\n        name: string,\r\n        animHandler: {\r\n            do: someFunctionToDoAnimation,\r\n            undo: someFunctionToReverseAnimation,\r\n        }\r\n    ]\r\n     */\r\n  const [slides, setSlides] = useState([]);\r\n\r\n  useEffect(\r\n    function initialize() {\r\n      if (deps.readyHash === 0) return;\r\n\r\n      const context = { deps, objective, normalized };\r\n\r\n      const chartAnimGroup = anims.initChartAnimGroup(context);\r\n      const bucketsFillAnim = anims.initBucketsFillAnim(context);\r\n      const dropFillAnim = anims.initDropFillAnim(context);\r\n      const showVariationsAnim = anims.initShowVariationsAnim(context);\r\n\r\n      const _slides = [\r\n        {\r\n          name: \"barsAppear\",\r\n          animHandler: chartAnimGroup.barsAppear,\r\n          text: \"Bar Graph\",\r\n        },\r\n        {\r\n          name: \"barsCondense\",\r\n          animHandler: chartAnimGroup.barsCondense,\r\n          text: \"Gradient\",\r\n        },\r\n        {\r\n          name: \"bucketsFill\",\r\n          animHandler: bucketsFillAnim,\r\n          text: \"Bucket\",\r\n        },\r\n        {\r\n          name: \"forNowLetsFocus\",\r\n          animHandler: dropFillAnim,\r\n          text: \"Waterdrop\",\r\n        },\r\n        {\r\n          name: \"ifChangeReality\",\r\n          animHandler: showVariationsAnim,\r\n          text: \"Different Scenarios\",\r\n        },\r\n      ];\r\n\r\n      setSlides(_slides);\r\n    },\r\n    [deps.readyHash]\r\n  );\r\n\r\n  return slides;\r\n}\r\n","import * as d3 from \"d3\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nimport { ticksExact } from \"bucket-lib/utils\";\r\nimport {\r\n  DELIV_KEY_STRING,\r\n  SCENARIO_KEY_STRING,\r\n  objectivesData,\r\n} from \"data/completeObjectivesData\";\r\nimport { constants } from \"./constants\";\r\nimport { percentToRatioFilled } from \"utils/common\";\r\n\r\nexport default function useTutorialState(objective, normalized) {\r\n  const [readyHash, setReadyHash] = useState(0);\r\n  const [maxDelivs, setMaxDelivs] = useState(0);\r\n  const [minDelivs, setMinDelivs] = useState(0);\r\n\r\n  const [bucketInterper, setBucketInterper] = useState(() =>\r\n    d3.scaleLinear().range([0, 0])\r\n  );\r\n  const [dropInterper, setDropInterper] = useState(() =>\r\n    d3.scaleLinear().range([0, 0])\r\n  );\r\n  const [objectiveInterper, setObjectiveInterper] = useState(() =>\r\n    d3.scaleLinear().range([0, 0])\r\n  );\r\n  const [objectiveInterperDrop, setObjectiveInterperDrop] = useState(() =>\r\n    d3.scaleLinear().range([0, 0])\r\n  );\r\n\r\n  const [variationInterpers, setVariationInterpers] = useState(() =>\r\n    constants.VARIATIONS.map(() => d3.scaleLinear().range([0, 0]))\r\n  );\r\n\r\n  const [objectiveDelivs, setObjectiveDelivs] = useState(() => []);\r\n  const [objectiveVariationDelivs, setObjectiveVariationDelivs] = useState(() =>\r\n    constants.VARIATIONS.map(() => [])\r\n  );\r\n  const [objectiveVariationInterpers, setObjectiveVariationInterpers] =\r\n    useState(() =>\r\n      constants.VARIATIONS.map(() => d3.scaleLinear().range([0, 0]))\r\n    );\r\n\r\n  useEffect(() => {\r\n    setBucketInterper(() => d3.scaleLinear().range([0, 0]));\r\n    setDropInterper(() => d3.scaleLinear().range([0, 0]));\r\n    setVariationInterpers(() =>\r\n      constants.VARIATIONS.map(() => d3.scaleLinear().range([0, 0]))\r\n    );\r\n\r\n    const objDelivs =\r\n      objectivesData[objective][SCENARIO_KEY_STRING][\r\n        constants.BASELINE_SCENARIO\r\n      ][DELIV_KEY_STRING];\r\n    let maxDelivs, minDelivs;\r\n\r\n    maxDelivs =\r\n      objective === \"NDO\" ? d3.quantile(objDelivs, 0.75) : d3.max(objDelivs);\r\n\r\n    if (normalized) {\r\n      const allScenMins = [\r\n        constants.BASELINE_SCENARIO,\r\n        ...constants.VARIATIONS.map(({ scen_str }) => scen_str),\r\n      ].map((scen_str) =>\r\n        d3.min(\r\n          objectivesData[objective][SCENARIO_KEY_STRING][scen_str][\r\n            DELIV_KEY_STRING\r\n          ]\r\n        )\r\n      );\r\n      minDelivs = d3.min(allScenMins);\r\n    } else {\r\n      minDelivs = 0;\r\n    }\r\n\r\n    setMaxDelivs(maxDelivs);\r\n    setMinDelivs(minDelivs);\r\n\r\n    setObjectiveDelivs(() => objDelivs);\r\n\r\n    const objectiveInterperBucket = d3\r\n      .scaleLinear()\r\n      .domain(ticksExact(0, 1, objDelivs.length))\r\n      .range(\r\n        objDelivs\r\n          .map((v) => (v - minDelivs) / (maxDelivs - minDelivs))\r\n          .sort((a, b) => a - b)\r\n          .reverse()\r\n      )\r\n      .clamp(true);\r\n\r\n    const objectiveInterperDrop = (val) =>\r\n      percentToRatioFilled(\r\n        d3\r\n          .scaleLinear()\r\n          .domain(ticksExact(0, 1, objDelivs.length))\r\n          .range(\r\n            objDelivs\r\n              .map((v) => (v - minDelivs) / (maxDelivs - minDelivs))\r\n              .sort((a, b) => a - b)\r\n              .reverse()\r\n          )\r\n          .clamp(true)(val)\r\n      );\r\n\r\n    setObjectiveInterper(() => objectiveInterperBucket);\r\n    setObjectiveInterperDrop(() => objectiveInterperDrop);\r\n\r\n    const varDelivsArr = constants.VARIATIONS.map(\r\n      ({ scen_str }) =>\r\n        objectivesData[objective][SCENARIO_KEY_STRING][scen_str][\r\n          DELIV_KEY_STRING\r\n        ]\r\n    );\r\n\r\n    const objVars = varDelivsArr.map(\r\n      (varDelivs) => (val) =>\r\n        percentToRatioFilled(\r\n          d3\r\n            .scaleLinear()\r\n            .domain(ticksExact(0, 1, varDelivs.length))\r\n            .range(\r\n              varDelivs\r\n                .map((v) => (v - minDelivs) / (maxDelivs - minDelivs))\r\n                .sort((a, b) => a - b)\r\n                .reverse()\r\n            )\r\n            .clamp(true)(val)\r\n        )\r\n    );\r\n\r\n    setObjectiveVariationDelivs(() => varDelivsArr);\r\n    setObjectiveVariationInterpers(() => objVars);\r\n  }, [objective, normalized]);\r\n\r\n  return {\r\n    readyHash,\r\n    setReadyHash,\r\n    maxDelivs,\r\n    minDelivs,\r\n    bucketInterper,\r\n    setBucketInterper,\r\n    dropInterper,\r\n    setDropInterper,\r\n    variationInterpers,\r\n    setVariationInterpers,\r\n    objectiveDelivs,\r\n    objectiveInterper,\r\n    objectiveInterperDrop,\r\n    objectiveVariationDelivs,\r\n    objectiveVariationInterpers,\r\n  };\r\n}\r\n"],"names":["ExplanationAnimApp","curObjective","setCurObjective","useState","constants","DEFAULT_OBJECTIVE","normalized","setNormalized","tutorialState","useTutorialState","slides","useDataStory","useEffect","hideElems","setReadyHash","rh","_jsxs","className","children","_jsx","Selector","val","setVal","options","Object","keys","SELECTED_OBJS","map","objId","display_name","Toggle","label","DataStoryGraphics","DataStoryTexts","_ref","maxDelivs","minDelivs","mainHistData","useMemo","data","objectiveDelivs","domain","variations","VARIATIONS","variation","interper","variationInterpers","idx","histData","objectiveVariationDelivs","_Fragment","BucketConstructionGraphics","bucketInterper","ScenarioComparingGraphics","mainDropInterper","dropInterper","_ref2","DataStoryScrollama","cleanupFn","i","length","_slides$i$animHandler","animHandler","undo","slide","Step","Slide","_ref3","value","onChange","e","target","_ref4","option","_ref5","htmlFor","checked","type","name","id","_ref6","MainScenarioInfo","VariationScenarioPanel","_ref7","DropletGlyph","levelInterp","width","height","BAR_CHART_HEIGHT","colorInterp","INTERP_COLOR","resolution","BUCKET_RES","DotHistogram","_ref8","clas","desc","concat","_ref9","BucketGlyph","_ref10","Scrollama","offset","onStepEnter","async","_data$animHandler","direction","_ref11","do","onStepExit","_data$animHandler2","_ref12","ReturnToTop","forwardRef","_ref13","ref","text","_ref14","style","marginBottom","onClick","window","scrollTo","SCENARIO_KEY_STRING","DELIV_KEY_STRING","DELIV_KEY_STRING_UNORD","objectivesData","objs","fetch","json","obj","scen","Array","from","sort","a","b","mapBy","console","log","values","NUM_CIRCLES","MARGIN","top","right","bottom","left","WATERDROP_ICON","draw","context","size","moveTo","lineTo","arc","Math","SQRT2","PI","closePath","d3","svgSelector","useRef","circles","quantileBins","dataRange","x","range","y","current","selectAll","remove","attr","append","call","scale","tickFormat","s","svgCircles","select","join","enter","d","extendVarObj","scen_num_str","scen_str","BAR_CHART_WIDTH","interpolateWatercolorBlue","BASELINE_SCENARIO","DEL_NOD_AG_TOTAL","DEL_SJV_AG_TOTAL","DEL_NOD_MI_TOTAL","DEL_SJV_MI_TOTAL","DEL_SOCAL_MI_TOTAL","CVP_SWP_EXPORTS","NDO","SAC_IN","SJR_IN","STO_NOD_TOTAL","STO_SOD_TOTAL","initAllAnims","initChartAnimGroup","_XInterp","_XAxis","_dataDescending","_minDelivs","_maxDelivs","deps","objective","BAR_CHART_MARGIN","svgGroup","delivs","dataDescending","placeFromLeft","year","padding","xaxis","tickSize","tickValues","filter","_","prepareSVG","barsAppear","bandwidth","transition","duration","delay","barsCondense","newWidth","bars","end","catch","then","initBucketsFillAnim","setBucketInterper","objectiveInterper","initDropFillAnim","showElems","setDropInterper","objectiveInterperDrop","initShowVariationsAnim","classed","setVariationInterpers","objectiveVariationInterpers","animations","setSlides","readyHash","chartAnimGroup","anims","bucketsFillAnim","dropFillAnim","showVariationsAnim","_slides","setMaxDelivs","setMinDelivs","setObjectiveInterper","setObjectiveInterperDrop","setObjectiveDelivs","setObjectiveVariationDelivs","setObjectiveVariationInterpers","objDelivs","allScenMins","objectiveInterperBucket","ticksExact","v","reverse","clamp","percentToRatioFilled","varDelivsArr","objVars","varDelivs"],"sourceRoot":""}