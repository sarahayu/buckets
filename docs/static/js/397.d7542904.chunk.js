"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[397],{397:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.r(t),a.d(t,{default:()=>_});a(760);var n=a(43),s=a(999),i=a(111),l=a(135),c=a(146),o=a(823),p=a(394),d=a(569),u=a(323),m=a(579),A=e([d,u]);function _(){const[e,t]=(0,n.useState)(o.A.DEFAULT_OBJECTIVE),[a,r]=(0,n.useState)(!1),s=(0,u.A)(e,a),i=(0,d.R)(s,e,a);return(0,n.useEffect)((function(){(0,p.f2)(".bucket-wrapper, .vardrop, .var-scen-label, .vardrop .dot-histogram-wrapper, .main-histogram, .tut-drop-graphics-wrapper"),s.setReadyHash((e=>e+1))}),[e,a]),(0,m.jsxs)("div",{className:"tutorial-view",children:[(0,m.jsx)(g,{val:e,setVal:t,options:Object.keys(o.A.SELECTED_OBJS).map((e=>({options:e,display_name:o.A.SELECTED_OBJS[e]})))}),(0,m.jsx)(f,{label:"normalize across scenarios",val:a,setVal:r}),(0,m.jsxs)("div",{className:"scrollama scrollama-1",children:[(0,m.jsx)(v,{curObjective:e,normalized:a,tutorialState:s}),(0,m.jsx)(T,{slides:i})]})]})}function v(e){let{curObjective:t,tutorialState:a}=e;const{maxDelivs:r,minDelivs:s}=a,i=(0,n.useMemo)((()=>({data:a.objectiveDelivs,domain:[s,r]})),[a.objectiveDelivs]),l=(0,n.useMemo)((()=>o.A.VARIATIONS.map((e=>({...e,interper:a.variationInterpers[e.idx],histData:{data:a.objectiveVariationDelivs[e.idx],domain:[s,r]}})))),[a.objectiveVariationDelivs,a.variationInterpers]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(I,{label:o.A.SELECTED_OBJS[t],bucketInterper:a.bucketInterper}),(0,m.jsx)(x,{label:o.A.SELECTED_OBJS[t],mainDropInterper:a.dropInterper,mainHistData:i,variations:l})]})}function T(e){let{slides:t}=e;return(0,m.jsx)(j,{cleanupFn:()=>{for(let a=t.length-1;a>=0;a--){var e;null===(e=t[a].animHandler)||void 0===e||e.undo()}},children:t.map(((e,t)=>(0,m.jsx)(s.p,{data:e,children:(0,m.jsx)(R,{slide:e})},t)))})}function g(e){let{val:t,setVal:a,options:r}=e;return(0,m.jsx)("select",{value:t,onChange:e=>a(e.target.value),children:r.map(((e,t)=>{let{option:a,display_name:r}=e;return(0,m.jsx)("option",{value:a,children:r},t)}))})}function f(e){let{label:t,val:a,setVal:r}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("label",{htmlFor:"normalize",children:t}),(0,m.jsx)("input",{checked:a,onChange:e=>r(e.target.checked),type:"checkbox",name:"normalize",id:"normalize"})]})}function x(e){let{label:t,mainDropInterper:a,mainHistData:r,variations:n}=e;return(0,m.jsxs)("div",{className:"tut-drop-graphics-wrapper",children:[(0,m.jsx)(b,{dropInterper:a,histData:r,label:t}),n.map(((e,t)=>(0,m.jsx)(y,{variation:e},t)))]})}function b(e){let{dropInterper:t,histData:a,label:r}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"main-waterdrop",children:(0,m.jsx)(c.A,{levelInterp:t,width:400,height:o.A.BAR_CHART_HEIGHT,colorInterp:o.A.INTERP_COLOR})}),(0,m.jsx)("div",{className:"main-histogram",children:(0,m.jsx)(l.A,{width:330,height:220,data:a.data,domain:a.domain})}),(0,m.jsx)("p",{className:"fancy-font objective-label",children:r})]})}function y(e){let{variation:t}=e;const{idx:a,clas:r,desc:n,interper:s,histData:i}=t;return(0,m.jsxs)("div",{className:"vardrop ".concat(r),desc:n,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)(c.A,{levelInterp:s,width:200,height:o.A.BAR_CHART_HEIGHT/2,colorInterp:o.A.INTERP_COLOR}),(0,m.jsx)(l.A,{width:330,height:220,data:i.data,domain:i.domain})]}),(0,m.jsx)("p",{className:"var-scen-label",children:n})]},a)}function I(e){let{label:t,bucketInterper:a}=e;return(0,m.jsx)("div",{className:"tut-graph-wrapper",children:(0,m.jsxs)("div",{className:"tut-graph",children:[(0,m.jsx)("svg",{id:"pag-bar-graph"}),(0,m.jsx)(i.A,{levelInterp:a,width:300,height:o.A.BAR_CHART_HEIGHT,colorInterp:o.A.INTERP_COLOR}),(0,m.jsx)("p",{className:"fancy-font objective-label",children:t})]})})}function j(e){let{cleanupFn:t,children:a}=e;return(0,m.jsxs)(s.h,{offset:.9,onStepEnter:async e=>{var t;let{data:a,direction:r}=e;"up"!==r&&(null===(t=a.animHandler)||void 0===t||t.do())},onStepExit:async e=>{var t;let{data:a,direction:r}=e;"down"!==r&&(null===(t=a.animHandler)||void 0===t||t.undo())},children:[a,(0,m.jsx)(s.p,{data:{},children:(0,m.jsx)(H,{cleanupFn:t})},"last")]})}[d,u]=A.then?(await A)():A;const R=(0,n.forwardRef)((function(e,t){let{slide:a}=e;return(0,m.jsx)("div",{ref:t,className:"tut-text-card",children:a.text})})),H=(0,n.forwardRef)((function(e,t){let{cleanupFn:a}=e;return(0,m.jsx)("div",{ref:t,className:"tut-text-card",style:{marginBottom:"40vh"},children:(0,m.jsx)("button",{onClick:()=>{window.scrollTo(0,0),a()},children:"Back to Top"})})}));r()}catch(h){r(h)}}))},554:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.d(t,{Vk:()=>i,Zl:()=>l,jx:()=>o});var n=a(343),s=e([n]);n=(s.then?(await s)():s)[0];const i="scens",l="delivs",c="delivs_unord",o=await async function(){const e=await(await fetch("./select_complete_objectives.json")).json();for(const t of e){for(const e of t[i])e[c]=Array.from(e[l]),e[l]=Array.from(e[l]).sort(((e,t)=>t-e));t[i]=(0,n.Et)(t[i],(e=>{let{name:t}=e;return t}))}return console.log("DATA: loading objectives data"),(0,n.Et)(e,(e=>{let{obj:t}=e;return t}))}();Object.keys(o),Object.keys(Object.values(o)[0][i]);r()}catch(i){r(i)}}),1)},823:(e,t,a)=>{a.d(t,{A:()=>n});a(760);function r(e,t){let{scen_num_str:a,desc:r}=e;return{idx:t,scen_num_str:a,desc:r,scen_str:"expl".concat(a),clas:"drop".concat(t+1)}}const n={BAR_CHART_WIDTH:500,BAR_CHART_HEIGHT:400,INTERP_COLOR:a(684).YW,DEFAULT_OBJECTIVE:"DEL_NOD_AG_TOTAL",BASELINE_SCENARIO:"expl0000",VARIATIONS:[{scen_num_str:"0004",desc:"natural flows"},{scen_num_str:"0015",desc:"reduce delta regs."},{scen_num_str:"0320",desc:"prioritize carryover"},{scen_num_str:"0360",desc:"municipal priority"},{scen_num_str:"0261",desc:"rebalancing"}].map(r),SELECTED_OBJS:{DEL_NOD_AG_TOTAL:"DEL_NOD_AG_TOTAL",DEL_SJV_AG_TOTAL:"DEL_SJV_AG_TOTAL",DEL_NOD_MI_TOTAL:"DEL_NOD_MI_TOTAL",DEL_SJV_MI_TOTAL:"DEL_SJV_MI_TOTAL",DEL_SOCAL_MI_TOTAL:"DEL_SOCAL_MI_TOTAL",CVP_SWP_EXPORTS:"CVP_SWP_EXPORTS",NDO:"NDO",SAC_IN:"SAC_IN",SJR_IN:"SJR_IN",STO_NOD_TOTAL:"STO_NOD_TOTAL",STO_SOD_TOTAL:"STO_SOD_TOTAL"}}},479:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.d(t,{W:()=>A});var n=a(760),s=a(554),i=a(823),l=a(394),c=a(63),o=(a(684),a(343)),p=e([s,c,o]);[s,c,o]=p.then?(await p)():p;const u="expl0000";function m(){return{initChartAnimGroup:function(e){let t,a,r,l,o,{deps:p,objective:d,normalized:m}=e;const A=40,h=30,_=40,v=60;return function(){{n.select("#pag-bar-graph > *").remove();const e=n.select("#pag-bar-graph").attr("width",i.A.BAR_CHART_WIDTH+v+h).attr("height",i.A.BAR_CHART_HEIGHT+A+_).attr("opacity",1).append("g").attr("class","svg-group").attr("transform","translate(".concat(v,",").concat(A,")")),m=s.jx[d][c.Vk][u][c.sQ];o=p.maxDelivs,l=p.minDelivs;const T=m.map(((e,t)=>({val:e,placeFromLeft:t,year:t+1}))).sort(((e,t)=>t.val-e.val)),g=n.scaleBand().domain(T.map((e=>{let{year:t}=e;return t})).sort(((e,t)=>e-t))).range([0,i.A.BAR_CHART_WIDTH]).padding(.4),f=n.scaleLinear().domain([l,o]).range([i.A.BAR_CHART_HEIGHT,0]),x=n.axisBottom(g).tickSize(0).tickFormat((e=>"year ".concat(e))).tickValues(g.domain().filter(((e,t)=>0===t||(t+1)%10===0)));e.append("g").attr("class","anim-xaxis"),e.append("g").attr("class","axis-y"),e.select(".anim-xaxis").attr("opacity",1).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT,")")).call(x).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),e.select(".axis-y").call(n.axisLeft(f).tickFormat(n.format(".2s"))).append("text").text("Deliveries (TAF)").attr("fill","black").attr("font-weight","bold").attr("transform","translate(-50, ".concat(i.A.BAR_CHART_HEIGHT/2,") rotate(-90)")),t=g,a=x,r=T}}(),{barsAppear:{do:function(){{const e=n.scaleLinear().domain([l,o]).range([i.A.BAR_CHART_HEIGHT,0]);n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(r,(e=>e.placeFromLeft)).join("rect").attr("class","bars").attr("x",(e=>t(e.year))).attr("y",i.A.BAR_CHART_HEIGHT).attr("width",t.bandwidth()).attr("height",0).attr("opacity",1).attr("fill","steelblue").transition().duration(500).delay((e=>10*e.placeFromLeft)).attr("y",(t=>e(t.val))).attr("height",(t=>i.A.BAR_CHART_HEIGHT-e(t.val)))}},undo:function(){n.select("#pag-bar-graph .svg-group").selectAll(".bars").data(r,(e=>e.placeFromLeft)).transition().duration(500).delay((e=>10*(r.length-e.placeFromLeft-1))).attr("y",i.A.BAR_CHART_HEIGHT).attr("height",0)}},barsCondense:{do:async function(){{const e=i.A.BAR_CHART_WIDTH/8,t=n.select("#pag-bar-graph .svg-group");t.select(".anim-xaxis").call(a.tickFormat(""));const s=t.selectAll(".bars");s.style("mix-blend-mode","multiply").transition().duration(500).attr("opacity",.05).transition().delay((e=>100+1e3*(1-(1-e.placeFromLeft/r.length)**4))).duration(500).attr("width",e).attr("x",i.A.BAR_CHART_WIDTH/2-e/2).end().catch((()=>{})).then((()=>{t.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT+50,")")).attr("opacity",0),s.transition().delay(500).attr("x",0),t.transition().delay(500).attr("transform","translate(".concat(v+i.A.BAR_CHART_WIDTH/2-e/2,",").concat(A,")"))}))}},undo:function(){{const e=n.select("#pag-bar-graph .svg-group"),s=e.selectAll(".bars");e.select(".anim-xaxis").transition().transition(500).attr("transform","translate(0, ".concat(i.A.BAR_CHART_HEIGHT,")")).attr("opacity",1),e.select(".anim-xaxis").call(a.tickFormat((e=>"year ".concat(e)))),e.transition().delay(500).attr("transform","translate(".concat(v,",").concat(A,")")),s.transition().delay((e=>100+1e3*(1-(e.placeFromLeft/r.length)**4))).duration(500).attr("x",(e=>t(e.year))).attr("width",t.bandwidth()).transition().duration(500).attr("opacity",1).end().catch((()=>{})).then((()=>{s.style("mix-blend-mode","normal")}))}}}}},initBucketsFillAnim:function(e){let{deps:t,objective:a}=e;return{do:function(){n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","initial"),n.select("#pag-bar-graph").attr("opacity",0),t.setBucketInterper((()=>t.objectiveInterper))},undo:function(){t.setBucketInterper((()=>n.scaleLinear().range([0,0]))),n.selectAll(".tut-graph-wrapper .bucket-wrapper").style("display","none"),n.select("#pag-bar-graph").transition().attr("opacity",1)}}},initDropFillAnim:function(e){let{deps:t,objective:a}=e;return{do:function(){(0,l.YB)(".main-waterdrop"),(0,l.YB)(".tut-drop-graphics-wrapper",n,"grid"),(0,l.f2)(".tut-graph-wrapper, .bucket-wrapper"),t.setDropInterper((()=>t.objectiveInterperDrop))},undo:function(){(0,l.f2)(".tut-drop-graphics-wrapper, .main-waterdrop"),(0,l.YB)(".bucket-wrapper"),(0,l.YB)(".tut-graph-wrapper",n,"flex"),t.setDropInterper((()=>n.scaleLinear().range([0,0])))}}},initShowVariationsAnim:function(e){let{deps:t}=e;return{do:function(){n.selectAll(".vardrop").style("display","initial").classed("hasarrow",!0),n.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","none"),t.setVariationInterpers(t.objectiveVariationInterpers),n.selectAll(".var-scen-label").style("display","block"),n.selectAll(".var-scen-label").style("opacity","1"),n.select(".main-waterdrop").transition().style("transform","translateY(100px) scale(0.5)"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(2)"),n.select(".main-histogram").style("display","initial"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","initial")},undo:function(){n.select(".main-waterdrop").transition().style("transform","none"),n.select(".main-waterdrop .var-scen-label").transition().style("transform","scale(1)"),n.select(".main-histogram").style("display","none"),n.selectAll(".vardrop .dot-histogram-wrapper").style("display","none"),n.selectAll(".var-scen-label").style("display","none"),n.selectAll(".tut-drop-graphics-wrapper .objective-label").style("display","initial"),n.selectAll(".vardrop").style("display","none").classed("hasarrow",!1),t.setVariationInterpers(i.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0]))))}}}}}const A=m();r()}catch(d){r(d)}}))},569:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.d(t,{R:()=>c});var n=a(43),s=a(479),i=e([s]);function c(e,t,a){const[r,i]=(0,n.useState)([]);return(0,n.useEffect)((function(){if(0===e.readyHash)return;const r={deps:e,objective:t,normalized:a},n=s.W.initChartAnimGroup(r),l=s.W.initBucketsFillAnim(r),c=s.W.initDropFillAnim(r),o=s.W.initShowVariationsAnim(r),p=[{name:"barsAppear",animHandler:n.barsAppear,text:"Bar Graph"},{name:"barsCondense",animHandler:n.barsCondense,text:"Gradient"},{name:"bucketsFill",animHandler:l,text:"Bucket"},{name:"forNowLetsFocus",animHandler:c,text:"Waterdrop"},{name:"ifChangeReality",animHandler:o,text:"Different Scenarios"}];i(p)}),[e.readyHash]),r}s=(i.then?(await i)():i)[0],r()}catch(l){r(l)}}))},323:(e,t,a)=>{a.a(e,(async(e,r)=>{try{a.d(t,{A:()=>u});var n=a(760),s=a(43),i=a(684),l=a(554),c=a(823),o=a(343),p=e([l,o]);function u(e,t){const[a,r]=(0,s.useState)(0),[p,d]=(0,s.useState)(0),[u,m]=(0,s.useState)(0),[A,h]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[_,v]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[T,g]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[f,x]=(0,s.useState)((()=>n.scaleLinear().range([0,0]))),[b,y]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0]))))),[I,j]=(0,s.useState)((()=>[])),[R,H]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>[])))),[E,L]=(0,s.useState)((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0])))));return(0,s.useEffect)((()=>{h((()=>n.scaleLinear().range([0,0]))),v((()=>n.scaleLinear().range([0,0]))),y((()=>c.A.VARIATIONS.map((()=>n.scaleLinear().range([0,0])))));const a=l.jx[e][l.Vk][c.A.BASELINE_SCENARIO][l.Zl];let r,s;if(r="NDO"===e?n.quantile(a,.75):n.max(a),t){const t=[c.A.BASELINE_SCENARIO,...c.A.VARIATIONS.map((e=>{let{scen_str:t}=e;return t}))].map((t=>n.min(l.jx[e][l.Vk][t][l.Zl])));s=n.min(t)}else s=0;d(r),m(s),j((()=>a));const p=n.scaleLinear().domain((0,i.kd)(0,1,a.length)).range(a.map((e=>(e-s)/(r-s))).sort().reverse()).clamp(!0),u=e=>(0,o.si)(n.scaleLinear().domain((0,i.kd)(0,1,a.length)).range(a.map((e=>(e-s)/(r-s))).sort().reverse()).clamp(!0)(e));g((()=>p)),x((()=>u));const A=c.A.VARIATIONS.map((t=>{let{scen_str:a}=t;return l.jx[e][l.Vk][a][l.Zl]})),_=A.map((e=>t=>(0,o.si)(n.scaleLinear().domain((0,i.kd)(0,1,e.length)).range(e.map((e=>(e-s)/(r-s))).sort().reverse()).clamp(!0)(t))));H((()=>A)),L((()=>_))}),[e,t]),{readyHash:a,setReadyHash:r,maxDelivs:p,minDelivs:u,bucketInterper:A,setBucketInterper:h,dropInterper:_,setDropInterper:v,variationInterpers:b,setVariationInterpers:y,objectiveDelivs:I,objectiveInterper:T,objectiveInterperDrop:f,objectiveVariationDelivs:R,objectiveVariationInterpers:E}}[l,o]=p.then?(await p)():p,r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=397.d7542904.chunk.js.map