"use strict";(self.webpackChunkbuckets=self.webpackChunkbuckets||[]).push([[230],{230:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n.d(e,{default:()=>k});var o=n(668),s=n(981),a=n(43),c=n(684),i=n(63),l=n(829),h=n(579),u=t([i,l]);[i,l]=u.then?(await u)():u;const f=5,p=3,m=.1,g=2,v=1,y=1.5,b=3,x=1.3/(1+Math.SQRT1_2);function k(){const t=(0,a.useRef)(),[e,n]=(0,a.useState)({style:{}}),r=(0,a.useRef)(),u=(0,a.useRef)(),[d,p,m]=(0,l.iJ)("objective"),{current:v}=(0,a.useRef)(i.Xe.filter(((t,e)=>e%g===0))),y=(0,a.useRef)(),k=(0,a.useRef)(),P="objective"===d?i.iL:v,S="objective"===d?v:i.iL;y.current=P,k.current=S;const R=(0,a.useRef)(),[Z,T,Y]=(0,l.iJ)(),z=(0,a.useRef)(),[O]=(0,a.useState)((()=>{const t=new s.Z58;return t.background=new s.Q1f(15724527),t})),E=(0,a.useRef)();(0,a.useRef)({});return(0,a.useEffect)((()=>{t.current={width:window.innerWidth,height:window.innerHeight};const e=t.current.width,n=t.current.height;u.current.attr("width",e).attr("height",n).call((t=>{t.append("rect").attr("width",e).attr("height",n).attr("stroke","none").attr("fill","transparent")})).append("g").attr("class","svg-trans");const a=new s.JeP({antialias:!0});a.setSize(e,n),document.querySelector("#mosaic-area").appendChild(a.domElement);const c=new l.i7({fov:160,near:1,far:100,width:e,height:n,domElement:o.Ltv(".bubbles-wrapper").node(),zoomFn:t=>{u.current.select(".svg-trans").attr("transform",t.transform),r.current&&(r.current.opacity=o.m4Y().domain([1,5]).range([.1,1]).clamp(!0)(t.transform.k),r.current.needsUpdate=!0)}});a.setAnimationLoop((()=>{if(a.render(O,c.camera),!Y.current)return;if(z.current.getElapsedTime()>b)return void T(null);const t=E.current.geometry;j(t,R.current,Y.current,o.IOm(z.current.getElapsedTime()/b)),t.verticesNeedUpdate=!0}))}),[]),(0,a.useEffect)((()=>{const t=R.current,e={};if("objective"===d)for(let o=0;o<P.length;o++){const t=P[o],n={};for(let e=0;e<S.length;e++){const r=S[e],o=(0,l.cv)(t,r,i.jx,i.pk);n[r]=(0,c.kd)(0,1,f+1).map((t=>o(t)))}e[t]=n}else if("scenario"===d)for(let o=0;o<P.length;o++){const t=P[o],n={};for(let e=0;e<S.length;e++){const r=S[e],o=(0,l.cv)(r,t,i.jx,i.pk);n[r]=(0,c.kd)(0,1,f+1).map((t=>o(t)))}e[t]=n}const n=w(e);t&&T(M(n,t)),R.current=n,z.current=new s.zD7;const r=C(n);u.current.select(".svg-trans").selectAll(".largeDrop").attr("display","none"),O.remove(...O.children),O.add(r),E.current=r,R.current=n}),[d]),(0,a.useEffect)((()=>{if(Y.current)return;const t=R.current,{dropsMesh:e,lineMesh:s}=L(t);O.add(e,s),O.remove(E.current),r.current=s.material,u.current.select(".svg-trans").selectAll(".largeDrop").data(t.nodes).join((t=>t.append("g").attr("class","largeDrop").call((t=>{t.append("path").attr("d",l.js).attr("fill","none").attr("stroke","transparent").attr("vector-effect","non-scaling-stroke").attr("stroke-width",1)})))).attr("display","initial").attr("transform",(e=>{let{x:n,y:r}=e;return"translate(".concat(n,", ").concat(r,") scale(").concat(t.height*x,")")})).on("mouseenter",(function(t,e){o.Ltv(this).select("path").attr("stroke","lightgray"),n((t=>({...t,text:e.key})))})).on("mousemove",(function(t,e){n((e=>({...e,style:{display:"block",left:t.x,top:t.y}})))})).on("mouseleave",(function(){n((t=>({...t,style:{display:"none"}}))),o.Ltv(this).select("path").attr("stroke","transparent")}))}),[d,Z]),(0,h.jsxs)("div",{className:"bubbles-wrapper",children:[(0,h.jsxs)("div",{className:"bubbles-input-area",onChange:t=>{p(t.target.value)},children:[(0,h.jsx)("input",{type:"radio",name:"grouping",value:"objective",id:"objective",checked:"objective"===d}),(0,h.jsx)("label",{htmlFor:"objective",children:"objective"}),(0,h.jsx)("input",{type:"radio",name:"grouping",value:"scenario",id:"scenario",checked:"scenario"===d}),(0,h.jsx)("label",{htmlFor:"scenario",children:"scenario"})]}),(0,h.jsx)("div",{className:"bubbles-tooltip",style:e.style,children:e.text}),(0,h.jsx)("div",{id:"mosaic-area"}),(0,h.jsx)("svg",{className:"mosaic-overlay",ref:t=>u.current=o.Ltv(t)})]})}function w(t){const e=Object.keys(t),n=Object.keys(Object.values(t)[0]),r=(e.length,n.length),o=Math.max(1,Math.sqrt(r/Math.PI)*p*2*v*y),s=Math.max(2,p*v),a=(0,l.hh)(0,0,e.map((()=>({r:o})))),c=(0,l.hh)(0,0,n.map((()=>({r:s})))),i={},h={};return{nodes:e.map(((e,r)=>{i[e]=r;return{nodes:n.map(((n,o)=>{h[n]=o;const s=t[e][n].map(((t,e)=>Math.max(t,0==e?m:0)*p));return{levs:s,maxLev:p,domLev:P(s),tilt:50*Math.random()-25,dur:100*Math.random()+400,x:c[o].x,y:c[o].y,group:e,key:n,globalX:a[r].x+c[o].x,globalY:a[r].y+c[o].y}})),x:a[r].x,y:a[r].y,tilt:50*Math.random()-25,key:e}})),height:c.height,pLookup:i,sLookup:h}}function M(t,e){const n={};for(const r of Object.keys(t.pLookup)){const o={};for(const n of Object.keys(e.pLookup)){let{globalX:s,globalY:a}=t.nodes[t.pLookup[r]].nodes[t.sLookup[n]],{globalX:c,globalY:i}=e.nodes[e.pLookup[n]].nodes[e.sLookup[r]];o[n]=[c-s,i-a]}n[r]=o}return n}function j(t,e,n,r){let o=0;r=1-r;for(let s=0;s<e.nodes.length;s++){const a=e.nodes[s].nodes,c=e.nodes[s].key;for(let e=0;e<a.length;e++){const{globalX:s,globalY:i,key:l}=a[e],[h,u]=n[c][l];t.vertices[o].setX(s+r*h),t.vertices[o].setY(-(i+r*u)),o++}}}function L(t){const e=new l.u,n=[],r=(0,l.bp)(0,1,.975*p);for(let o=0;o<t.nodes.length;o++){const a=t.nodes[o].nodes;for(let t=0;t<a.length;t++){const{globalX:o,globalY:i,levs:h,maxLev:u}=a[t];for(let n=h.length-1;n>=0;n--){const r=n!==h.length-1?h[n+1]:0,a=h[n],d=(0,l.Ng)(r/u,a/u,p),m=new s.Q1f((0,c.YW)(n/f));e.addMeshCoords(d,{x:o,y:-i},m,t%5/50+.001)}n.push(...r.map((e=>{let[n,r]=e;return new s.Pq0(o+n,-i-r,t%5/50)})))}}return{dropsMesh:new s.eaF(e.threeGeom,new s.V9B({vertexColors:s.vCm})),lineMesh:new s.DXC((new s.LoY).setFromPoints(n),new s.mrM({color:13421772,transparent:!0,opacity:0}))}}function C(t){const e=new s.V23;for(let r=0;r<t.nodes.length;r++){const n=t.nodes[r].nodes;for(let t=0;t<n.length;t++){const{globalX:r,globalY:o,levs:a,domLev:i}=n[t],l=i>0?(0,c.YW)(i):"white";e.vertices.push(new s.Pq0(r,-o,.002)),e.colors.push(new s.Q1f(l))}}const n=new s.BH$({size:.4,sizeAttenuation:!0,vertexColors:s.vCm,map:(new s.Tap).load("drop.png"),transparent:!0});return new s.ONl(e,n)}function P(t){t=[1,...t,0];let e=0;for(let n=0;n<t.length-1;n++){e+=(t[n]-t[n+1])*(n-1)/(f+4)}return e}r()}catch(d){r(d)}}))},684:(t,e,n)=>{n.d(e,{Q2:()=>c,YW:()=>l,ZC:()=>i,kd:()=>s,wh:()=>a});var r=n(668),o=n(43);function s(t,e,n){return r.y17(n).map((r=>r/(n-1)*(e-t)+t))}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,s=t*o+t*(1-o)/2,a=t*(1-o)/2,c=[{x:r.GWP(s,t)(n),y:r.GWP(e,0)(n)},{x:s,y:e},{x:a,y:e},{x:r.GWP(a,0)(n),y:r.GWP(e,0)(n)}];return r.n8j().x((function(t){return t.x})).y((function(t){return t.y}))(c)+"z"}function c(t,e,n){let o=t.map((t=>Math.round(t.length/e))),s=r.czq(o);for(;s>n;)o[r.z94(t,((t,n)=>0!==t.length?t.length/e-o[n]:1/0))]-=1,s=r.czq(o);for(;s<n;)o[r.P2Z(t,((t,n)=>0!==t.length?t.length/e-o[n]:-1/0))]+=1,s=r.czq(o);return o}function i(t,e){const n=(0,o.useRef)({value:t,prev:null}),r=n.current.value;return(e?e(t,r):t===r)||(n.current={value:t,prev:r}),n.current.prev}const l=t=>r.dM(r.m4Y([.2,1])(t))},63:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{Vk:()=>c,Xe:()=>d,Zl:()=>i,iL:()=>u,jx:()=>h,pk:()=>a,sQ:()=>l});var o=n(829),s=t([o]);o=(s.then?(await s)():s)[0];const a=1200,c="scens",i="delivs",l="delivs_unord",h=await async function(){const t=await(await fetch("./all_objectives.json")).json();for(const e of t){e[c]=e[c];for(const t of e[c]){const e=t[i].map((t=>Math.min(Math.max(0,t),a)));t[l]=e,t[i]=Array.from(e).sort(((t,e)=>e-t))}e[c]=(0,o.Et)(e[c],(t=>{let{name:e}=t;return e}))}return console.log("DATA: loading objectives data"),(0,o.Et)(t,(t=>{let{obj:e}=t;return e}))}(),u=Object.keys(h),d=Object.keys(Object.values(h)[0][c]);r()}catch(a){r(a)}}),1)},829:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{C5:()=>C,Et:()=>f,Ng:()=>L,XC:()=>p,Yb:()=>B,bp:()=>j,cv:()=>q,hh:()=>V,i7:()=>I,iJ:()=>G,js:()=>m,nC:()=>F,u:()=>X,xC:()=>P});var o=n(981),s=n(668),a=n(783),c=n.n(a),i=n(43),l=n(63),h=n(684),u=t([l]);function f(t,e){const n=Object.groupBy(t,e);for(const r of Object.keys(n))n[r]=n[r][0];return n}l=(u.then?(await u)():u)[0];const p={draw:function(t,e){t.moveTo(0,-e/2),t.lineTo(e/4,-e/4),t.arc(0,0,e/Math.SQRT2/2,-Math.PI/4,5*Math.PI/4),t.lineTo(0,-e/2),t.closePath()}},m="M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z";const g=Math.SQRT1_2,v=1,y=g+g,b=v+g,x=.75;function k(t){if(t>=x){return Math.SQRT1_2*(1-t)/(1-x)}const e=2*(1-t/(y/b))-1,n=Math.acos(e);return Math.sin(n)}function w(t){return(t-g/b)*(1+Math.SQRT2)}function M(t){return t/(1+Math.SQRT2)+g/b}function j(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/v*g,o=.1,s=[],a=[];let c,i,l,h;for(let m=1;m<=Math.ceil(10)&&(c=k(t+(m-1)*o),i=w(t+(m-1)*o),l=k(t+m*o),h=w(t+m*o),!(M(h)>=e));m++){const t=[-c*r,-i*r],e=[c*r,-i*r],n=[l*r,-h*r],o=[-l*r,-h*r];s.push(e,n),a.push(t,o)}l=k(e),h=w(e);const u=[-c*r,-i*r],d=[c*r,-i*r],f=[l*r,-h*r],p=[-l*r,-h*r];return s.push(d,f),a.push(u,p),s.push(...a.reverse()),s}function L(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Math.abs(t-e)<.01)return[];const r=n/2/v*g,o=.1,s=[];let a,c,i,l;for(let p=1;p<=Math.ceil(10)&&(a=k(t+(p-1)*o),c=w(t+(p-1)*o),i=k(t+p*o),l=w(t+p*o),!(M(l)>=e));p++){const t=[-a*r,-c*r],e=[a*r,-c*r],n=[i*r,-l*r],o=[-i*r,-l*r];s.push([t,e,n]),s.push([t,n,o])}i=k(e),l=w(e);const h=[-a*r,-c*r],u=[a*r,-c*r],d=[i*r,-l*r],f=[-i*r,-l*r];return s.push([h,u,d]),s.push([h,d,f]),s}function C(t,e){return function(n){return e.map((function(e){return[e,s.i2o(n,(function(n){return t(e-n)}))]}))}}function P(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function S(t){const e=t/2,n=3*Math.PI/2/16,r=[{x:Math.cos(5*Math.PI/4)*e,y:Math.sin(5*Math.PI/4)*e},{x:0,y:-Math.SQRT2*e}];for(let o=0;o<=16;o++)r.push({x:Math.cos(o*n-Math.PI/4)*e,y:Math.sin(o*n-Math.PI/4)*e});return r}function R(t,e){const n=c().Bounds.create(t),r=n.min.x,o=n.max.x,a=n.min.y,i=n.max.y,l=s.m4Y([r,o]),h=s.m4Y([a,i]),u=[];for(let s=0;s<e;s++)for(;;){const e=l(Math.random()),n=h(Math.random());if(c().Vertices.contains(t,{x:e,y:n})){u.push([e,n]);break}}return u}const Z=function(){const t=S(3),e=S(1),n=[];for(let r=0;r<t.length-2;r++)n.push([t[r],t[r+(r<2?1:2)],e[r+(r<2?1:2)],e[r]]);return n}();let T,Y,z,O;function E(t){const e=s.czq(t.map((t=>t**2*3.14)));return Math.floor(2*Math.sqrt(e/3.14)/2)}function V(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&z&&n.length===O)return z;T&&n.length===Y||(T=s.y17(4).map((()=>R(S(1),Y=n.length))));const o=E(n.map((t=>{let{r:e}=t;return e}))),a=T[Math.floor(Math.random()*T.length)].map((t=>{let[e,n]=t;return[e*o,n*o]})),i=c().Engine,l=c().Bodies,h=c().Composite,u=i.create(),d=a.sort(((t,e)=>e[1]-t[1])),f=n.map(((t,e)=>{let{r:n,id:r}=t;const[o,s]=d[e];return l.circle(o,s,n,{restitution:0,id:r})})),p=Z.map((t=>c().Body.create({position:c().Vertices.centre(t),vertices:t,isStatic:!0}))),m=c().Body.create({isStatic:!0});c().Body.setParts(m,p),c().Body.setCentre(m,{x:0,y:0}),c().Body.scale(m,o,o),h.add(u.world,[...f,m]);for(let s=0,c=60,g=.1;s<c*g;s++)i.update(u,1e3/c);const v=f.map((n=>{let{position:r,id:o}=n;return{id:o,x:r.x+t,y:r.y+e}}));return v.height=o/2/g*b,!r||z&&v.length===O||(z=v,O=v.length),v}function F(t,e){const[n,r]=(0,i.useState)(t);return[(0,i.useMemo)((()=>e(n)),[n]),(0,i.useCallback)((t=>{r(e(t))}),[])]}function q(t,e,n,r){const o=n[t][l.Vk][e][l.Zl];return s.m4Y().domain((0,h.kd)(0,1,o.length)).range(o.map((t=>Math.min(1,t/r)))).clamp(!0)}function B(t,e,n){return"median"===t?Object.keys(e[n][l.Vk]).sort(((t,r)=>s.i2o(e[n][l.Vk][t][l.Zl])-s.i2o(e[n][l.Vk][r][l.Zl]))):"deliveries"===t?Object.keys(e[n][l.Vk]).sort(((t,r)=>s.T9B(e[n][l.Vk][t][l.Zl])-s.T9B(e[n][l.Vk][r][l.Zl]))):"alphabetical"===t?Object.keys(e[n][l.Vk]).sort():void 0}function Q(t){return t*Math.PI/180}class I{constructor(t){let{fov:e,near:n,far:r,width:a,height:c,domElement:i,zoomFn:l}=t;this.fov=e,this.near=n,this.far=r,this.width=a,this.height=c,this.camera=new o.ubm(e,a/c,n,r+1),this.camera.position.set(0,0,this.far),this.zoom=s.s_O().scaleExtent([this.getScaleFromZ(this.far),this.getScaleFromZ(this.near)]).on("zoom",(t=>{this.d3ZoomHandler(t),this.curTransform=t.transform,l&&l(t)})),this.view=s.Ltv(i),this.view.call(this.zoom),this.zoom.transform(this.view,s.GSI.translate(this.width/2,this.height/2).scale(this.getScaleFromZ(this.far)))}d3ZoomHandler(t){const e=t.transform.k,n=-(t.transform.x-this.width/2)/e,r=(t.transform.y-this.height/2)/e,o=this.getZFromScale(e);this.camera.position.set(n,r,o)}getScaleFromZ(t){const e=Q(this.fov/2),n=2*(Math.tan(e)*t);return this.height/n}getZFromScale(t){const e=Q(this.fov/2);return this.height/t/(2*Math.tan(e))}}class X{constructor(){this.threeGeom=new o.V23,this.idx=0}addMeshCoords(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=[];for(let a=0;a<t.length;a++){const[c,i,l]=t[a],h=new o.Pq0(e.x+c[0],e.y-c[1],r),u=new o.Pq0(e.x+i[0],e.y-i[1],r),d=new o.Pq0(e.x+l[0],e.y-l[1],r);this.threeGeom.vertices.push(h,u,d);const f=new o.nFj(3*this.idx+0,3*this.idx+1,3*this.idx+2);n&&(f.vertexColors.push(n),f.vertexColors.push(n),f.vertexColors.push(n)),this.threeGeom.faces.push(f),s.push(this.idx++)}return s}}function G(t){const[e,n]=(0,i.useState)(t),r=(0,i.useRef)(t);(0,i.useEffect)((()=>{r.current=e}),[e]);const o=(0,i.useCallback)((t=>{n(r.current=t)}),[]);return[e,o,r]}r()}catch(d){r(d)}}))}}]);
//# sourceMappingURL=230.dd23ae5c.chunk.js.map