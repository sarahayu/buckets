{"version":3,"file":"static/js/687.2ce67955.chunk.js","mappings":"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","sources":["bucket-lib/BucketGlyph.jsx","bucket-lib/bucket-glyph.js","bucket-lib/quantile-bins.js","bucket-lib/utils.js","data/objectivesData.jsx","utils/common.js"],"sourcesContent":["import * as d3 from \"d3\";\r\nimport { useLayoutEffect, useRef } from \"react\";\r\n\r\nimport {\r\n  bucketGlyph,\r\n  bucketShape,\r\n  drawBucketMask,\r\n  drawBucketOutline,\r\n  transitionSway,\r\n} from \"./bucket-glyph\";\r\nimport { interpolateWatercolorBlue, ticksExact } from \"./utils\";\r\n\r\nconst LEVELS = 10;\r\n\r\nexport default function BucketGlyph({\r\n  levelInterp,\r\n  colorInterp = interpolateWatercolorBlue,\r\n  width = 200,\r\n  height = 400,\r\n  resolution = LEVELS,\r\n}) {\r\n  const LINE_WIDTH = 3;\r\n  const innerWidth = width - LINE_WIDTH * 2;\r\n  const innerHeight = height - LINE_WIDTH;\r\n\r\n  const svgElement = useRef();\r\n\r\n  useLayoutEffect(function initialize() {\r\n    const svgContainer = svgElement.current\r\n      .attr(\"width\", width)\r\n      .attr(\"height\", height)\r\n      .append(\"g\")\r\n      .attr(\"class\", \"bucket\")\r\n      .attr(\"transform\", `translate(${LINE_WIDTH}, ${LINE_WIDTH / 2})`);\r\n\r\n    svgContainer.call(\r\n      bucketShape(innerWidth, innerHeight, drawBucketMask, drawBucketOutline)\r\n    );\r\n  }, []);\r\n\r\n  useLayoutEffect(\r\n    function onDataChange() {\r\n      const liquidLevels = ticksExact(0, 1, resolution + 1).map((d) =>\r\n        levelInterp(d)\r\n      );\r\n\r\n      const glyph = bucketGlyph(innerWidth, innerHeight);\r\n\r\n      const liquids = svgElement.current\r\n        .select(\".graph-area\")\r\n        .selectAll(\".bucket-box\")\r\n        .data(glyph(liquidLevels))\r\n        .join(\"rect\")\r\n        .attr(\"class\", \"bucket-box\")\r\n        .attr(\"width\", (d) => d.width)\r\n        .attr(\"height\", (d) => d.height)\r\n        .attr(\"x\", (d) => d.x)\r\n        .attr(\"fill\", (_, i) => colorInterp(i / resolution));\r\n\r\n      transitionSway(liquids, 200 / height).attr(\"y\", (d) => d.y);\r\n    },\r\n    [levelInterp]\r\n  );\r\n\r\n  return (\r\n    <div className=\"bucket-wrapper\">\r\n      <svg ref={(e) => void (svgElement.current = d3.select(e))}></svg>\r\n    </div>\r\n  );\r\n}\r\n","import * as d3 from \"d3\";\r\n\r\nconst DEGREE_SWAY = 40;\r\nconst LINE_WIDTH = 3;\r\n\r\nlet maskCounter = 0;\r\n\r\n// ensures every mask id is unique\r\nfunction getMaskId() {\r\n  return maskCounter++;\r\n}\r\n\r\nfunction bucketGlyph(width, height, valueToLevelFn = d3.scaleLinear()) {\r\n  return function (data) {\r\n    return data.map((d) => ({\r\n      x: -width,\r\n      y: height - valueToLevelFn(d) * height - height / 2,\r\n      width: width * 2,\r\n      height: height * 2,\r\n    }));\r\n  };\r\n}\r\n\r\nfunction transitionSway(rects, multiplier = 1) {\r\n  // save previous value; we'll need it to calculate how much to sway between renders\r\n  rects.each(function (d) {\r\n    const s = d3.select(this);\r\n    const prevLevel = s.attr(\"cur-level\") || 0;\r\n\r\n    s.attr(\"prev-level\", prevLevel);\r\n    s.attr(\"cur-level\", d.y);\r\n  });\r\n\r\n  rects\r\n    .transition(\"liquidSway\")\r\n    .duration(2000)\r\n    .delay((_, i) => i * 10)\r\n    .ease(d3.easeQuad)\r\n    .attrTween(\"transform\", function (d, i) {\r\n      const s = d3.select(this);\r\n      const prevLiquidLevel = parseFloat(s.attr(\"prev-level\"));\r\n      const diff = (Math.abs(prevLiquidLevel - d.y) / 200) * multiplier;\r\n      return (t) =>\r\n        `rotate(${\r\n          Math.sin(\r\n            Math.min((Math.PI * 4 * t) / (0.5 * diff + 0.5), Math.PI * 4)\r\n          ) *\r\n          diff *\r\n          DEGREE_SWAY *\r\n          (1 - t)\r\n        }, ${0}, ${0})`;\r\n    });\r\n\r\n  const levelTransition = rects\r\n    .transition(\"liquidLevel\")\r\n    .ease(d3.easeElasticOut.period(0.6))\r\n    .delay((_, i) => i * (100 / rects.size()))\r\n    .duration(1000);\r\n\r\n  return levelTransition;\r\n}\r\n\r\nfunction bucketShape(\r\n  width,\r\n  height,\r\n  shapeFunc = drawBucketMask,\r\n  shapeOutlineFunc = shapeFunc\r\n) {\r\n  return function (s) {\r\n    const id = getMaskId();\r\n\r\n    s.append(\"defs\")\r\n      .attr(\"class\", \"clip-def\")\r\n      .append(\"clipPath\")\r\n      .attr(\"id\", \"bucket-mask-\" + id)\r\n      .append(\"path\")\r\n      .attr(\"class\", \"bucket-mask-path\");\r\n\r\n    s.append(\"g\")\r\n      .attr(\"class\", \"graph-area\")\r\n      .attr(\"transform\", `translate(${width / 2}, ${height / 2})`)\r\n      .attr(\"clip-path\", `url(#bucket-mask-${id})`);\r\n\r\n    s.append(\"path\")\r\n      .attr(\"class\", \"bucket-outline\")\r\n      .attr(\"transform\", `translate(${width / 2}, ${height / 2})`)\r\n      .attr(\"stroke\", \"lightgray\")\r\n      .attr(\"stroke-linecap\", \"round\")\r\n      .attr(\"stroke-width\", LINE_WIDTH)\r\n      .attr(\"fill\", \"none\");\r\n\r\n    s.call(\r\n      bucketShapeMask({\r\n        drawFunc: shapeFunc,\r\n        drawOutlineFunc: shapeOutlineFunc,\r\n        width,\r\n        height,\r\n      })\r\n    );\r\n  };\r\n}\r\n\r\nfunction bucketShapeMask({\r\n  drawFunc,\r\n  drawOutlineFunc = drawFunc,\r\n  width,\r\n  height,\r\n}) {\r\n  return function (s) {\r\n    const getPath = (fn) => {\r\n      const path = d3.path();\r\n      fn(path, width, height);\r\n      return path.toString();\r\n    };\r\n\r\n    s.select(\".bucket-mask-path\").attr(\"d\", getPath(drawFunc));\r\n    s.select(\".bucket-outline\").attr(\"d\", getPath(drawOutlineFunc));\r\n  };\r\n}\r\n\r\nfunction drawBucketMask(context, width, height) {\r\n  drawBucket(context, width, height, true);\r\n}\r\n\r\nfunction drawBucketOutline(context, width, height) {\r\n  drawBucket(context, width, height, false);\r\n}\r\n\r\nfunction drawBucket(context, width, height, closed) {\r\n  const taper = 0.8;\r\n  const bottomRight = (width * taper) / 2,\r\n    bottomLeft = -(width * taper) / 2;\r\n\r\n  context.moveTo(width / 2, -height / 2);\r\n  context.lineTo(bottomRight, height / 2);\r\n  context.lineTo(bottomLeft, height / 2);\r\n  context.lineTo(-width / 2, -height / 2);\r\n\r\n  if (closed) context.closePath();\r\n}\r\n\r\nfunction drawDroplet(context, width, height) {\r\n  const hypToRad = Math.SQRT2;\r\n\r\n  // dimensions in \"rad\" units\r\n  const dropHeight = 1 + 1 * hypToRad;\r\n\r\n  const radToHeight = 1 / dropHeight;\r\n\r\n  const rad = Math.min(width / 2, height * radToHeight);\r\n  const hyp = rad / (1 / hypToRad);\r\n  const heightActual = rad + hyp;\r\n\r\n  context.moveTo(0, -heightActual / 2);\r\n  context.lineTo(hyp / 2, -heightActual / 2 + hyp / 2);\r\n  context.arc(0, -heightActual / 2 + hyp, rad, -Math.PI / 4, (Math.PI * 5) / 4);\r\n  context.closePath();\r\n}\r\n\r\nexport {\r\n  bucketGlyph,\r\n  transitionSway,\r\n  bucketShape,\r\n  bucketShapeMask,\r\n  drawBucketMask,\r\n  drawBucketOutline,\r\n  drawDroplet,\r\n};\r\n","import * as d3 from \"d3\";\r\nimport { distributeQuantiles } from \"./utils\";\r\n\r\n// inclusive\r\nfunction ticksExact(start, stop, count) {\r\n  return d3.range(count).map((i) => (i / (count - 1)) * (stop - start) + start);\r\n}\r\n\r\nfunction quantileBins(\r\n  width,\r\n  height,\r\n  unitsPerQuantile = undefined,\r\n  range = undefined\r\n) {\r\n  return function (data) {\r\n    unitsPerQuantile = unitsPerQuantile || 1;\r\n    range = range || d3.extent(data);\r\n\r\n    const numQuantiles = data.length / unitsPerQuantile;\r\n    const histBins = d3\r\n      .bin()\r\n      .value((d) => d)\r\n      .domain(range)\r\n      .thresholds(\r\n        ticksExact(...range, Math.ceil(width / (height / numQuantiles)))\r\n      )(data);\r\n\r\n    const binnedQuantiles = distributeQuantiles(\r\n      histBins,\r\n      unitsPerQuantile,\r\n      numQuantiles\r\n    );\r\n\r\n    const quantiles = [];\r\n\r\n    for (let b = 0; b < binnedQuantiles.length; b++) {\r\n      for (let y = 0; y < binnedQuantiles[b]; y++) {\r\n        quantiles.push([\r\n          (histBins[b].x1 + histBins[b].x0) / 2,\r\n          ((y + 0.5) / numQuantiles) * data.length,\r\n        ]);\r\n      }\r\n    }\r\n\r\n    return quantiles;\r\n  };\r\n}\r\n\r\nexport { quantileBins };\r\n","import * as d3 from \"d3\";\r\nimport { drawBucketMask } from \"./bucket-glyph\";\r\n\r\nfunction distributeQuantiles(numericBins, unitsPerQuantile, maxQuantiles) {\r\n  let quantileBins = numericBins.map((bin) =>\r\n    Math.round(bin.length / unitsPerQuantile)\r\n  );\r\n  let sum = d3.sum(quantileBins);\r\n\r\n  while (sum > maxQuantiles) {\r\n    quantileBins[\r\n      d3.minIndex(numericBins, (d, i) =>\r\n        d.length !== 0\r\n          ? d.length / unitsPerQuantile - quantileBins[i]\r\n          : Infinity\r\n      )\r\n    ] -= 1;\r\n\r\n    sum = d3.sum(quantileBins);\r\n  }\r\n\r\n  while (sum < maxQuantiles) {\r\n    quantileBins[\r\n      d3.maxIndex(numericBins, (d, i) =>\r\n        d.length !== 0\r\n          ? d.length / unitsPerQuantile - quantileBins[i]\r\n          : -Infinity\r\n      )\r\n    ] += 1;\r\n\r\n    sum = d3.sum(quantileBins);\r\n  }\r\n\r\n  return quantileBins;\r\n}\r\n\r\nconst interpolateWatercolorBlue = (i) =>\r\n  d3.interpolateBlues(d3.scaleLinear([0.2, 1.0])(i));\r\n\r\nfunction levelToDropletLevel(p) {\r\n  p -= 0.0088;\r\n  return Math.min(\r\n    1,\r\n    Math.max(\r\n      0,\r\n      (3.1304 * p ** 3 - 4.2384 * p ** 2 + 3.3471 * p + 0.0298) / 2.2326\r\n    )\r\n  );\r\n}\r\n\r\nconst WATERDROP_ICON = {\r\n  draw: function (context, size) {\r\n    context.moveTo(0, -size / 2);\r\n    context.lineTo(size / 4, -size / 4);\r\n\r\n    context.arc(0, 0, size / Math.SQRT2 / 2, -Math.PI / 4, (Math.PI * 5) / 4);\r\n    context.lineTo(0, -size / 2);\r\n    context.closePath();\r\n  },\r\n};\r\n\r\nfunction ticksExact(start, stop, count) {\r\n  return d3.range(count).map((i) => (i / (count - 1)) * (stop - start) + start);\r\n}\r\n\r\nfunction bucketPath(width, height, filled = 1.0, taper = 0.8) {\r\n  const getPath = (fn) => {\r\n    const path = d3.path();\r\n    fn(path, width, height);\r\n    return path.toString();\r\n  };\r\n\r\n  return getPath(drawBucketMask);\r\n}\r\n\r\nexport {\r\n  distributeQuantiles,\r\n  interpolateWatercolorBlue,\r\n  levelToDropletLevel,\r\n  WATERDROP_ICON,\r\n  ticksExact,\r\n  bucketPath,\r\n};\r\n","import { mapBy } from \"utils/common\";\r\n\r\nexport const MAX_DELIVS = 1200;\r\nexport const SCENARIO_KEY_STRING = \"scens\";\r\nexport const DELIV_KEY_STRING = \"delivs\";\r\nexport const DELIV_KEY_STRING_UNORD = \"delivs_unord\";\r\n\r\nexport const objectivesData = await (async function () {\r\n  const objs = await (await fetch(\"./all_objectives.json\")).json();\r\n\r\n  for (const obj of objs) {\r\n    obj[SCENARIO_KEY_STRING] = obj[SCENARIO_KEY_STRING];\r\n    for (const scen of obj[SCENARIO_KEY_STRING]) {\r\n      // data cleanup, clamping\r\n      const unord = scen[DELIV_KEY_STRING].map((v) =>\r\n        Math.min(Math.max(0, v), MAX_DELIVS)\r\n      );\r\n\r\n      scen[DELIV_KEY_STRING_UNORD] = unord;\r\n      scen[DELIV_KEY_STRING] = Array.from(unord).sort((a, b) => b - a);\r\n    }\r\n    obj[SCENARIO_KEY_STRING] = mapBy(\r\n      obj[SCENARIO_KEY_STRING],\r\n      ({ name }) => name\r\n    );\r\n  }\r\n\r\n  console.log(\"DATA: loading objectives data\");\r\n\r\n  return mapBy(objs, ({ obj }) => obj);\r\n})();\r\n\r\nexport const objectiveIDs = Object.keys(objectivesData);\r\nexport const scenarioIDs = Object.keys(\r\n  Object.values(objectivesData)[0][SCENARIO_KEY_STRING]\r\n);\r\n","import * as THREE from \"three\";\r\nimport * as d3 from \"d3\";\r\nimport Matter from \"matter-js\";\r\nimport {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { DELIV_KEY_STRING, SCENARIO_KEY_STRING } from \"data/objectivesData\";\r\nimport { ticksExact } from \"bucket-lib/utils\";\r\n\r\nexport function clamp(x, a, b) {\r\n  return Math.max(a, Math.min(b, x));\r\n}\r\n\r\n// when fn is `({ name }) => name`, turns\r\n//\r\n//  [\r\n//    { name: \"Zeta\", age: 30 },\r\n//    { name: \"Aloy\", age: 40 },\r\n//  ];\r\n//\r\n// to\r\n//\r\n//  {\r\n//    \"Zeta\": { name: \"Zeta\", age: 30 },\r\n//    \"Aloy\": { name: \"Aloy\", age: 40 },\r\n//  };\r\nexport function mapBy(objs, fn) {\r\n  const newObjs = Object.groupBy(objs, fn);\r\n\r\n  for (const key of Object.keys(newObjs)) {\r\n    newObjs[key] = newObjs[key][0];\r\n  }\r\n\r\n  return newObjs;\r\n}\r\n\r\n// size is height of waterdrop plus a bit more (1/2 of size is distance from top of drop to center of circle part)\r\nexport const WATERDROP_ICON = {\r\n  draw: function (context, size) {\r\n    context.moveTo(0, -size / 2);\r\n    context.lineTo(size / 4, -size / 4);\r\n\r\n    context.arc(0, 0, size / Math.SQRT2 / 2, -Math.PI / 4, (Math.PI * 5) / 4);\r\n    context.lineTo(0, -size / 2);\r\n    context.closePath();\r\n  },\r\n};\r\n\r\n// path generated when WATERDROP_ICON size = 2\r\nexport const DROPLET_SHAPE = \"M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z\";\r\n\r\nexport function percentToRatioFilled(p) {\r\n  p -= 0.0088;\r\n  return Math.min(\r\n    1,\r\n    Math.max(\r\n      0,\r\n      (3.1304 * p ** 3 - 4.2384 * p ** 2 + 3.3471 * p + 0.0298) / 2.2326\r\n    )\r\n  );\r\n}\r\n\r\nconst CIRC_RAD = Math.SQRT1_2;\r\nconst DROP_RAD = 1;\r\nconst CIRC_HEIGHT = CIRC_RAD + CIRC_RAD;\r\nconst DROP_HEIGHT = DROP_RAD + CIRC_RAD;\r\nconst HAT_START = 0.75;\r\n\r\n// half width at widest is 1\r\nfunction yToHalfWidth(y) {\r\n  if (y >= HAT_START) {\r\n    const hatHalfWidth = Math.SQRT1_2;\r\n\r\n    return (hatHalfWidth * (1 - y)) / (1 - HAT_START);\r\n  }\r\n\r\n  const circFrac = fracDropToCirc(y);\r\n  const trigX = (1 - circFrac) * 2 - 1;\r\n\r\n  const angle = Math.acos(trigX);\r\n  const trigY = Math.sin(angle);\r\n\r\n  return trigY;\r\n}\r\n\r\n// fml, here sprite width is 2 (i.e. circ rad is 1) thus drop real height is 1 + sqrt2\r\nfunction yToSpriteY(y) {\r\n  return (y - CIRC_RAD / DROP_HEIGHT) * (1 + Math.SQRT2);\r\n}\r\n\r\nfunction spriteYToY(sy) {\r\n  return sy / (1 + Math.SQRT2) + CIRC_RAD / DROP_HEIGHT;\r\n}\r\n\r\nfunction fracCircToDrop(v) {\r\n  return v / CIRC_HEIGHT / DROP_HEIGHT;\r\n}\r\n\r\nfunction fracDropToCirc(v) {\r\n  return v / (CIRC_HEIGHT / DROP_HEIGHT);\r\n}\r\n\r\nexport function waterdropDeltaOutline(yStart, yEnd, size = 2) {\r\n  if (Math.abs(yStart - yEnd) < 0.01) return [];\r\n\r\n  const rad = (size / 2 / DROP_RAD) * CIRC_RAD;\r\n\r\n  const Y_DELTA = 0.1;\r\n\r\n  const rightCoords = [];\r\n  const leftCoords = [];\r\n\r\n  let dx1, dy1, dx2, dy2;\r\n\r\n  for (let i = 1; i <= Math.ceil(1 / Y_DELTA); i++) {\r\n    dx1 = yToHalfWidth(yStart + (i - 1) * Y_DELTA);\r\n    dy1 = yToSpriteY(yStart + (i - 1) * Y_DELTA);\r\n    dx2 = yToHalfWidth(yStart + i * Y_DELTA);\r\n    dy2 = yToSpriteY(yStart + i * Y_DELTA);\r\n\r\n    if (spriteYToY(dy2) >= yEnd) break;\r\n\r\n    // CC !\r\n    const v1 = [-dx1 * rad, -dy1 * rad],\r\n      v2 = [dx1 * rad, -dy1 * rad],\r\n      v3 = [dx2 * rad, -dy2 * rad],\r\n      v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n    rightCoords.push(v2, v3);\r\n    leftCoords.push(v1, v4);\r\n  }\r\n\r\n  dx2 = yToHalfWidth(yEnd);\r\n  dy2 = yToSpriteY(yEnd);\r\n\r\n  // CC !\r\n  const v1 = [-dx1 * rad, -dy1 * rad],\r\n    v2 = [dx1 * rad, -dy1 * rad],\r\n    v3 = [dx2 * rad, -dy2 * rad],\r\n    v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n  rightCoords.push(v2, v3);\r\n  leftCoords.push(v1, v4);\r\n\r\n  rightCoords.push(...leftCoords.reverse());\r\n\r\n  return rightCoords;\r\n}\r\n\r\nexport function waterdropDelta(yStart, yEnd, size = 2) {\r\n  if (Math.abs(yStart - yEnd) < 0.01) return [];\r\n\r\n  const rad = (size / 2 / DROP_RAD) * CIRC_RAD;\r\n\r\n  const Y_DELTA = 0.1;\r\n\r\n  const coords = [];\r\n\r\n  let dx1, dy1, dx2, dy2;\r\n\r\n  for (let i = 1; i <= Math.ceil(1 / Y_DELTA); i++) {\r\n    dx1 = yToHalfWidth(yStart + (i - 1) * Y_DELTA);\r\n    dy1 = yToSpriteY(yStart + (i - 1) * Y_DELTA);\r\n    dx2 = yToHalfWidth(yStart + i * Y_DELTA);\r\n    dy2 = yToSpriteY(yStart + i * Y_DELTA);\r\n\r\n    if (spriteYToY(dy2) >= yEnd) break;\r\n\r\n    // CC !\r\n    const v1 = [-dx1 * rad, -dy1 * rad],\r\n      v2 = [dx1 * rad, -dy1 * rad],\r\n      v3 = [dx2 * rad, -dy2 * rad],\r\n      v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n    coords.push([v1, v2, v3]);\r\n    coords.push([v1, v3, v4]);\r\n  }\r\n\r\n  dx2 = yToHalfWidth(yEnd);\r\n  dy2 = yToSpriteY(yEnd);\r\n\r\n  // CC !\r\n  const v1 = [-dx1 * rad, -dy1 * rad],\r\n    v2 = [dx1 * rad, -dy1 * rad],\r\n    v3 = [dx2 * rad, -dy2 * rad],\r\n    v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n  coords.push([v1, v2, v3]);\r\n  coords.push([v1, v3, v4]);\r\n\r\n  return coords;\r\n}\r\n\r\nexport function waterdrop(yFill, size = 2) {\r\n  if (yFill === 0) return [];\r\n\r\n  return waterdropDelta(0, yFill, size);\r\n}\r\n\r\nexport function kernelDensityEstimator(kernel, X) {\r\n  return function (V) {\r\n    return X.map(function (x) {\r\n      return [\r\n        x,\r\n        d3.mean(V, function (v) {\r\n          return kernel(x - v);\r\n        }),\r\n      ];\r\n    });\r\n  };\r\n}\r\n\r\nexport function kernelEpanechnikov(k) {\r\n  return function (v) {\r\n    return Math.abs((v /= k)) <= 1 ? (0.75 * (1 - v * v)) / k : 0;\r\n  };\r\n}\r\n\r\nfunction generateWaterdrop(width) {\r\n  const rad = width / 2;\r\n  const partitions = 16;\r\n  const delta = (Math.PI * 3) / 2 / partitions;\r\n\r\n  const outer = [\r\n    {\r\n      x: Math.cos((Math.PI * 5) / 4) * rad,\r\n      y: Math.sin((Math.PI * 5) / 4) * rad,\r\n    },\r\n    {\r\n      x: 0,\r\n      y: -Math.SQRT2 * rad,\r\n    },\r\n  ];\r\n\r\n  for (let i = 0; i <= partitions; i++) {\r\n    outer.push({\r\n      x: Math.cos(i * delta - Math.PI / 4) * rad,\r\n      y: Math.sin(i * delta - Math.PI / 4) * rad,\r\n    });\r\n  }\r\n\r\n  return outer;\r\n}\r\n\r\nexport function generateRandoPoints(shape, count) {\r\n  const bounds = Matter.Bounds.create(shape);\r\n\r\n  const minX = bounds.min.x,\r\n    maxX = bounds.max.x,\r\n    minY = bounds.min.y,\r\n    maxY = bounds.max.y;\r\n\r\n  const genX = d3.scaleLinear([minX, maxX]);\r\n  const genY = d3.scaleLinear([minY, maxY]);\r\n\r\n  const points = [];\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    while (true) {\r\n      const x = genX(Math.random());\r\n      const y = genY(Math.random());\r\n\r\n      if (Matter.Vertices.contains(shape, { x, y })) {\r\n        points.push([x, y]);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return points;\r\n}\r\n\r\n// inner diameter of 1\r\nexport const WATERDROP_CAGE_COORDS = (function () {\r\n  const outer = generateWaterdrop(3);\r\n  const inner = generateWaterdrop(1);\r\n\r\n  const coords = [];\r\n\r\n  for (let i = 0; i < outer.length - 2; i++) {\r\n    coords.push([\r\n      outer[i],\r\n      outer[i + (i < 2 ? 1 : 2)],\r\n      inner[i + (i < 2 ? 1 : 2)],\r\n      inner[i],\r\n    ]);\r\n  }\r\n\r\n  return coords;\r\n})();\r\n\r\nlet RANDO_CACHE;\r\nlet lastNodesLen;\r\n\r\nlet DET_CACHE;\r\nlet lastDetNodesLen;\r\n\r\nexport function radsToDropWidth(nodes) {\r\n  const AREA = d3.sum(nodes.map((r) => r ** 2 * 3.14));\r\n  return Math.floor((Math.sqrt(AREA / 3.14) * 2) / 2);\r\n}\r\n\r\n// assuming nodes is already ordered and first nodes are going to be put on the bottom\r\nexport function placeDropsUsingPhysics(x, y, nodes, reuse = false) {\r\n  if (reuse && DET_CACHE && nodes.length === lastDetNodesLen) return DET_CACHE;\r\n\r\n  // first generate random points within water droplet. we can stop here, but points might not be the most uniformly distributed\r\n\r\n  if (!RANDO_CACHE || nodes.length !== lastNodesLen)\r\n    RANDO_CACHE = d3\r\n      .range(4)\r\n      .map(() =>\r\n        generateRandoPoints(generateWaterdrop(1), (lastNodesLen = nodes.length))\r\n      );\r\n\r\n  const WIDTH_AREA = radsToDropWidth(nodes.map(({ r }) => r));\r\n\r\n  const randoPoints = RANDO_CACHE[\r\n    Math.floor(Math.random() * RANDO_CACHE.length)\r\n  ].map(([x, y]) => [x * WIDTH_AREA, y * WIDTH_AREA]);\r\n\r\n  // thus, we use physics engine to take care of distributing the points evenly and based on radius\r\n  const Engine = Matter.Engine,\r\n    Bodies = Matter.Bodies,\r\n    Composite = Matter.Composite;\r\n\r\n  const engine = Engine.create();\r\n\r\n  const nodePos = randoPoints.sort((a, b) => b[1] - a[1]);\r\n\r\n  const node_bodies = nodes.map(({ r, id }, i) => {\r\n    const [nx, ny] = nodePos[i];\r\n    return Bodies.circle(nx, ny, r, {\r\n      restitution: 0,\r\n      id: id,\r\n    });\r\n  });\r\n\r\n  const parts = WATERDROP_CAGE_COORDS.map((quad) =>\r\n    Matter.Body.create({\r\n      position: Matter.Vertices.centre(quad),\r\n      vertices: quad,\r\n      isStatic: true,\r\n    })\r\n  );\r\n\r\n  const cage = Matter.Body.create({\r\n    isStatic: true,\r\n  });\r\n\r\n  Matter.Body.setParts(cage, parts);\r\n\r\n  Matter.Body.setCentre(cage, { x: 0, y: 0 });\r\n  Matter.Body.scale(cage, WIDTH_AREA, WIDTH_AREA);\r\n\r\n  Composite.add(engine.world, [...node_bodies, cage]);\r\n\r\n  // run engine for SECS second at FPS fps\r\n  for (let i = 0, FPS = 60, SECS = 0.1; i < FPS * SECS; i++)\r\n    Engine.update(engine, 1000 / FPS);\r\n\r\n  const retVal = node_bodies.map(({ position, id }) => ({\r\n    id,\r\n    x: position.x + x,\r\n    y: position.y + y,\r\n  }));\r\n\r\n  retVal.height = (WIDTH_AREA / 2 / CIRC_RAD) * DROP_HEIGHT;\r\n\r\n  if (reuse && (!DET_CACHE || retVal.length !== lastDetNodesLen)) {\r\n    DET_CACHE = retVal;\r\n    lastDetNodesLen = retVal.length;\r\n  }\r\n\r\n  return retVal;\r\n}\r\n\r\n// https://gist.github.com/mbostock/5743979\r\nexport function bounce(h) {\r\n  if (!arguments.length) h = 0.25;\r\n  var b0 = 1 - h,\r\n    b1 = b0 * (1 - b0) + b0,\r\n    b2 = b0 * (1 - b1) + b1,\r\n    x0 = 2 * Math.sqrt(h),\r\n    x1 = x0 * Math.sqrt(h),\r\n    x2 = x1 * Math.sqrt(h),\r\n    t0 = 1 / (1 + x0 + x1 + x2),\r\n    t1 = t0 + t0 * x0,\r\n    t2 = t1 + t0 * x1,\r\n    m0 = t0 + (t0 * x0) / 2,\r\n    m1 = t1 + (t0 * x1) / 2,\r\n    m2 = t2 + (t0 * x2) / 2,\r\n    a = 1 / (t0 * t0);\r\n  return function (t) {\r\n    return t >= 1\r\n      ? 1\r\n      : t < t0\r\n      ? a * t * t\r\n      : t < t1\r\n      ? a * (t -= m0) * t + b0\r\n      : t < t2\r\n      ? a * (t -= m1) * t + b1\r\n      : a * (t -= m2) * t + b2;\r\n  };\r\n}\r\n\r\nexport function rangeInclusive(a, b) {\r\n  return d3.range(a, b + 1);\r\n}\r\n\r\nexport function useStickyScale(defaultVal, scale) {\r\n  const [val, setVal] = useState(defaultVal);\r\n\r\n  const valActual = useMemo(() => scale(val), [val]);\r\n  const setValActual = useCallback((v) => void setVal(scale(v)), []);\r\n\r\n  return [valActual, setValActual];\r\n}\r\n\r\nexport function createInterps(obj_name, scen_name, data, maxDelivs) {\r\n  const delivs =\r\n    data[obj_name][SCENARIO_KEY_STRING][scen_name][DELIV_KEY_STRING];\r\n  return d3\r\n    .scaleLinear()\r\n    .domain(ticksExact(0, 1, delivs.length))\r\n    .range(delivs.map((v) => Math.min(1, v / maxDelivs)))\r\n    .clamp(true);\r\n}\r\n\r\nexport function criteriaSort(criteria, data, objective) {\r\n  if (criteria === \"median\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort(\r\n      (a, b) =>\r\n        d3.mean(data[objective][SCENARIO_KEY_STRING][a][DELIV_KEY_STRING]) -\r\n        d3.mean(data[objective][SCENARIO_KEY_STRING][b][DELIV_KEY_STRING])\r\n    );\r\n  }\r\n  if (criteria === \"deliveries\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort(\r\n      (a, b) =>\r\n        d3.max(data[objective][SCENARIO_KEY_STRING][a][DELIV_KEY_STRING]) -\r\n        d3.max(data[objective][SCENARIO_KEY_STRING][b][DELIV_KEY_STRING])\r\n    );\r\n  }\r\n  if (criteria === \"alphabetical\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort();\r\n  }\r\n}\r\n\r\nfunction get(object, path, defaultValue) {\r\n  const parts = path.split(\".\");\r\n  for (let part of parts) {\r\n    if (!object) return defaultValue;\r\n    object = object[part];\r\n  }\r\n  return object ?? defaultValue;\r\n}\r\n\r\nfunction pick(fn) {\r\n  return typeof fn === \"string\" ? (v) => get(v, fn) : fn;\r\n}\r\n\r\nexport function sortBy(array, fn) {\r\n  fn = pick(fn);\r\n  return array.sort((a, b) => {\r\n    const va = fn(a);\r\n    const vb = fn(b);\r\n    if (va < vb) return -1;\r\n    if (va > vb) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nexport function toRadians(a) {\r\n  return (a * Math.PI) / 180;\r\n}\r\n\r\nexport class Camera {\r\n  fov;\r\n  near;\r\n  far;\r\n  width;\r\n  height;\r\n  camera;\r\n  zoom;\r\n  view;\r\n  curTransform;\r\n\r\n  raycaster = new THREE.Raycaster();\r\n\r\n  constructor({ fov, near, far, width, height, domElement, zoomFn }) {\r\n    this.fov = fov;\r\n    this.near = near;\r\n    this.far = far;\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      fov,\r\n      width / height,\r\n      near,\r\n      far + 1\r\n    );\r\n\r\n    this.camera.position.set(0, 0, this.far);\r\n\r\n    this.zoom = d3\r\n      .zoom()\r\n      .scaleExtent([\r\n        this.getScaleFromZ(this.far),\r\n        this.getScaleFromZ(this.near),\r\n      ])\r\n      .on(\"zoom\", (e) => {\r\n        this.d3ZoomHandler(e);\r\n        this.curTransform = e.transform;\r\n\r\n        zoomFn && zoomFn(e);\r\n      });\r\n\r\n    this.view = d3.select(domElement);\r\n    this.view.call(this.zoom);\r\n    this.zoom.transform(\r\n      this.view,\r\n      d3.zoomIdentity\r\n        .translate(this.width / 2, this.height / 2)\r\n        .scale(this.getScaleFromZ(this.far))\r\n    );\r\n  }\r\n\r\n  d3ZoomHandler(e) {\r\n    const scale = e.transform.k;\r\n    const x = -(e.transform.x - this.width / 2) / scale;\r\n    const y = (e.transform.y - this.height / 2) / scale;\r\n    const z = this.getZFromScale(scale);\r\n    this.camera.position.set(x, y, z);\r\n  }\r\n\r\n  getScaleFromZ(camera_z_position) {\r\n    const half_fov = this.fov / 2;\r\n    const half_fov_radians = toRadians(half_fov);\r\n    const half_fov_height = Math.tan(half_fov_radians) * camera_z_position;\r\n    const fov_height = half_fov_height * 2;\r\n    const scale = this.height / fov_height;\r\n    return scale;\r\n  }\r\n\r\n  getZFromScale(scale) {\r\n    const half_fov = this.fov / 2;\r\n    const half_fov_radians = toRadians(half_fov);\r\n    const scale_height = this.height / scale;\r\n    const camera_z_position = scale_height / (2 * Math.tan(half_fov_radians));\r\n    return camera_z_position;\r\n  }\r\n\r\n  intersectObject(mouseX, mouseY, mesh) {\r\n    this.raycaster.setFromCamera(\r\n      {\r\n        x: mouseX,\r\n        y: mouseY,\r\n      },\r\n      this.camera\r\n    );\r\n\r\n    return this.raycaster.intersectObject(mesh);\r\n  }\r\n}\r\n\r\nexport class MeshGeometry {\r\n  threeGeom = new THREE.Geometry();\r\n  idx = 0;\r\n\r\n  addMeshCoords(meshCoords, transform, color, z = 0) {\r\n    const indices = [];\r\n\r\n    for (let j = 0; j < meshCoords.length; j++) {\r\n      const [v1, v2, v3] = meshCoords[j];\r\n\r\n      const a = new THREE.Vector3(transform.x + v1[0], transform.y - v1[1], z);\r\n      const b = new THREE.Vector3(transform.x + v2[0], transform.y - v2[1], z);\r\n      const c = new THREE.Vector3(transform.x + v3[0], transform.y - v3[1], z);\r\n      this.threeGeom.vertices.push(a, b, c);\r\n\r\n      const face = new THREE.Face3(\r\n        this.idx * 3 + 0,\r\n        this.idx * 3 + 1,\r\n        this.idx * 3 + 2\r\n      );\r\n\r\n      if (color) {\r\n        face.vertexColors.push(color);\r\n        face.vertexColors.push(color);\r\n        face.vertexColors.push(color);\r\n      }\r\n\r\n      this.threeGeom.faces.push(face);\r\n\r\n      indices.push(this.idx++);\r\n    }\r\n\r\n    return indices;\r\n  }\r\n}\r\n\r\nexport function mouseToThree(mouseX, mouseY, width, height) {\r\n  return {\r\n    x: (mouseX / width) * 2 - 1,\r\n    y: -(mouseY / height) * 2 + 1,\r\n  };\r\n}\r\n\r\nexport function useStateRef(val) {\r\n  const [state, _setState] = useState(val);\r\n  const stateRef = useRef(val);\r\n\r\n  useEffect(() => void (stateRef.current = state), [state]);\r\n\r\n  const setState = useCallback((v) => {\r\n    _setState((stateRef.current = v));\r\n  }, []);\r\n\r\n  return [state, setState, stateRef];\r\n}\r\n"],"names":["LEVELS","BucketGlyph","_ref","levelInterp","colorInterp","interpolateWatercolorBlue","width","height","resolution","innerWidth","LINE_WIDTH","innerHeight","svgElement","useRef","useLayoutEffect","current","attr","append","concat","call","bucketShape","drawBucketMask","drawBucketOutline","liquidLevels","ticksExact","map","d","glyph","bucketGlyph","liquids","select","selectAll","data","join","x","_","i","transitionSway","y","_jsx","className","children","ref","e","d3","DEGREE_SWAY","maskCounter","valueToLevelFn","arguments","length","undefined","rects","multiplier","each","s","this","prevLevel","transition","duration","delay","ease","attrTween","prevLiquidLevel","parseFloat","diff","Math","abs","t","sin","min","PI","period","size","shapeFunc","shapeOutlineFunc","id","drawFunc","drawOutlineFunc","getPath","fn","path","toString","bucketShapeMask","context","drawBucket","closed","bottomRight","bottomLeft","moveTo","lineTo","closePath","drawDroplet","hypToRad","SQRT2","radToHeight","rad","hyp","heightActual","arc","quantileBins","unitsPerQuantile","range","numQuantiles","histBins","value","domain","thresholds","start","stop","count","ceil","binnedQuantiles","distributeQuantiles","quantiles","b","push","x1","x0","numericBins","maxQuantiles","bin","round","sum","Infinity","levelToDropletLevel","p","max","bucketPath","MAX_DELIVS","SCENARIO_KEY_STRING","DELIV_KEY_STRING","DELIV_KEY_STRING_UNORD","objectivesData","async","objs","fetch","json","obj","scen","unord","v","Array","from","sort","a","mapBy","name","console","log","_ref2","objectiveIDs","Object","keys","scenarioIDs","values","newObjs","groupBy","key","WATERDROP_ICON","draw","DROPLET_SHAPE","percentToRatioFilled","CIRC_RAD","SQRT1_2","DROP_RAD","CIRC_HEIGHT","DROP_HEIGHT","HAT_START","yToHalfWidth","trigX","angle","acos","yToSpriteY","spriteYToY","sy","waterdropDeltaOutline","yStart","yEnd","Y_DELTA","rightCoords","leftCoords","dx1","dy1","dx2","dy2","v1","v2","v3","v4","reverse","waterdropDelta","coords","kernelDensityEstimator","kernel","X","V","kernelEpanechnikov","k","generateWaterdrop","delta","outer","cos","generateRandoPoints","shape","bounds","Matter","create","minX","maxX","minY","maxY","genX","genY","points","random","contains","WATERDROP_CAGE_COORDS","inner","RANDO_CACHE","lastNodesLen","DET_CACHE","lastDetNodesLen","radsToDropWidth","nodes","AREA","r","floor","sqrt","placeDropsUsingPhysics","reuse","WIDTH_AREA","randoPoints","Engine","Bodies","Composite","engine","nodePos","node_bodies","_ref3","nx","ny","circle","restitution","parts","quad","position","centre","vertices","isStatic","cage","setParts","setCentre","scale","add","world","FPS","SECS","update","retVal","_ref4","useStickyScale","defaultVal","val","setVal","useState","useMemo","useCallback","createInterps","obj_name","scen_name","maxDelivs","delivs","clamp","criteriaSort","criteria","objective","get","object","defaultValue","_object","split","part","pick","sortBy","array","va","vb","toRadians","Camera","constructor","_ref5","fov","near","far","domElement","zoomFn","raycaster","THREE","camera","set","zoom","scaleExtent","getScaleFromZ","on","d3ZoomHandler","curTransform","transform","view","translate","z","getZFromScale","camera_z_position","half_fov_radians","fov_height","tan","intersectObject","mouseX","mouseY","mesh","setFromCamera","MeshGeometry","threeGeom","idx","addMeshCoords","meshCoords","color","indices","j","c","face","vertexColors","faces","mouseToThree","useStateRef","state","_setState","stateRef","useEffect","setState"],"sourceRoot":""}