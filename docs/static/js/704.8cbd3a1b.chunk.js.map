{"version":3,"file":"static/js/704.8cbd3a1b.chunk.js","mappings":"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","sources":["SliderApp.jsx","bucket-lib/BucketGlyph.jsx","bucket-lib/utils.js","data/factorsData.jsx","data/objectivesData.jsx","utils.js"],"sourcesContent":["import React, { useMemo, useEffect, useRef, useState } from \"react\";\r\nimport * as d3 from \"d3\";\r\n\r\nimport BucketGlyph from \"./bucket-lib/BucketGlyph\";\r\n\r\nimport {\r\n  DELIV_KEY_STRING,\r\n  MAX_DELIVS,\r\n  SCENARIO_KEY_STRING,\r\n  objectivesData,\r\n} from \"./data/objectivesData\";\r\nimport { factorsData } from \"./data/factorsData\";\r\nimport { interpolateWatercolorBlue, ticksExact } from \"./bucket-lib/utils\";\r\nimport { useStickyScale } from \"./utils\";\r\n\r\nconst DEFAULT_SCENARIO = \"expl0000\";\r\nconst DEFAULT_OBJECTIVE_ID = \"DEL_CVP_PAG_N\";\r\nconst DEFAULT_VAL = 0;\r\nconst LEVELS = 10;\r\n\r\nconst D_KEY = \"demand\",\r\n  C_KEY = \"carryover\",\r\n  P_KEY = \"priority\",\r\n  R_KEY = \"regs\",\r\n  M_KEY = \"minflow\";\r\n\r\nconst NUM_OPTS = {\r\n  [D_KEY]: 5,\r\n  [C_KEY]: 3,\r\n  [P_KEY]: 2,\r\n  [R_KEY]: 4,\r\n  [M_KEY]: 5,\r\n};\r\n\r\nconst THRESHOLDS = {};\r\n\r\nObject.keys(NUM_OPTS).forEach(\r\n  (variable) =>\r\n    (THRESHOLDS[variable] = d3.scaleQuantize(\r\n      ticksExact(0, 1, NUM_OPTS[variable])\r\n    ))\r\n);\r\n\r\nexport default function SliderApp() {\r\n  const { current: objectiveIDs } = useRef(Object.keys(objectivesData));\r\n\r\n  const [curScenID, setCurScenID] = useState(DEFAULT_SCENARIO);\r\n  const [curObjectiveID, setCurObjectiveID] = useState(DEFAULT_OBJECTIVE_ID);\r\n\r\n  const [demand, setDemand] = useStickyScale(DEFAULT_VAL, THRESHOLDS[D_KEY]);\r\n  const [carryover, setCarryover] = useStickyScale(\r\n    DEFAULT_VAL,\r\n    THRESHOLDS[C_KEY]\r\n  );\r\n  const [priority, setPriority] = useStickyScale(\r\n    DEFAULT_VAL,\r\n    THRESHOLDS[P_KEY]\r\n  );\r\n  const [regs, setRegs] = useStickyScale(DEFAULT_VAL, THRESHOLDS[R_KEY]);\r\n  const [minflow, setMinflow] = useStickyScale(DEFAULT_VAL, THRESHOLDS[M_KEY]);\r\n\r\n  const curInterp = useMemo(\r\n    () => createInterps(curObjectiveID, curScenID),\r\n    [curScenID, curObjectiveID]\r\n  );\r\n\r\n  useEffect(\r\n    () =>\r\n      void setCurScenID(\r\n        factorsData[serialize(demand, carryover, priority, regs, minflow)]\r\n      ),\r\n    [demand, carryover, priority, regs, minflow]\r\n  );\r\n\r\n  const variables = [\r\n    {\r\n      label: \"demand [1, 0.9, 0.8, 0.7, 0.6]\",\r\n      controlVar: D_KEY,\r\n      val: demand,\r\n      setter: setDemand,\r\n    },\r\n    {\r\n      label: \"carryover [1.0, 1.2, 1.3]\",\r\n      controlVar: C_KEY,\r\n      val: carryover,\r\n      setter: setCarryover,\r\n    },\r\n    {\r\n      label: \"priority [0, 1]\",\r\n      controlVar: P_KEY,\r\n      val: priority,\r\n      setter: setPriority,\r\n    },\r\n    {\r\n      label: \"regs [1, 2, 3, 4]\",\r\n      controlVar: R_KEY,\r\n      val: regs,\r\n      setter: setRegs,\r\n    },\r\n    {\r\n      label: \"minflow [0, 0.4, 0.6, 0.7, 0.8]\",\r\n      controlVar: M_KEY,\r\n      val: minflow,\r\n      setter: setMinflow,\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <div className=\"editor\">\r\n        <div className=\"sliders\">\r\n          <select\r\n            value={curObjectiveID}\r\n            onChange={(e) => setCurObjectiveID(e.target.value)}\r\n          >\r\n            {objectiveIDs.map((objectiveID) => (\r\n              <option key={objectiveID} name={objectiveID} value={objectiveID}>\r\n                {objectiveID}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {variables.map(({ label, controlVar, val, setter }) => (\r\n            <div key={controlVar}>\r\n              <span>{label}</span>\r\n              <LineSlider\r\n                data={getLocalProbs(\r\n                  { demand, carryover, priority, regs, minflow },\r\n                  controlVar,\r\n                  curObjectiveID\r\n                )}\r\n                val={val}\r\n                setVal={setter}\r\n              />\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div>\r\n          <BucketGlyph\r\n            levelInterp={curInterp}\r\n            width={300}\r\n            height={400}\r\n            resolution={LEVELS}\r\n          />\r\n          <span\r\n            style={{\r\n              display: \"block\",\r\n              textAlign: \"center\",\r\n            }}\r\n          >\r\n            {curScenID}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction LineSlider({ data, val, setVal }) {\r\n  const MARGIN = { top: 5, right: 5, bottom: 0, left: 5 },\r\n    WIDTH = 400,\r\n    HEIGHT = 50,\r\n    RAZOR_WIDTH = 5;\r\n\r\n  const svgElem = useRef();\r\n  const x = d3.scaleLinear().range([0, WIDTH]);\r\n  const y = d3.scaleLinear().range([HEIGHT, 0]);\r\n\r\n  useEffect(() => {\r\n    svgElem.current\r\n      .attr(\"width\", WIDTH + MARGIN.left + MARGIN.right)\r\n      .attr(\"height\", HEIGHT + MARGIN.top + MARGIN.bottom)\r\n      .call((s) =>\r\n        s.node().addEventListener(\"mousedown\", (e) =>\r\n          setVal(\r\n            d3\r\n              .scaleLinear()\r\n              .domain([MARGIN.left, WIDTH + MARGIN.left])\r\n              .clamp(true)(e.offsetX)\r\n          )\r\n        )\r\n      )\r\n      .call((s) => {\r\n        s.append(\"g\")\r\n          .attr(\"transform\", `translate(${MARGIN.left},${MARGIN.top})`)\r\n          .call(\r\n            d3\r\n              .axisTop(d3.scalePoint(d3.range(data[0].length), [0, WIDTH]))\r\n              .tickFormat(\"\")\r\n          )\r\n          .selectAll(\"path\")\r\n          .style(\"stroke\", \"lightgrey\");\r\n        // ticks can stay color black for clarity\r\n      })\r\n      .append(\"g\")\r\n      .attr(\"class\", \"graph-area\")\r\n      .attr(\"transform\", `translate(${MARGIN.left},${MARGIN.top})`)\r\n      .call((s) =>\r\n        s\r\n          .selectAll(\"path\")\r\n          .data(data)\r\n          .join(\"path\")\r\n          .attr(\"fill\", (_, i) => interpolateWatercolorBlue(i / data.length))\r\n      )\r\n      .call((s) =>\r\n        s\r\n          .append(\"rect\")\r\n          .attr(\"width\", WIDTH)\r\n          .attr(\"height\", HEIGHT)\r\n          .attr(\"fill\", \"none\")\r\n          .attr(\"stroke\", \"lightgrey\")\r\n      )\r\n      .append(\"rect\")\r\n      .attr(\"class\", \"razor\")\r\n      .attr(\"fill\", \"red\")\r\n      .attr(\"width\", RAZOR_WIDTH)\r\n      .attr(\"height\", HEIGHT);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    svgElem.current\r\n      .select(\".graph-area\")\r\n      .selectAll(\"path\")\r\n      .data(data)\r\n      .attr(\"d\", (dd) =>\r\n        d3\r\n          .area()\r\n          .x((_, i) => x(i / (dd.length - 1)))\r\n          .y1((d) => y(d))\r\n          .y0(y(0))(dd)\r\n      );\r\n  }, [data]);\r\n\r\n  useEffect(() => {\r\n    svgElem.current\r\n      .select(\".graph-area\")\r\n      .select(\".razor\")\r\n      .attr(\"x\", x(val) - RAZOR_WIDTH / 2);\r\n  }, [val]);\r\n\r\n  return (\r\n    <svg\r\n      className=\"line-slider\"\r\n      ref={(e) => void (svgElem.current = d3.select(e))}\r\n    ></svg>\r\n  );\r\n}\r\n\r\nfunction serialize(demand, carryover, priority, regs, minflow) {\r\n  const interp = (v, k) => d3.scaleQuantize(d3.range(1, NUM_OPTS[k] + 1))(v);\r\n  console.log(\r\n    `${interp(demand, D_KEY)}${interp(carryover, C_KEY)}${interp(\r\n      priority,\r\n      P_KEY\r\n    )}${interp(regs, R_KEY)}${interp(minflow, M_KEY)}`\r\n  );\r\n\r\n  return `${interp(demand, D_KEY)}${interp(carryover, C_KEY)}${interp(\r\n    priority,\r\n    P_KEY\r\n  )}${interp(regs, R_KEY)}${interp(minflow, M_KEY)}`;\r\n}\r\n\r\nfunction createInterps(name, curScen) {\r\n  console.log(curScen);\r\n  const delivs =\r\n    objectivesData[name][SCENARIO_KEY_STRING][curScen][DELIV_KEY_STRING];\r\n  return d3\r\n    .scaleLinear()\r\n    .domain(ticksExact(0, 1, delivs.length))\r\n    .range(delivs.map((v) => v / MAX_DELIVS))\r\n    .clamp(true);\r\n}\r\n\r\nfunction getLocalProbs(\r\n  { demand: d, carryover: c, priority: p, regs: r, minflow: m },\r\n  controlVar,\r\n  objective\r\n) {\r\n  const combinations = [];\r\n\r\n  const dVals = controlVar !== D_KEY ? [d] : THRESHOLDS[D_KEY].range();\r\n  const cVals = controlVar !== C_KEY ? [c] : THRESHOLDS[C_KEY].range();\r\n  const pVals = controlVar !== P_KEY ? [p] : THRESHOLDS[P_KEY].range();\r\n  const rVals = controlVar !== R_KEY ? [r] : THRESHOLDS[R_KEY].range();\r\n  const mVals = controlVar !== M_KEY ? [m] : THRESHOLDS[M_KEY].range();\r\n\r\n  for (const d of dVals) {\r\n    for (const c of cVals) {\r\n      for (const p of pVals) {\r\n        for (const r of rVals) {\r\n          for (const m of mVals) {\r\n            combinations.push([d, c, p, r, m]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const interps = combinations.map((vals) =>\r\n    createInterps(objective, factorsData[serialize(...vals)])\r\n  );\r\n\r\n  return ticksExact(0, 1, LEVELS + 1).map((t) => interps.map((d) => d(t)));\r\n}\r\n","import * as d3 from \"d3\";\r\nimport { useId, useLayoutEffect, useMemo, useRef } from \"react\";\r\nimport {\r\n  bucketPath,\r\n  interpolateWatercolorBlue,\r\n  ticksExact,\r\n  usePrevious,\r\n} from \"./utils\";\r\n\r\nconst DEGREE_SWAY = 40;\r\nconst LEVELS = 10;\r\nconst LINE_WIDTH = 3;\r\n\r\nexport default function BucketGlyph({\r\n  levelInterp,\r\n  colorInterp = interpolateWatercolorBlue,\r\n  width = 200,\r\n  height = 400,\r\n  resolution = LEVELS,\r\n}) {\r\n  const id = useId();\r\n  const svgSelector = useRef();\r\n\r\n  const liquidLevels = useMemo(\r\n    () =>\r\n      ticksExact(0, 1 - 1 / resolution, resolution).map((d) => levelInterp(d)),\r\n    [levelInterp, resolution]\r\n  );\r\n\r\n  const prevLiquidLevels = usePrevious(liquidLevels);\r\n\r\n  const innerWidth = width - LINE_WIDTH * 2;\r\n  const innerHeight = height - LINE_WIDTH;\r\n\r\n  useLayoutEffect(() => {\r\n    const svgContainer = svgSelector.current\r\n      .append(\"g\")\r\n      .attr(\"class\", \"svg-container\")\r\n      .attr(\"transform\", `translate(${LINE_WIDTH}, ${LINE_WIDTH / 2})`);\r\n\r\n    svgContainer\r\n      .append(\"defs\")\r\n      .append(\"clipPath\")\r\n      .attr(\"id\", \"bucket-mask-\" + id)\r\n      .append(\"path\")\r\n      .attr(\"class\", \"bucket-mask-path\");\r\n\r\n    svgContainer\r\n      .append(\"g\")\r\n      .attr(\"class\", \"graph-area\")\r\n      .attr(\"clip-path\", `url(#bucket-mask-${id})`);\r\n\r\n    svgContainer\r\n      .append(\"g\")\r\n      .append(\"path\")\r\n      .attr(\"class\", \"bucket-outline\")\r\n      .attr(\"stroke\", \"lightgray\")\r\n      .attr(\"stroke-linecap\", \"round\")\r\n      .attr(\"stroke-width\", LINE_WIDTH)\r\n      .attr(\"fill\", \"none\");\r\n  }, [id]); // id shouldn't change, basically empty dependency array\r\n\r\n  useLayoutEffect(() => {\r\n    const svgContainer = svgSelector.current\r\n      .attr(\"width\", width)\r\n      .attr(\"height\", height)\r\n      .select(\".svg-container\");\r\n\r\n    svgContainer\r\n      .select(\".bucket-mask-path\")\r\n      .attr(\"d\", bucketPath(innerWidth, innerHeight));\r\n\r\n    svgContainer\r\n      .select(\".bucket-outline\")\r\n      .attr(\"d\", bucketPath(innerWidth, innerHeight).split(\"z\")[0]);\r\n  }, [width, height, innerWidth, innerHeight]);\r\n\r\n  useLayoutEffect(() => {\r\n    const liquids = svgSelector.current\r\n      .select(\".graph-area\")\r\n      .selectAll(\".bucketBox\")\r\n      .data(liquidLevels)\r\n      .join(\"rect\")\r\n      .attr(\"class\", \"bucketBox\")\r\n      .attr(\"width\", innerWidth * 2)\r\n      .attr(\"height\", innerHeight * 2)\r\n      .attr(\"x\", -innerWidth / 2)\r\n      .attr(\"fill\", (_, i) => colorInterp(i / (resolution - 1)));\r\n\r\n    liquids\r\n      .transition(\"liquidLevel\")\r\n      .ease(d3.easeElasticOut.period(0.6))\r\n      .delay((_, i) => i * (100 / resolution))\r\n      .duration(1000)\r\n      .attr(\"y\", (d) => innerHeight - d * innerHeight);\r\n\r\n    liquids\r\n      .transition(\"liquidSway\")\r\n      .duration(2000)\r\n      .delay((_, i) => i * 10)\r\n      .ease(d3.easeQuad)\r\n      .attrTween(\"transform\", function (d, i) {\r\n        const diff = prevLiquidLevels ? Math.abs(prevLiquidLevels[i] - d) : 0;\r\n        return (t) =>\r\n          `rotate(${\r\n            Math.sin(\r\n              Math.min((Math.PI * 4 * t) / (0.5 * diff + 0.5), Math.PI * 4)\r\n            ) *\r\n            diff *\r\n            DEGREE_SWAY *\r\n            (1 - t)\r\n          }, ${innerWidth / 2}, ${0})`;\r\n      });\r\n  }, [\r\n    liquidLevels,\r\n    prevLiquidLevels,\r\n    width,\r\n    height,\r\n    innerWidth,\r\n    innerHeight,\r\n    resolution,\r\n    colorInterp,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"bucket-wrapper\">\r\n      <svg ref={(e) => void (svgSelector.current = d3.select(e))}></svg>\r\n    </div>\r\n  );\r\n}\r\n","import * as d3 from \"d3\";\r\nimport { useRef } from \"react\";\r\n\r\n// inclusive\r\nexport function ticksExact(start, stop, count) {\r\n  return d3.range(count).map((i) => (i / (count - 1)) * (stop - start) + start);\r\n}\r\n\r\nexport function bucketPath(width, height, filled = 1.0, taper = 0.8) {\r\n  let bottomRight = width * taper + (width * (1 - taper)) / 2,\r\n    bottomLeft = (width * (1 - taper)) / 2;\r\n  let data = [\r\n    {\r\n      x: d3.interpolate(bottomRight, width)(filled),\r\n      y: d3.interpolate(height, 0)(filled),\r\n    },\r\n    { x: bottomRight, y: height },\r\n    { x: bottomLeft, y: height },\r\n    {\r\n      x: d3.interpolate(bottomLeft, 0)(filled),\r\n      y: d3.interpolate(height, 0)(filled),\r\n    },\r\n  ];\r\n  let lineFunc = d3\r\n    .line()\r\n    .x(function (d) {\r\n      return d.x;\r\n    })\r\n    .y(function (d) {\r\n      return d.y;\r\n    });\r\n  return lineFunc(data) + \"z\";\r\n}\r\n\r\nexport function quantileBins(numericBins, unitsPerQuantile, maxQuantiles) {\r\n  let quantileBins = numericBins.map((bin) =>\r\n    Math.round(bin.length / unitsPerQuantile)\r\n  );\r\n  let sum = d3.sum(quantileBins);\r\n\r\n  while (sum > maxQuantiles) {\r\n    quantileBins[\r\n      d3.minIndex(numericBins, (d, i) =>\r\n        d.length !== 0\r\n          ? d.length / unitsPerQuantile - quantileBins[i]\r\n          : Infinity\r\n      )\r\n    ] -= 1;\r\n\r\n    sum = d3.sum(quantileBins);\r\n  }\r\n\r\n  while (sum < maxQuantiles) {\r\n    quantileBins[\r\n      d3.maxIndex(numericBins, (d, i) =>\r\n        d.length !== 0\r\n          ? d.length / unitsPerQuantile - quantileBins[i]\r\n          : -Infinity\r\n      )\r\n    ] += 1;\r\n\r\n    sum = d3.sum(quantileBins);\r\n  }\r\n\r\n  return quantileBins;\r\n}\r\n\r\n// https://www.developerway.com/posts/implementing-advanced-use-previous-hook\r\nexport function usePrevious(value, isEqualFunc) {\r\n  // initialise the ref with previous and current values\r\n  const ref = useRef({\r\n    value: value,\r\n    prev: null,\r\n  });\r\n\r\n  const current = ref.current.value;\r\n\r\n  // if the value passed into hook doesn't match what we store as \"current\"\r\n  // move the \"current\" to the \"previous\"\r\n  // and store the passed value as \"current\"\r\n  if (isEqualFunc ? !isEqualFunc(value, current) : value !== current) {\r\n    ref.current = {\r\n      value: value,\r\n      prev: current,\r\n    };\r\n  }\r\n\r\n  // return the previous value only\r\n  return ref.current.prev;\r\n}\r\n\r\nexport const interpolateWatercolorBlue = (i) =>\r\n  d3.interpolateBlues(d3.scaleLinear([0.2, 1.0])(i));\r\n","export const factorsData = await (async function () {\r\n  const objs = await (await fetch(\"./factors.json\")).json();\r\n\r\n  console.log(\"DATA: loading factors data\");\r\n\r\n  return objs;\r\n})();\r\n","import { mapBy } from \"../utils\";\r\n\r\nexport const MAX_DELIVS = 1200;\r\nexport const SCENARIO_KEY_STRING = \"scens\";\r\nexport const DELIV_KEY_STRING = \"delivs\";\r\nexport const DELIV_KEY_STRING_UNORD = \"delivs_unord\";\r\n\r\nexport const objectivesData = await (async function () {\r\n  const objs = await (await fetch(\"./all_objectives.json\")).json();\r\n\r\n  for (const obj of objs) {\r\n    obj[SCENARIO_KEY_STRING] = obj[SCENARIO_KEY_STRING];\r\n    for (const scen of obj[SCENARIO_KEY_STRING]) {\r\n      scen[DELIV_KEY_STRING_UNORD] = scen[DELIV_KEY_STRING];\r\n\r\n      scen[DELIV_KEY_STRING] = scen[DELIV_KEY_STRING_UNORD].map((v) =>\r\n        Math.min(Math.max(0, v), MAX_DELIVS)\r\n      ).sort((a, b) => b - a);\r\n    }\r\n    obj[SCENARIO_KEY_STRING] = mapBy(\r\n      obj[SCENARIO_KEY_STRING],\r\n      ({ name }) => name\r\n    );\r\n  }\r\n\r\n  console.log(\"DATA: loading objectives data\");\r\n\r\n  return mapBy(objs, ({ obj }) => obj);\r\n})();\r\n\r\nexport const objectiveIDs = Object.keys(objectivesData);\r\nexport const scenarioIDs = Object.keys(\r\n  Object.values(objectivesData)[0][SCENARIO_KEY_STRING]\r\n);\r\n","import * as THREE from \"three\";\r\nimport * as d3 from \"d3\";\r\nimport Matter from \"matter-js\";\r\nimport {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { DELIV_KEY_STRING, SCENARIO_KEY_STRING } from \"./data/objectivesData\";\r\nimport { ticksExact } from \"./bucket-lib/utils\";\r\n\r\nexport function clamp(x, a, b) {\r\n  return Math.max(a, Math.min(b, x));\r\n}\r\n\r\n// when fn is `({ name }) => name`, turns\r\n//\r\n//  [\r\n//    { name: \"Zeta\", age: 30 },\r\n//    { name: \"Aloy\", age: 40 },\r\n//  ];\r\n//\r\n// to\r\n//\r\n//  {\r\n//    \"Zeta\": { name: \"Zeta\", age: 30 },\r\n//    \"Aloy\": { name: \"Aloy\", age: 40 },\r\n//  };\r\nexport function mapBy(objs, fn) {\r\n  const newObjs = Object.groupBy(objs, fn);\r\n\r\n  for (const key of Object.keys(newObjs)) {\r\n    newObjs[key] = newObjs[key][0];\r\n  }\r\n\r\n  return newObjs;\r\n}\r\n\r\n// size is height of waterdrop plus a bit more (1/2 of size is distance from top of drop to center of circle part)\r\nexport const WATERDROP_ICON = {\r\n  draw: function (context, size) {\r\n    context.moveTo(0, -size / 2);\r\n    context.lineTo(size / 4, -size / 4);\r\n\r\n    context.arc(0, 0, size / Math.SQRT2 / 2, -Math.PI / 4, (Math.PI * 5) / 4);\r\n    context.lineTo(0, -size / 2);\r\n    context.closePath();\r\n  },\r\n};\r\n\r\n// path generated when WATERDROP_ICON size = 2\r\nexport const DROPLET_SHAPE = \"M0,-1L0.5,-0.5A0.707,0.707,0,1,1,-0.5,-0.5L0,-1Z\";\r\n\r\nexport function percentToRatioFilled(p) {\r\n  p -= 0.0088;\r\n  return Math.min(\r\n    1,\r\n    Math.max(\r\n      0,\r\n      (3.1304 * p ** 3 - 4.2384 * p ** 2 + 3.3471 * p + 0.0298) / 2.2326\r\n    )\r\n  );\r\n}\r\n\r\nconst CIRC_RAD = Math.SQRT1_2;\r\nconst DROP_RAD = 1;\r\nconst CIRC_HEIGHT = CIRC_RAD + CIRC_RAD;\r\nconst DROP_HEIGHT = DROP_RAD + CIRC_RAD;\r\nconst HAT_START = 0.75;\r\n\r\n// half width at widest is 1\r\nfunction yToHalfWidth(y) {\r\n  if (y >= HAT_START) {\r\n    const hatHalfWidth = Math.SQRT1_2;\r\n\r\n    return (hatHalfWidth * (1 - y)) / (1 - HAT_START);\r\n  }\r\n\r\n  const circFrac = fracDropToCirc(y);\r\n  const trigX = (1 - circFrac) * 2 - 1;\r\n\r\n  const angle = Math.acos(trigX);\r\n  const trigY = Math.sin(angle);\r\n\r\n  return trigY;\r\n}\r\n\r\n// fml, here sprite width is 2 (i.e. circ rad is 1) thus drop real height is 1 + sqrt2\r\nfunction yToSpriteY(y) {\r\n  return (y - CIRC_RAD / DROP_HEIGHT) * (1 + Math.SQRT2);\r\n}\r\n\r\nfunction spriteYToY(sy) {\r\n  return sy / (1 + Math.SQRT2) + CIRC_RAD / DROP_HEIGHT;\r\n}\r\n\r\nfunction fracCircToDrop(v) {\r\n  return v / CIRC_HEIGHT / DROP_HEIGHT;\r\n}\r\n\r\nfunction fracDropToCirc(v) {\r\n  return v / (CIRC_HEIGHT / DROP_HEIGHT);\r\n}\r\n\r\nexport function waterdropDeltaOutline(yStart, yEnd, size = 2) {\r\n  if (Math.abs(yStart - yEnd) < 0.01) return [];\r\n\r\n  const rad = (size / 2 / DROP_RAD) * CIRC_RAD;\r\n\r\n  const Y_DELTA = 0.1;\r\n\r\n  const rightCoords = [];\r\n  const leftCoords = [];\r\n\r\n  let dx1, dy1, dx2, dy2;\r\n\r\n  for (let i = 1; i <= Math.ceil(1 / Y_DELTA); i++) {\r\n    dx1 = yToHalfWidth(yStart + (i - 1) * Y_DELTA);\r\n    dy1 = yToSpriteY(yStart + (i - 1) * Y_DELTA);\r\n    dx2 = yToHalfWidth(yStart + i * Y_DELTA);\r\n    dy2 = yToSpriteY(yStart + i * Y_DELTA);\r\n\r\n    if (spriteYToY(dy2) >= yEnd) break;\r\n\r\n    // CC !\r\n    const v1 = [-dx1 * rad, -dy1 * rad],\r\n      v2 = [dx1 * rad, -dy1 * rad],\r\n      v3 = [dx2 * rad, -dy2 * rad],\r\n      v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n    rightCoords.push(v2, v3);\r\n    leftCoords.push(v1, v4);\r\n  }\r\n\r\n  dx2 = yToHalfWidth(yEnd);\r\n  dy2 = yToSpriteY(yEnd);\r\n\r\n  // CC !\r\n  const v1 = [-dx1 * rad, -dy1 * rad],\r\n    v2 = [dx1 * rad, -dy1 * rad],\r\n    v3 = [dx2 * rad, -dy2 * rad],\r\n    v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n  rightCoords.push(v2, v3);\r\n  leftCoords.push(v1, v4);\r\n\r\n  rightCoords.push(...leftCoords.reverse());\r\n\r\n  return rightCoords;\r\n}\r\n\r\nexport function waterdropDelta(yStart, yEnd, size = 2) {\r\n  if (Math.abs(yStart - yEnd) < 0.01) return [];\r\n\r\n  const rad = (size / 2 / DROP_RAD) * CIRC_RAD;\r\n\r\n  const Y_DELTA = 0.1;\r\n\r\n  const coords = [];\r\n\r\n  let dx1, dy1, dx2, dy2;\r\n\r\n  for (let i = 1; i <= Math.ceil(1 / Y_DELTA); i++) {\r\n    dx1 = yToHalfWidth(yStart + (i - 1) * Y_DELTA);\r\n    dy1 = yToSpriteY(yStart + (i - 1) * Y_DELTA);\r\n    dx2 = yToHalfWidth(yStart + i * Y_DELTA);\r\n    dy2 = yToSpriteY(yStart + i * Y_DELTA);\r\n\r\n    if (spriteYToY(dy2) >= yEnd) break;\r\n\r\n    // CC !\r\n    const v1 = [-dx1 * rad, -dy1 * rad],\r\n      v2 = [dx1 * rad, -dy1 * rad],\r\n      v3 = [dx2 * rad, -dy2 * rad],\r\n      v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n    coords.push([v1, v2, v3]);\r\n    coords.push([v1, v3, v4]);\r\n  }\r\n\r\n  dx2 = yToHalfWidth(yEnd);\r\n  dy2 = yToSpriteY(yEnd);\r\n\r\n  // CC !\r\n  const v1 = [-dx1 * rad, -dy1 * rad],\r\n    v2 = [dx1 * rad, -dy1 * rad],\r\n    v3 = [dx2 * rad, -dy2 * rad],\r\n    v4 = [-dx2 * rad, -dy2 * rad];\r\n\r\n  coords.push([v1, v2, v3]);\r\n  coords.push([v1, v3, v4]);\r\n\r\n  return coords;\r\n}\r\n\r\nexport function waterdrop(yFill, size = 2) {\r\n  if (yFill === 0) return [];\r\n\r\n  return waterdropDelta(0, yFill, size);\r\n}\r\n\r\nexport function kernelDensityEstimator(kernel, X) {\r\n  return function (V) {\r\n    return X.map(function (x) {\r\n      return [\r\n        x,\r\n        d3.mean(V, function (v) {\r\n          return kernel(x - v);\r\n        }),\r\n      ];\r\n    });\r\n  };\r\n}\r\n\r\nexport function kernelEpanechnikov(k) {\r\n  return function (v) {\r\n    return Math.abs((v /= k)) <= 1 ? (0.75 * (1 - v * v)) / k : 0;\r\n  };\r\n}\r\n\r\nfunction generateWaterdrop(width) {\r\n  const rad = width / 2;\r\n  const partitions = 16;\r\n  const delta = (Math.PI * 3) / 2 / partitions;\r\n\r\n  const outer = [\r\n    {\r\n      x: Math.cos((Math.PI * 5) / 4) * rad,\r\n      y: Math.sin((Math.PI * 5) / 4) * rad,\r\n    },\r\n    {\r\n      x: 0,\r\n      y: -Math.SQRT2 * rad,\r\n    },\r\n  ];\r\n\r\n  for (let i = 0; i <= partitions; i++) {\r\n    outer.push({\r\n      x: Math.cos(i * delta - Math.PI / 4) * rad,\r\n      y: Math.sin(i * delta - Math.PI / 4) * rad,\r\n    });\r\n  }\r\n\r\n  return outer;\r\n}\r\n\r\nexport function generateRandoPoints(shape, count) {\r\n  const bounds = Matter.Bounds.create(shape);\r\n\r\n  const minX = bounds.min.x,\r\n    maxX = bounds.max.x,\r\n    minY = bounds.min.y,\r\n    maxY = bounds.max.y;\r\n\r\n  const genX = d3.scaleLinear([minX, maxX]);\r\n  const genY = d3.scaleLinear([minY, maxY]);\r\n\r\n  const points = [];\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    while (true) {\r\n      const x = genX(Math.random());\r\n      const y = genY(Math.random());\r\n\r\n      if (Matter.Vertices.contains(shape, { x, y })) {\r\n        points.push([x, y]);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return points;\r\n}\r\n\r\n// inner diameter of 1\r\nexport const WATERDROP_CAGE_COORDS = (function () {\r\n  const outer = generateWaterdrop(3);\r\n  const inner = generateWaterdrop(1);\r\n\r\n  const coords = [];\r\n\r\n  for (let i = 0; i < outer.length - 2; i++) {\r\n    coords.push([\r\n      outer[i],\r\n      outer[i + (i < 2 ? 1 : 2)],\r\n      inner[i + (i < 2 ? 1 : 2)],\r\n      inner[i],\r\n    ]);\r\n  }\r\n\r\n  return coords;\r\n})();\r\n\r\nlet RANDO_CACHE;\r\nlet lastNodesLen;\r\n\r\nlet DET_CACHE;\r\nlet lastDetNodesLen;\r\n\r\nexport function radsToDropWidth(nodes) {\r\n  const AREA = d3.sum(nodes.map((r) => r ** 2 * 3.14));\r\n  return Math.floor((Math.sqrt(AREA / 3.14) * 2) / 2);\r\n}\r\n\r\n// assuming nodes is already ordered and first nodes are going to be put on the bottom\r\nexport function placeDropsUsingPhysics(x, y, nodes, reuse = false) {\r\n  if (reuse && DET_CACHE && nodes.length === lastDetNodesLen) return DET_CACHE;\r\n\r\n  // first generate random points within water droplet. we can stop here, but points might not be the most uniformly distributed\r\n\r\n  if (!RANDO_CACHE || nodes.length !== lastNodesLen)\r\n    RANDO_CACHE = d3\r\n      .range(4)\r\n      .map(() =>\r\n        generateRandoPoints(generateWaterdrop(1), (lastNodesLen = nodes.length))\r\n      );\r\n\r\n  const WIDTH_AREA = radsToDropWidth(nodes.map(({ r }) => r));\r\n\r\n  const randoPoints = RANDO_CACHE[\r\n    Math.floor(Math.random() * RANDO_CACHE.length)\r\n  ].map(([x, y]) => [x * WIDTH_AREA, y * WIDTH_AREA]);\r\n\r\n  // thus, we use physics engine to take care of distributing the points evenly and based on radius\r\n  const Engine = Matter.Engine,\r\n    Bodies = Matter.Bodies,\r\n    Composite = Matter.Composite;\r\n\r\n  const engine = Engine.create();\r\n\r\n  const nodePos = randoPoints.sort((a, b) => b[1] - a[1]);\r\n\r\n  const node_bodies = nodes.map(({ r, id }, i) => {\r\n    const [nx, ny] = nodePos[i];\r\n    return Bodies.circle(nx, ny, r, {\r\n      restitution: 0,\r\n      id: id,\r\n    });\r\n  });\r\n\r\n  const parts = WATERDROP_CAGE_COORDS.map((quad) =>\r\n    Matter.Body.create({\r\n      position: Matter.Vertices.centre(quad),\r\n      vertices: quad,\r\n      isStatic: true,\r\n    })\r\n  );\r\n\r\n  const cage = Matter.Body.create({\r\n    isStatic: true,\r\n  });\r\n\r\n  Matter.Body.setParts(cage, parts);\r\n\r\n  Matter.Body.setCentre(cage, { x: 0, y: 0 });\r\n  Matter.Body.scale(cage, WIDTH_AREA, WIDTH_AREA);\r\n\r\n  Composite.add(engine.world, [...node_bodies, cage]);\r\n\r\n  // run engine for SECS second at FPS fps\r\n  for (let i = 0, FPS = 60, SECS = 0.1; i < FPS * SECS; i++)\r\n    Engine.update(engine, 1000 / FPS);\r\n\r\n  const retVal = node_bodies.map(({ position, id }) => ({\r\n    id,\r\n    x: position.x + x,\r\n    y: position.y + y,\r\n  }));\r\n\r\n  retVal.height = (WIDTH_AREA / 2 / CIRC_RAD) * DROP_HEIGHT;\r\n\r\n  if (reuse && (!DET_CACHE || retVal.length !== lastDetNodesLen)) {\r\n    DET_CACHE = retVal;\r\n    lastDetNodesLen = retVal.length;\r\n  }\r\n\r\n  return retVal;\r\n}\r\n\r\n// https://gist.github.com/mbostock/5743979\r\nexport function bounce(h) {\r\n  if (!arguments.length) h = 0.25;\r\n  var b0 = 1 - h,\r\n    b1 = b0 * (1 - b0) + b0,\r\n    b2 = b0 * (1 - b1) + b1,\r\n    x0 = 2 * Math.sqrt(h),\r\n    x1 = x0 * Math.sqrt(h),\r\n    x2 = x1 * Math.sqrt(h),\r\n    t0 = 1 / (1 + x0 + x1 + x2),\r\n    t1 = t0 + t0 * x0,\r\n    t2 = t1 + t0 * x1,\r\n    m0 = t0 + (t0 * x0) / 2,\r\n    m1 = t1 + (t0 * x1) / 2,\r\n    m2 = t2 + (t0 * x2) / 2,\r\n    a = 1 / (t0 * t0);\r\n  return function (t) {\r\n    return t >= 1\r\n      ? 1\r\n      : t < t0\r\n      ? a * t * t\r\n      : t < t1\r\n      ? a * (t -= m0) * t + b0\r\n      : t < t2\r\n      ? a * (t -= m1) * t + b1\r\n      : a * (t -= m2) * t + b2;\r\n  };\r\n}\r\n\r\nexport function rangeInclusive(a, b) {\r\n  return d3.range(a, b + 1);\r\n}\r\n\r\nexport function useStickyScale(defaultVal, scale) {\r\n  const [val, setVal] = useState(defaultVal);\r\n\r\n  const valActual = useMemo(() => scale(val), [val]);\r\n  const setValActual = useCallback((v) => void setVal(scale(v)), []);\r\n\r\n  return [valActual, setValActual];\r\n}\r\n\r\nexport function createInterps(obj_name, scen_name, data, maxDelivs) {\r\n  const delivs =\r\n    data[obj_name][SCENARIO_KEY_STRING][scen_name][DELIV_KEY_STRING];\r\n  return d3\r\n    .scaleLinear()\r\n    .domain(ticksExact(0, 1, delivs.length))\r\n    .range(delivs.map((v) => Math.min(1, v / maxDelivs)))\r\n    .clamp(true);\r\n}\r\n\r\nexport function criteriaSort(criteria, data, objective) {\r\n  if (criteria === \"median\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort(\r\n      (a, b) =>\r\n        d3.mean(data[objective][SCENARIO_KEY_STRING][a][DELIV_KEY_STRING]) -\r\n        d3.mean(data[objective][SCENARIO_KEY_STRING][b][DELIV_KEY_STRING])\r\n    );\r\n  }\r\n  if (criteria === \"deliveries\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort(\r\n      (a, b) =>\r\n        d3.max(data[objective][SCENARIO_KEY_STRING][a][DELIV_KEY_STRING]) -\r\n        d3.max(data[objective][SCENARIO_KEY_STRING][b][DELIV_KEY_STRING])\r\n    );\r\n  }\r\n  if (criteria === \"alphabetical\") {\r\n    return Object.keys(data[objective][SCENARIO_KEY_STRING]).sort();\r\n  }\r\n}\r\n\r\nfunction get(object, path, defaultValue) {\r\n  const parts = path.split(\".\");\r\n  for (let part of parts) {\r\n    if (!object) return defaultValue;\r\n    object = object[part];\r\n  }\r\n  return object ?? defaultValue;\r\n}\r\n\r\nfunction pick(fn) {\r\n  return typeof fn === \"string\" ? (v) => get(v, fn) : fn;\r\n}\r\n\r\nexport function sortBy(array, fn) {\r\n  fn = pick(fn);\r\n  return array.sort((a, b) => {\r\n    const va = fn(a);\r\n    const vb = fn(b);\r\n    if (va < vb) return -1;\r\n    if (va > vb) return 1;\r\n    return 0;\r\n  });\r\n}\r\n\r\nexport function toRadians(a) {\r\n  return (a * Math.PI) / 180;\r\n}\r\n\r\nexport class Camera {\r\n  fov;\r\n  near;\r\n  far;\r\n  width;\r\n  height;\r\n  camera;\r\n  zoom;\r\n  view;\r\n  curTransform;\r\n\r\n  constructor({ fov, near, far, width, height, domElement, zoomFn }) {\r\n    this.fov = fov;\r\n    this.near = near;\r\n    this.far = far;\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.camera = new THREE.PerspectiveCamera(\r\n      fov,\r\n      width / height,\r\n      near,\r\n      far + 1\r\n    );\r\n\r\n    this.camera.position.set(0, 0, this.far);\r\n\r\n    this.zoom = d3\r\n      .zoom()\r\n      .scaleExtent([\r\n        this.getScaleFromZ(this.far),\r\n        this.getScaleFromZ(this.near),\r\n      ])\r\n      .on(\"zoom\", (e) => {\r\n        this.d3ZoomHandler(e);\r\n        this.curTransform = e.transform;\r\n\r\n        zoomFn && zoomFn(e);\r\n      });\r\n\r\n    this.view = d3.select(domElement);\r\n    this.view.call(this.zoom);\r\n    this.zoom.transform(\r\n      this.view,\r\n      d3.zoomIdentity\r\n        .translate(this.width / 2, this.height / 2)\r\n        .scale(this.getScaleFromZ(this.far))\r\n    );\r\n  }\r\n\r\n  d3ZoomHandler(e) {\r\n    const scale = e.transform.k;\r\n    const x = -(e.transform.x - this.width / 2) / scale;\r\n    const y = (e.transform.y - this.height / 2) / scale;\r\n    const z = this.getZFromScale(scale);\r\n    this.camera.position.set(x, y, z);\r\n  }\r\n\r\n  getScaleFromZ(camera_z_position) {\r\n    const half_fov = this.fov / 2;\r\n    const half_fov_radians = toRadians(half_fov);\r\n    const half_fov_height = Math.tan(half_fov_radians) * camera_z_position;\r\n    const fov_height = half_fov_height * 2;\r\n    const scale = this.height / fov_height;\r\n    return scale;\r\n  }\r\n\r\n  getZFromScale(scale) {\r\n    const half_fov = this.fov / 2;\r\n    const half_fov_radians = toRadians(half_fov);\r\n    const scale_height = this.height / scale;\r\n    const camera_z_position = scale_height / (2 * Math.tan(half_fov_radians));\r\n    return camera_z_position;\r\n  }\r\n}\r\n\r\nexport class MeshGeometry {\r\n  threeGeom = new THREE.Geometry();\r\n  idx = 0;\r\n\r\n  addMeshCoords(meshCoords, transform, color, z = 0) {\r\n    const indices = [];\r\n\r\n    for (let j = 0; j < meshCoords.length; j++) {\r\n      const [v1, v2, v3] = meshCoords[j];\r\n\r\n      const a = new THREE.Vector3(transform.x + v1[0], transform.y - v1[1], z);\r\n      const b = new THREE.Vector3(transform.x + v2[0], transform.y - v2[1], z);\r\n      const c = new THREE.Vector3(transform.x + v3[0], transform.y - v3[1], z);\r\n      this.threeGeom.vertices.push(a, b, c);\r\n\r\n      const face = new THREE.Face3(\r\n        this.idx * 3 + 0,\r\n        this.idx * 3 + 1,\r\n        this.idx * 3 + 2\r\n      );\r\n\r\n      if (color) {\r\n        face.vertexColors.push(color);\r\n        face.vertexColors.push(color);\r\n        face.vertexColors.push(color);\r\n      }\r\n\r\n      this.threeGeom.faces.push(face);\r\n\r\n      indices.push(this.idx++);\r\n    }\r\n\r\n    return indices;\r\n  }\r\n}\r\n\r\nexport function mouseToThree(mouseX, mouseY, width, height) {\r\n  return new THREE.Vector3(\r\n    (mouseX / width) * 2 - 1,\r\n    -(mouseY / height) * 2 + 1,\r\n    1\r\n  );\r\n}\r\n\r\nexport function useStateRef(val) {\r\n  const [state, _setState] = useState(val);\r\n  const stateRef = useRef(val);\r\n\r\n  useEffect(() => void (stateRef.current = state), [state]);\r\n\r\n  const setState = useCallback((v) => {\r\n    _setState((stateRef.current = v));\r\n  }, []);\r\n\r\n  return [state, setState, stateRef];\r\n}\r\n"],"names":["DEFAULT_SCENARIO","DEFAULT_OBJECTIVE_ID","DEFAULT_VAL","LEVELS","D_KEY","C_KEY","P_KEY","R_KEY","M_KEY","NUM_OPTS","THRESHOLDS","SliderApp","current","objectiveIDs","useRef","Object","keys","objectivesData","curScenID","setCurScenID","useState","curObjectiveID","setCurObjectiveID","demand","setDemand","useStickyScale","carryover","setCarryover","priority","setPriority","regs","setRegs","minflow","setMinflow","curInterp","useMemo","createInterps","useEffect","factorsData","serialize","variables","label","controlVar","val","setter","_jsx","_Fragment","children","_jsxs","className","value","onChange","e","target","map","objectiveID","name","_ref","LineSlider","data","getLocalProbs","setVal","BucketGlyph","levelInterp","width","height","resolution","style","display","textAlign","_ref2","MARGIN","WIDTH","svgElem","x","d3","range","y","attr","call","s","node","addEventListener","domain","clamp","offsetX","append","concat","length","tickFormat","selectAll","join","_","i","interpolateWatercolorBlue","select","dd","y1","d","y0","RAZOR_WIDTH","ref","interp","v","k","console","log","curScen","delivs","SCENARIO_KEY_STRING","DELIV_KEY_STRING","ticksExact","MAX_DELIVS","_ref3","objective","c","p","r","m","combinations","dVals","cVals","pVals","rVals","mVals","push","interps","vals","t","forEach","variable","DEGREE_SWAY","LINE_WIDTH","colorInterp","id","useId","svgSelector","liquidLevels","prevLiquidLevels","usePrevious","innerWidth","innerHeight","useLayoutEffect","svgContainer","bucketPath","split","liquids","transition","ease","period","delay","duration","attrTween","diff","Math","abs","sin","min","PI","start","stop","count","filled","arguments","undefined","taper","bottomRight","bottomLeft","lineFunc","quantileBins","numericBins","unitsPerQuantile","maxQuantiles","bin","round","sum","Infinity","isEqualFunc","prev","async","objs","fetch","json","DELIV_KEY_STRING_UNORD","obj","scen","max","sort","a","b","mapBy","scenarioIDs","values","fn","newObjs","groupBy","key","WATERDROP_ICON","draw","context","size","moveTo","lineTo","arc","SQRT2","closePath","DROPLET_SHAPE","CIRC_RAD","SQRT1_2","DROP_RAD","CIRC_HEIGHT","DROP_HEIGHT","HAT_START","yToHalfWidth","trigX","angle","acos","yToSpriteY","spriteYToY","sy","waterdropDeltaOutline","yStart","yEnd","rad","Y_DELTA","rightCoords","leftCoords","dx1","dy1","dx2","dy2","ceil","v1","v2","v3","v4","reverse","waterdropDelta","coords","kernelDensityEstimator","kernel","X","V","kernelEpanechnikov","generateWaterdrop","delta","outer","cos","generateRandoPoints","shape","bounds","Matter","create","minX","maxX","minY","maxY","genX","genY","points","random","contains","WATERDROP_CAGE_COORDS","inner","RANDO_CACHE","lastNodesLen","DET_CACHE","lastDetNodesLen","radsToDropWidth","nodes","AREA","floor","sqrt","placeDropsUsingPhysics","reuse","WIDTH_AREA","randoPoints","Engine","Bodies","Composite","engine","nodePos","node_bodies","nx","ny","circle","restitution","parts","quad","position","centre","vertices","isStatic","cage","setParts","setCentre","scale","add","world","FPS","SECS","update","retVal","_ref4","defaultVal","useCallback","obj_name","scen_name","maxDelivs","criteriaSort","criteria","toRadians","Camera","constructor","_ref5","fov","near","far","domElement","zoomFn","this","camera","THREE","set","zoom","scaleExtent","getScaleFromZ","on","d3ZoomHandler","curTransform","transform","view","translate","z","getZFromScale","camera_z_position","half_fov_radians","fov_height","tan","MeshGeometry","threeGeom","idx","addMeshCoords","meshCoords","color","indices","j","face","vertexColors","faces","useStateRef","state","_setState","stateRef","setState"],"sourceRoot":""}